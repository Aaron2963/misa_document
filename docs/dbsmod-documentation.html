<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>./dist/DBSMOD/Documentation.md</title>
    <style>body {
    display: flex;
    margin: 0;
    padding: 0;
    height: 100vh;
}

nav {
    max-width: 300px;
    max-height: 100%;
    overflow: auto;
    padding: 1rem;
    background-color: antiquewhite;
    font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
}

nav dl {
    margin-top: 0;
}

nav dd {
    margin-inline-start: 1rem;
}

nav a {
    text-decoration: none;
    line-height: 2;
}

main {
    flex: 1;
    padding-left: 1rem;
    max-height: 100%;
    overflow: auto;
}

main code {
    background-color: rgba(233,233,233,0.85);
    padding: 0.25rem;
    margin-top: 0.25rem;
    margin-bottom: 0.25rem;
}
</style>
</head>

<body>
    <nav></nav>
    <main>
        <h1>DBSMOD 說明文件</h1>
<p><em>更新於 2023-10-17T08:48:11.993Z</em></p>
<p><a href="https://github.com/dearsoft-com/DBSMOD">DBSMOD 存放區 (私有)</a></p>
<p><code>DBSMOD</code> 類別是資料庫查詢作業的模組。在根類別 <code>DBSMOD</code> 中包含了基本的資料庫查詢的方法，而繼承 <code>DBSMOD</code> 的子類別 (如 <code>DBSMOD_User</code>, <code>DBSMOD_PDT</code> 等) 則是將常用的資料庫查詢作業整合為物件的方法，讓不同的服務都能夠遵循一致的資料庫使用邏輯。</p>
<p>例如，新增產品時會進行多次資料庫查詢</p>
<ul>
<li><code>PDTIFO</code> 新增產品資料</li>
<li><code>RT_PDTIFOTYP_PDTIFO</code> 新增產品類別與產品的關聯</li>
<li><code>PDTIFOTYP</code> 更新項目計數</li>
</ul>
<p>若 API 端點直接查詢資料庫，以上的三次查詢都是獨立處理，當服務擴張，其他 API 端點也提供新增產品的功能，其他 API 端點便有可能漏掉其中任一次查詢。<br />
若 API 端點在查詢資料庫時都呼叫 <code>DBSMOD_PDT::Create</code>，則可確保 <code>PDTIFO</code>、<code>RT_PDTIFOTYP_PDTIFO</code>、<code>PDTIFOTYP</code> 三個資料表的資料都會被正確的新增/修改。</p>
<p>📙 <em>注意！本文件由程式根據源碼中的註解自動產生，若需要修改文件，請直接修改程式碼源檔案中的 PHP Document 註解。</em></p>
<h1>Table of Contents</h1>
&lt;!-- toc --&gt;
<ul>
<li><a href="#1-abstract-config">1. abstract Config</a>
<ul>
<li><a href="#11-setmulticasevariables">1.1 SetMultiCaseVariables</a></li>
<li><a href="#12-validate">1.2 Validate</a></li>
</ul>
</li>
<li><a href="#2-configdatabase-extends-config">2. ConfigDatabase extends Config</a>
<ul>
<li><a href="#21-properties">2.1 Properties</a></li>
<li><a href="#22-__construct">2.2 __construct</a></li>
<li><a href="#23-fromenvstatic">2.3 FromENV(static)</a></li>
<li><a href="#24-deploy">2.4 Deploy</a></li>
</ul>
</li>
<li><a href="#3-configinit-extends-config">3. ConfigInit extends Config</a>
<ul>
<li><a href="#31-properties">3.1 Properties</a></li>
<li><a href="#32-__construct">3.2 __construct</a></li>
<li><a href="#33-fromenvstatic">3.3 FromENV(static)</a></li>
<li><a href="#34-deploy">3.4 Deploy</a></li>
</ul>
</li>
<li><a href="#4-configlanguage-extends-config">4. ConfigLanguage extends Config</a>
<ul>
<li><a href="#41-properties">4.1 Properties</a></li>
<li><a href="#42-__construct">4.2 __construct</a></li>
<li><a href="#43-deploy">4.3 Deploy</a></li>
</ul>
</li>
<li><a href="#5-configpath-extends-config">5. ConfigPath extends Config</a>
<ul>
<li><a href="#51-properties">5.1 Properties</a></li>
<li><a href="#52-__construct">5.2 __construct</a></li>
<li><a href="#53-fromenvstatic">5.3 FromENV(static)</a></li>
<li><a href="#54-deploy">5.4 Deploy</a></li>
</ul>
</li>
<li><a href="#6-configredis-extends-config">6. ConfigRedis extends Config</a>
<ul>
<li><a href="#61-properties">6.1 Properties</a></li>
<li><a href="#62-__construct">6.2 __construct</a></li>
<li><a href="#63-fromenvstatic">6.3 FromENV(static)</a></li>
<li><a href="#64-deploy">6.4 Deploy</a></li>
</ul>
</li>
<li><a href="#7-configsms-extends-config">7. ConfigSMS extends Config</a>
<ul>
<li><a href="#71-properties">7.1 Properties</a></li>
<li><a href="#72-__construct">7.2 __construct</a></li>
<li><a href="#73-deploy">7.3 Deploy</a></li>
<li><a href="#74-validate">7.4 Validate</a></li>
</ul>
</li>
<li><a href="#8-configsmtp-extends-config">8. ConfigSMTP extends Config</a>
<ul>
<li><a href="#81-properties">8.1 Properties</a></li>
<li><a href="#82-__construct">8.2 __construct</a></li>
<li><a href="#83-fromenvstatic">8.3 FromENV(static)</a></li>
<li><a href="#84-setmailproxy">8.4 SetMailProxy</a></li>
<li><a href="#85-setmailservice">8.5 SetMailService</a></li>
<li><a href="#86-deploy">8.6 Deploy</a></li>
<li><a href="#87-validate">8.7 Validate</a></li>
<li><a href="#88-getproxyurl">8.8 GetProxyURL</a></li>
<li><a href="#89-getsmtparray">8.9 GetSMTPArray</a></li>
</ul>
</li>
<li><a href="#9-configtablename-extends-config">9. ConfigTableName extends Config</a>
<ul>
<li><a href="#91-properties">9.1 Properties</a></li>
<li><a href="#92-__construct">9.2 __construct</a></li>
<li><a href="#93-deploy">9.3 Deploy</a></li>
</ul>
</li>
<li><a href="#10-configtrade-extends-config">10. ConfigTrade extends Config</a>
<ul>
<li><a href="#101-properties">10.1 Properties</a></li>
<li><a href="#102-__construct">10.2 __construct</a></li>
<li><a href="#103-fromenvstatic">10.3 FromENV(static)</a></li>
<li><a href="#104-deploy">10.4 Deploy</a></li>
</ul>
</li>
<li><a href="#11-abstract-dbsmod">11. abstract DBSMOD</a>
<ul>
<li><a href="#111-properties">11.1 Properties</a></li>
<li><a href="#112-__construct">11.2 __construct</a></li>
<li><a href="#113-settablesprotected">11.3 SetTables(protected)</a></li>
<li><a href="#114-dbsselectprotected">11.4 DBSSelect(protected)</a></li>
<li><a href="#115-dbsinsertprotected">11.5 DBSInsert(protected)</a></li>
<li><a href="#116-dbsupdateprotected">11.6 DBSUpdate(protected)</a></li>
<li><a href="#117-dbsdeleteprotected">11.7 DBSDelete(protected)</a></li>
<li><a href="#118-dataexistprotected">11.8 DataExist(protected)</a></li>
<li><a href="#119-readflag">11.9 ReadFlag</a></li>
<li><a href="#1110-writeflag">11.10 WriteFlag</a></li>
<li><a href="#1111-gettables">11.11 GetTables</a></li>
</ul>
</li>
<li><a href="#12-dbsmod_appointment-extends-dbsmod">12. DBSMOD_Appointment extends DBSMOD</a>
<ul>
<li><a href="#121-properties">12.1 Properties</a></li>
<li><a href="#122-settablesprotected">12.2 SetTables(protected)</a></li>
<li><a href="#123-select">12.3 Select</a></li>
<li><a href="#124-create">12.4 Create</a></li>
<li><a href="#125-update">12.5 Update</a></li>
<li><a href="#126-delete">12.6 Delete</a></li>
<li><a href="#127-getinitstatusflagprotected">12.7 GetInitStatusFlag(protected)</a></li>
</ul>
</li>
<li><a href="#13-dbsmod_assignment-extends-dbsmod_doc">13. DBSMOD_Assignment extends DBSMOD_DOC</a>
<ul>
<li><a href="#131-settablesprotected">13.1 SetTables(protected)</a></li>
<li><a href="#132-selecthandin">13.2 SelectHandIn</a></li>
<li><a href="#133-createhandin">13.3 CreateHandIn</a></li>
<li><a href="#134-updatehandin">13.4 UpdateHandIn</a></li>
<li><a href="#135-deletehandin">13.5 DeleteHandIn</a></li>
<li><a href="#136-appendcourse">13.6 AppendCourse</a></li>
<li><a href="#137-removecourse">13.7 RemoveCourse</a></li>
<li><a href="#138-export">13.8 Export</a></li>
</ul>
</li>
<li><a href="#14-dbsmod_bulletindoc-extends-dbsmod_doc">14. DBSMOD_BulletinDOC extends DBSMOD_DOC</a>
<ul>
<li><a href="#141-settablesprotected">14.1 SetTables(protected)</a></li>
<li><a href="#142-appendcourse">14.2 AppendCourse</a></li>
<li><a href="#143-removecourse">14.3 RemoveCourse</a></li>
</ul>
</li>
<li><a href="#15-dbsmod_coupon-extends-dbsmod">15. DBSMOD_Coupon extends DBSMOD</a>
<ul>
<li><a href="#151-settablesprotected">15.1 SetTables(protected)</a></li>
<li><a href="#152-select">15.2 Select</a></li>
<li><a href="#153-create">15.3 Create</a></li>
<li><a href="#154-update">15.4 Update</a></li>
<li><a href="#155-delete">15.5 Delete</a></li>
<li><a href="#156-selecttyp">15.6 SelectTYP</a></li>
<li><a href="#157-createtyp">15.7 CreateTYP</a></li>
<li><a href="#158-updatetyp">15.8 UpdateTYP</a></li>
<li><a href="#159-deletetyp">15.9 DeleteTYP</a></li>
<li><a href="#1510-selectcode">15.10 SelectCode</a></li>
<li><a href="#1511-createcode">15.11 CreateCode</a></li>
<li><a href="#1512-updatecode">15.12 UpdateCode</a></li>
<li><a href="#1513-deletecode">15.13 DeleteCode</a></li>
<li><a href="#1514-exchangecoupon">15.14 ExchangeCoupon</a></li>
<li><a href="#1515-updatetypifocntprotected">15.15 UpdateTYPIFOCNT(protected)</a></li>
</ul>
</li>
<li><a href="#16-dbsmod_course-extends-dbsmod">16. DBSMOD_Course extends DBSMOD</a>
<ul>
<li><a href="#161-properties">16.1 Properties</a></li>
<li><a href="#162-settablesprotected">16.2 SetTables(protected)</a></li>
<li><a href="#163-select">16.3 Select</a></li>
<li><a href="#164-create">16.4 Create</a></li>
<li><a href="#165-update">16.5 Update</a></li>
<li><a href="#166-delete">16.6 Delete</a></li>
<li><a href="#167-selecttyp">16.7 SelectTYP</a></li>
<li><a href="#168-createtyp">16.8 CreateTYP</a></li>
<li><a href="#169-updatetyp">16.9 UpdateTYP</a></li>
<li><a href="#1610-deletetyp">16.10 DeleteTYP</a></li>
<li><a href="#1611-selecttocitem">16.11 SelectTOCItem</a></li>
<li><a href="#1612-createtocitem">16.12 CreateTOCItem</a></li>
<li><a href="#1613-updatetocitem">16.13 UpdateTOCItem</a></li>
<li><a href="#1614-deletetocitem">16.14 DeleteTOCItem</a></li>
<li><a href="#1615-appendtextbook">16.15 AppendTextbook</a></li>
<li><a href="#1616-removetextbook">16.16 RemoveTextbook</a></li>
<li><a href="#1617-updatetypifocntprotected">16.17 UpdateTYPIFOCNT(protected)</a></li>
<li><a href="#1618-getinitstatusflagprotected">16.18 GetInitStatusFlag(protected)</a></li>
</ul>
</li>
<li><a href="#17-dbsmod_cus-extends-dbsmod">17. DBSMOD_CUS extends DBSMOD</a>
<ul>
<li><a href="#171-settablesprotected">17.1 SetTables(protected)</a></li>
<li><a href="#172-select">17.2 Select</a></li>
<li><a href="#173-create">17.3 Create</a></li>
<li><a href="#174-update">17.4 Update</a></li>
<li><a href="#175-delete">17.5 Delete</a></li>
<li><a href="#176-selecttyp">17.6 SelectTYP</a></li>
<li><a href="#177-createtyp">17.7 CreateTYP</a></li>
<li><a href="#178-updatetyp">17.8 UpdateTYP</a></li>
<li><a href="#179-deletetyp">17.9 DeleteTYP</a></li>
<li><a href="#1710-updatetypifocntprotected">17.10 UpdateTYPIFOCNT(protected)</a></li>
</ul>
</li>
<li><a href="#18-dbsmod_doc-extends-dbsmod">18. DBSMOD_DOC extends DBSMOD</a>
<ul>
<li><a href="#181-properties">18.1 Properties</a></li>
<li><a href="#182-settablesprotected">18.2 SetTables(protected)</a></li>
<li><a href="#183-select">18.3 Select</a></li>
<li><a href="#184-create">18.4 Create</a></li>
<li><a href="#185-update">18.5 Update</a></li>
<li><a href="#186-approve">18.6 Approve</a></li>
<li><a href="#187-accumulatecnt">18.7 AccumulateCNT</a></li>
<li><a href="#188-delete">18.8 Delete</a></li>
<li><a href="#189-createdraftfromdoc">18.9 CreateDraftFromDOC</a></li>
<li><a href="#1810-copytotable">18.10 CopyToTable</a></li>
<li><a href="#1811-selecttyp">18.11 SelectTYP</a></li>
<li><a href="#1812-createtyp">18.12 CreateTYP</a></li>
<li><a href="#1813-updatetyp">18.13 UpdateTYP</a></li>
<li><a href="#1814-deletetyp">18.14 DeleteTYP</a></li>
<li><a href="#1815-updatetypifocntprotected">18.15 UpdateTYPIFOCNT(protected)</a></li>
<li><a href="#1816-getinitstatusflagprotected">18.16 GetInitStatusFlag(protected)</a></li>
<li><a href="#1817-getoridocfieldprotected">18.17 GetORIDOCField(protected)</a></li>
<li><a href="#1818-appendmultilingualindex">18.18 AppendMultilingualIndex</a></li>
<li><a href="#1819-removemultilingualindex">18.19 RemoveMultilingualIndex</a></li>
</ul>
</li>
<li><a href="#19-dbsmod_doc_enus-extends-dbsmod_doc">19. DBSMOD_DOC_enUS extends DBSMOD_DOC</a>
<ul>
<li><a href="#191-settablesprotected">19.1 SetTables(protected)</a></li>
</ul>
</li>
<li><a href="#20-dbsmod_dscdoc-extends-dbsmod_doc">20. DBSMOD_DSCDOC extends DBSMOD_DOC</a>
<ul>
<li><a href="#201-settablesprotected">20.1 SetTables(protected)</a></li>
<li><a href="#202-create">20.2 Create</a></li>
<li><a href="#203-selecttopic">20.3 SelectTopic</a></li>
<li><a href="#204-createtopic">20.4 CreateTopic</a></li>
<li><a href="#205-updatetopic">20.5 UpdateTopic</a></li>
<li><a href="#206-deletetopic">20.6 DeleteTopic</a></li>
<li><a href="#207-selectreply">20.7 SelectReply</a></li>
<li><a href="#208-createreply">20.8 CreateReply</a></li>
<li><a href="#209-updatereply">20.9 UpdateReply</a></li>
<li><a href="#2010-deletereply">20.10 DeleteReply</a></li>
<li><a href="#2011-appendcourse">20.11 AppendCourse</a></li>
<li><a href="#2012-removecourse">20.12 RemoveCourse</a></li>
</ul>
</li>
<li><a href="#21-dbsmod_file-extends-dbsmod">21. DBSMOD_File extends DBSMOD</a>
<ul>
<li><a href="#211-properties">21.1 Properties</a></li>
<li><a href="#212-settablesprotected">21.2 SetTables(protected)</a></li>
<li><a href="#213-select">21.3 Select</a></li>
<li><a href="#214-create">21.4 Create</a></li>
<li><a href="#215-update">21.5 Update</a></li>
<li><a href="#216-delete">21.6 Delete</a></li>
<li><a href="#217-setpermissionprotected">21.7 SetPermission(protected)</a></li>
<li><a href="#218-setuserpermission">21.8 SetUserPermission</a></li>
<li><a href="#219-setgrouppermission">21.9 SetGroupPermission</a></li>
<li><a href="#2110-altersinglepermissionprotected">21.10 AlterSinglePermission(protected)</a></li>
<li><a href="#2111-alteruserreadpermission">21.11 AlterUserReadPermission</a></li>
<li><a href="#2112-altergroupreadpermission">21.12 AlterGroupReadPermission</a></li>
<li><a href="#2113-alteruserwritepermission">21.13 AlterUserWritePermission</a></li>
<li><a href="#2114-altergroupwritepermission">21.14 AlterGroupWritePermission</a></li>
<li><a href="#2115-alteruserdeletepermission">21.15 AlterUserDeletePermission</a></li>
<li><a href="#2116-altergroupdeletepermission">21.16 AlterGroupDeletePermission</a></li>
</ul>
</li>
<li><a href="#22-dbsmod_goods-extends-dbsmod">22. DBSMOD_Goods extends DBSMOD</a>
<ul>
<li><a href="#221-settablesprotected">22.1 SetTables(protected)</a></li>
<li><a href="#222-select">22.2 Select</a></li>
<li><a href="#223-create">22.3 Create</a></li>
<li><a href="#224-update">22.4 Update</a></li>
<li><a href="#225-delete">22.5 Delete</a></li>
<li><a href="#226-createstock">22.6 CreateStock</a></li>
<li><a href="#227-selectstockbygoodsid">22.7 SelectStockByGoodsID</a></li>
<li><a href="#228-updatestockbygoodsid">22.8 UpdateStockByGoodsID</a></li>
<li><a href="#229-updatestocknewqty">22.9 UpdateStockNewQTY</a></li>
<li><a href="#2210-updatestocknewqtybyproductid">22.10 UpdateStockNewQTYByProductID</a></li>
<li><a href="#2211-selecttyp">22.11 SelectTYP</a></li>
<li><a href="#2212-createtyp">22.12 CreateTYP</a></li>
<li><a href="#2213-updatetyp">22.13 UpdateTYP</a></li>
<li><a href="#2214-deletetyp">22.14 DeleteTYP</a></li>
<li><a href="#2215-updatetypifocntprotected">22.15 UpdateTYPIFOCNT(protected)</a></li>
<li><a href="#2216-appendrlvproduct">22.16 AppendRLVProduct</a></li>
<li><a href="#2217-removerlvproduct">22.17 RemoveRLVProduct</a></li>
</ul>
</li>
<li><a href="#23-dbsmod_inv-extends-dbsmod">23. DBSMOD_INV extends DBSMOD</a>
<ul>
<li><a href="#231-properties">23.1 Properties</a></li>
<li><a href="#232-__construct">23.2 __construct</a></li>
<li><a href="#233-settablesprotected">23.3 SetTables(protected)</a></li>
<li><a href="#234-select">23.4 Select</a></li>
<li><a href="#235-create">23.5 Create</a></li>
<li><a href="#236-update">23.6 Update</a></li>
<li><a href="#237-delete">23.7 Delete</a></li>
<li><a href="#238-updateitem">23.8 UpdateItem</a></li>
<li><a href="#239-createitemprotected">23.9 CreateItem(protected)</a></li>
<li><a href="#2310-getinitstatusflagprotected">23.10 GetInitStatusFlag(protected)</a></li>
<li><a href="#2311-getinvoiceforreceiptprotected">23.11 GetInvoiceForReceipt(protected)</a></li>
</ul>
</li>
<li><a href="#24-dbsmod_link-extends-dbsmod">24. DBSMOD_Link extends DBSMOD</a>
<ul>
<li><a href="#241-settablesprotected">24.1 SetTables(protected)</a></li>
<li><a href="#242-select">24.2 Select</a></li>
<li><a href="#243-create">24.3 Create</a></li>
<li><a href="#244-update">24.4 Update</a></li>
<li><a href="#245-delete">24.5 Delete</a></li>
</ul>
</li>
<li><a href="#25-dbsmod_link_enus-extends-dbsmod_link">25. DBSMOD_Link_enUS extends DBSMOD_Link</a>
<ul>
<li><a href="#251-settablesprotected">25.1 SetTables(protected)</a></li>
</ul>
</li>
<li><a href="#26-dbsmod_monitor-extends-dbsmod">26. DBSMOD_Monitor extends DBSMOD</a>
<ul>
<li><a href="#261-properties">26.1 Properties</a></li>
<li><a href="#262-settablesprotected">26.2 SetTables(protected)</a></li>
<li><a href="#263-select">26.3 Select</a></li>
<li><a href="#264-create">26.4 Create</a></li>
<li><a href="#265-update">26.5 Update</a></li>
<li><a href="#266-delete">26.6 Delete</a></li>
<li><a href="#267-selectlog">26.7 SelectLog</a></li>
<li><a href="#268-createlog">26.8 CreateLog</a></li>
<li><a href="#269-updatelog">26.9 UpdateLog</a></li>
<li><a href="#2610-deletelog">26.10 DeleteLog</a></li>
<li><a href="#2611-selectitm">26.11 SelectITM</a></li>
<li><a href="#2612-createitm">26.12 CreateITM</a></li>
<li><a href="#2613-updateitm">26.13 UpdateITM</a></li>
<li><a href="#2614-deleteitm">26.14 DeleteITM</a></li>
<li><a href="#2615-selectdev">26.15 SelectDEV</a></li>
<li><a href="#2616-createdev">26.16 CreateDEV</a></li>
<li><a href="#2617-updatedev">26.17 UpdateDEV</a></li>
<li><a href="#2618-deletedev">26.18 DeleteDEV</a></li>
<li><a href="#2619-selectdevtyp">26.19 SelectDEVTYP</a></li>
<li><a href="#2620-createdevtyp">26.20 CreateDEVTYP</a></li>
<li><a href="#2621-updatedevtyp">26.21 UpdateDEVTYP</a></li>
<li><a href="#2622-deletedevtyp">26.22 DeleteDEVTYP</a></li>
<li><a href="#2623-updatedevtypifocntprotected">26.23 UpdateDEVTYPIFOCNT(protected)</a></li>
<li><a href="#2624-createlogitem">26.24 CreateLogItem</a></li>
<li><a href="#2625-clearexpiredlogitemcache">26.25 ClearExpiredLogItemCache</a></li>
</ul>
</li>
<li><a href="#27-dbsmod_oauthtoken-extends-dbsmod">27. DBSMOD_OAuthToken extends DBSMOD</a>
<ul>
<li><a href="#271-properties">27.1 Properties</a></li>
<li><a href="#272-settablesprotected">27.2 SetTables(protected)</a></li>
<li><a href="#273-createtoken">27.3 CreateToken</a></li>
<li><a href="#274-checktoken">27.4 CheckToken</a></li>
<li><a href="#275-deletetoken">27.5 DeleteToken</a></li>
<li><a href="#276-generateidprotected">27.6 GenerateID(protected)</a></li>
<li><a href="#277-isrevokedprotected">27.7 IsRevoked(protected)</a></li>
</ul>
</li>
<li><a href="#28-dbsmod_pdt-extends-dbsmod">28. DBSMOD_PDT extends DBSMOD</a>
<ul>
<li><a href="#281-properties">28.1 Properties</a></li>
<li><a href="#282-__construct">28.2 __construct</a></li>
<li><a href="#283-settablesprotected">28.3 SetTables(protected)</a></li>
<li><a href="#284-select">28.4 Select</a></li>
<li><a href="#285-create">28.5 Create</a></li>
<li><a href="#286-update">28.6 Update</a></li>
<li><a href="#287-delete">28.7 Delete</a></li>
<li><a href="#288-appendrlvtyp">28.8 AppendRLVTYP</a></li>
<li><a href="#289-removerlvtyp">28.9 RemoveRLVTYP</a></li>
<li><a href="#2810-selecttyp">28.10 SelectTYP</a></li>
<li><a href="#2811-createtyp">28.11 CreateTYP</a></li>
<li><a href="#2812-updatetyp">28.12 UpdateTYP</a></li>
<li><a href="#2813-deletetyp">28.13 DeleteTYP</a></li>
<li><a href="#2814-updatetypifocntprotected">28.14 UpdateTYPIFOCNT(protected)</a></li>
<li><a href="#2815-appendrlvcnr">28.15 AppendRLVCNR</a></li>
<li><a href="#2816-removerlvcnr">28.16 RemoveRLVCNR</a></li>
<li><a href="#2817-selectcnr">28.17 SelectCNR</a></li>
<li><a href="#2818-createcnr">28.18 CreateCNR</a></li>
<li><a href="#2819-updatecnr">28.19 UpdateCNR</a></li>
<li><a href="#2820-deletecnr">28.20 DeleteCNR</a></li>
<li><a href="#2821-selectcnrtyp">28.21 SelectCNRTYP</a></li>
<li><a href="#2822-createcnrtyp">28.22 CreateCNRTYP</a></li>
<li><a href="#2823-updatecnrtyp">28.23 UpdateCNRTYP</a></li>
<li><a href="#2824-deletecnrtyp">28.24 DeleteCNRTYP</a></li>
<li><a href="#2825-updatecnrtypifocntprotected">28.25 UpdateCNRTYPIFOCNT(protected)</a></li>
</ul>
</li>
<li><a href="#29-dbsmod_phssal-extends-dbsmod">29. DBSMOD_PHSSAL extends DBSMOD</a>
<ul>
<li><a href="#291-properties">29.1 Properties</a></li>
<li><a href="#292-__construct">29.2 __construct</a></li>
<li><a href="#293-settablesprotected">29.3 SetTables(protected)</a></li>
<li><a href="#294-select">29.4 Select</a></li>
<li><a href="#295-create">29.5 Create</a></li>
<li><a href="#296-update">29.6 Update</a></li>
<li><a href="#297-delete">29.7 Delete</a></li>
<li><a href="#298-updateitem">29.8 UpdateItem</a></li>
<li><a href="#299-createitemprotected">29.9 CreateItem(protected)</a></li>
<li><a href="#2910-getinitstatusflagprotected">29.10 GetInitStatusFlag(protected)</a></li>
</ul>
</li>
<li><a href="#30-dbsmod_pmo-extends-dbsmod">30. DBSMOD_PMO extends DBSMOD</a>
<ul>
<li><a href="#301-settablesprotected">30.1 SetTables(protected)</a></li>
<li><a href="#302-select">30.2 Select</a></li>
<li><a href="#303-create">30.3 Create</a></li>
<li><a href="#304-update">30.4 Update</a></li>
<li><a href="#305-delete">30.5 Delete</a></li>
<li><a href="#306-selecttyp">30.6 SelectTYP</a></li>
<li><a href="#307-createtyp">30.7 CreateTYP</a></li>
<li><a href="#308-updatetyp">30.8 UpdateTYP</a></li>
<li><a href="#309-deletetyp">30.9 DeleteTYP</a></li>
<li><a href="#3010-selectpmopdtdcn">30.10 SelectPMOPDTDCN</a></li>
<li><a href="#3011-createpmopdtdcn">30.11 CreatePMOPDTDCN</a></li>
<li><a href="#3012-updatepmopdtdcn">30.12 UpdatePMOPDTDCN</a></li>
<li><a href="#3013-deletepmopdtdcn">30.13 DeletePMOPDTDCN</a></li>
</ul>
</li>
<li><a href="#31-dbsmod_pmsgrp-extends-dbsmod">31. DBSMOD_PMSGRP extends DBSMOD</a>
<ul>
<li><a href="#312-select">31.2 Select</a></li>
<li><a href="#313-create">31.3 Create</a></li>
<li><a href="#314-update">31.4 Update</a></li>
<li><a href="#315-delete">31.5 Delete</a></li>
<li><a href="#316-selectpmsscope">31.6 SelectPMSScope</a></li>
<li><a href="#317-createpmsscope">31.7 CreatePMSScope</a></li>
<li><a href="#318-updatepmsscope">31.8 UpdatePMSScope</a></li>
<li><a href="#319-deletepmsscope">31.9 DeletePMSScope</a></li>
<li><a href="#3110-appendpmsscope">31.10 AppendPMSScope</a></li>
<li><a href="#3111-removepmsscope">31.11 RemovePMSScope</a></li>
<li><a href="#3112-appendpmsscopebydcp">31.12 AppendPMSScopeByDCP</a></li>
<li><a href="#3113-removepmsscopebydcp">31.13 RemovePMSScopeByDCP</a></li>
<li><a href="#3114-checkuser">31.14 CheckUser</a></li>
</ul>
</li>
<li><a href="#32-dbsmod_rscdoc-extends-dbsmod_doc">32. DBSMOD_RSCDOC extends DBSMOD_DOC</a>
<ul>
<li><a href="#321-settablesprotected">32.1 SetTables(protected)</a></li>
<li><a href="#322-appendcoursetocitem">32.2 AppendCourseTOCItem</a></li>
<li><a href="#323-removecoursetocitem">32.3 RemoveCourseTOCItem</a></li>
<li><a href="#324-appendtextbooktocitem">32.4 AppendTextbookTOCItem</a></li>
<li><a href="#325-removetextbooktocitem">32.5 RemoveTextbookTOCItem</a></li>
</ul>
</li>
<li><a href="#33-dbsmod_salodr-extends-dbsmod">33. DBSMOD_SALODR extends DBSMOD</a>
<ul>
<li><a href="#331-properties">33.1 Properties</a></li>
<li><a href="#332-__construct">33.2 __construct</a></li>
<li><a href="#333-settablesprotected">33.3 SetTables(protected)</a></li>
<li><a href="#334-select">33.4 Select</a></li>
<li><a href="#335-create">33.5 Create</a></li>
<li><a href="#336-update">33.6 Update</a></li>
<li><a href="#337-delete">33.7 Delete</a></li>
<li><a href="#338-selectitems">33.8 SelectItems</a></li>
<li><a href="#339-updateitem">33.9 UpdateItem</a></li>
<li><a href="#3310-createitem">33.10 CreateItem</a></li>
<li><a href="#3311-processamountprotected">33.11 ProcessAmount(protected)</a></li>
<li><a href="#3312-getinitstatusflagprotected">33.12 GetInitStatusFlag(protected)</a></li>
<li><a href="#3313-firestatuseventprotected">33.13 FireStatusEvent(protected)</a></li>
<li><a href="#3314-sendstatusnoticeprotected">33.14 SendStatusNotice(protected)</a></li>
<li><a href="#3315-createreturnfromsalodr">33.15 CreateReturnFromSALODR</a></li>
<li><a href="#3316-createphssalfromsalodrprotected">33.16 CreatePHSSALFromSALODR(protected)</a></li>
<li><a href="#3317-createinvfromsalodrprotected">33.17 CreateINVFromSALODR(protected)</a></li>
<li><a href="#3318-onwaitingdealprotected">33.18 OnWaitingDeal(protected)</a></li>
<li><a href="#3319-ondealprotected">33.19 OnDeal(protected)</a></li>
<li><a href="#3320-onwaitingpaymentprotected">33.20 OnWaitingPayment(protected)</a></li>
<li><a href="#3321-onpaymentprotected">33.21 OnPayment(protected)</a></li>
<li><a href="#3322-onwaitingdeliveryprotected">33.22 OnWaitingDelivery(protected)</a></li>
<li><a href="#3323-ondeliveryprotected">33.23 OnDelivery(protected)</a></li>
<li><a href="#3324-onwaitingreturnprotected">33.24 OnWaitingReturn(protected)</a></li>
<li><a href="#3325-onreturnprotected">33.25 OnReturn(protected)</a></li>
<li><a href="#3326-onwaitingrefundprotected">33.26 OnWaitingRefund(protected)</a></li>
<li><a href="#3327-onrefundprotected">33.27 OnRefund(protected)</a></li>
<li><a href="#3328-onwaitingcloseprotected">33.28 OnWaitingClose(protected)</a></li>
<li><a href="#3329-oncloseprotected">33.29 OnClose(protected)</a></li>
</ul>
</li>
<li><a href="#34-dbsmod_task-extends-dbsmod">34. DBSMOD_Task extends DBSMOD</a>
<ul>
<li><a href="#341-properties">34.1 Properties</a></li>
<li><a href="#342-settablesprotected">34.2 SetTables(protected)</a></li>
<li><a href="#343-select">34.3 Select</a></li>
<li><a href="#344-create">34.4 Create</a></li>
<li><a href="#345-update">34.5 Update</a></li>
<li><a href="#346-delete">34.6 Delete</a></li>
<li><a href="#347-getrunningstate">34.7 GetRunningState</a></li>
<li><a href="#348-bindstatusevent">34.8 BindStatusEvent</a></li>
<li><a href="#349-getinitstatusflagprotected">34.9 GetInitStatusFlag(protected)</a></li>
<li><a href="#3410-firestatuseventprotected">34.10 FireStatusEvent(protected)</a></li>
<li><a href="#3411-checkexecutingtocompletedprotected">34.11 CheckExecutingToCompleted(protected)</a></li>
<li><a href="#3412-checkcompletedtoreviewedprotected">34.12 CheckCompletedToReviewed(protected)</a></li>
</ul>
</li>
<li><a href="#35-dbsmod_taskexecution-extends-dbsmod">35. DBSMOD_TaskExecution extends DBSMOD</a>
<ul>
<li><a href="#351-properties">35.1 Properties</a></li>
<li><a href="#352-__construct">35.2 __construct</a></li>
<li><a href="#353-settablesprotected">35.3 SetTables(protected)</a></li>
<li><a href="#354-select">35.4 Select</a></li>
<li><a href="#355-create">35.5 Create</a></li>
<li><a href="#356-update">35.6 Update</a></li>
<li><a href="#357-delete">35.7 Delete</a></li>
<li><a href="#358-bindstatusevent">35.8 BindStatusEvent</a></li>
<li><a href="#359-getinitstatusflagprotected">35.9 GetInitStatusFlag(protected)</a></li>
<li><a href="#3510-firestatuseventprotected">35.10 FireStatusEvent(protected)</a></li>
<li><a href="#3511-revokeexecutioncountprotected">35.11 RevokeExecutionCount(protected)</a></li>
</ul>
</li>
<li><a href="#36-dbsmod_textbook-extends-dbsmod">36. DBSMOD_Textbook extends DBSMOD</a>
<ul>
<li><a href="#361-settablesprotected">36.1 SetTables(protected)</a></li>
<li><a href="#362-select">36.2 Select</a></li>
<li><a href="#363-create">36.3 Create</a></li>
<li><a href="#364-update">36.4 Update</a></li>
<li><a href="#365-delete">36.5 Delete</a></li>
<li><a href="#366-selecttyp">36.6 SelectTYP</a></li>
<li><a href="#367-createtyp">36.7 CreateTYP</a></li>
<li><a href="#368-updatetyp">36.8 UpdateTYP</a></li>
<li><a href="#369-deletetyp">36.9 DeleteTYP</a></li>
<li><a href="#3610-updatetypifocntprotected">36.10 UpdateTYPIFOCNT(protected)</a></li>
<li><a href="#3611-selecttocitem">36.11 SelectTOCItem</a></li>
<li><a href="#3612-createtocitem">36.12 CreateTOCItem</a></li>
<li><a href="#3613-updatetocitem">36.13 UpdateTOCItem</a></li>
<li><a href="#3614-deletetocitem">36.14 DeleteTOCItem</a></li>
</ul>
</li>
<li><a href="#37-dbsmod_user-extends-dbsmod">37. DBSMOD_User extends DBSMOD</a>
<ul>
<li><a href="#371-properties">37.1 Properties</a></li>
<li><a href="#372-settablesprotected">37.2 SetTables(protected)</a></li>
<li><a href="#373-select">37.3 Select</a></li>
<li><a href="#374-create">37.4 Create</a></li>
<li><a href="#375-update">37.5 Update</a></li>
<li><a href="#376-delete">37.6 Delete</a></li>
<li><a href="#377-selecttyp">37.7 SelectTYP</a></li>
<li><a href="#378-createtyp">37.8 CreateTYP</a></li>
<li><a href="#379-updatetyp">37.9 UpdateTYP</a></li>
<li><a href="#3710-deletetyp">37.10 DeleteTYP</a></li>
<li><a href="#3711-selectaut">37.11 SelectAUT</a></li>
<li><a href="#3712-selectcus">37.12 SelectCUS</a></li>
<li><a href="#3713-updatecus">37.13 UpdateCUS</a></li>
<li><a href="#3714-processpinprotected">37.14 ProcessPIN(protected)</a></li>
<li><a href="#3715-processautvrfprotected">37.15 ProcessAUTVRF(protected)</a></li>
<li><a href="#3716-login">37.16 Login</a></li>
<li><a href="#3717-sendnotice">37.17 SendNotice</a></li>
<li><a href="#3718-activateemlvrf">37.18 ActivateEMLVRF</a></li>
<li><a href="#3719-changeautvrfprotected">37.19 ChangeAUTVRF(protected)</a></li>
<li><a href="#3720-processemlvrf">37.20 ProcessEMLVRF</a></li>
<li><a href="#3721-processemlvrfbyuserid">37.21 ProcessEMLVRFByUserID</a></li>
<li><a href="#3722-resetpin">37.22 ResetPIN</a></li>
<li><a href="#3723-activateotp">37.23 ActivateOTP</a></li>
<li><a href="#3724-processotp">37.24 ProcessOTP</a></li>
<li><a href="#3726-updatetypifocntprotected">37.26 UpdateTYPIFOCNT(protected)</a></li>
</ul>
</li>
<li><a href="#38-dbsmod_usergrp-extends-dbsmod">38. DBSMOD_UserGRP extends DBSMOD</a>
<ul>
<li><a href="#381-settablesprotected">38.1 SetTables(protected)</a></li>
<li><a href="#382-select">38.2 Select</a></li>
<li><a href="#383-create">38.3 Create</a></li>
<li><a href="#384-update">38.4 Update</a></li>
<li><a href="#385-delete">38.5 Delete</a></li>
<li><a href="#386-selectrole">38.6 SelectRole</a></li>
<li><a href="#387-createrole">38.7 CreateRole</a></li>
<li><a href="#388-updaterole">38.8 UpdateRole</a></li>
<li><a href="#389-deleterole">38.9 DeleteRole</a></li>
<li><a href="#3810-appenduser">38.10 AppendUser</a></li>
<li><a href="#3811-removeuser">38.11 RemoveUser</a></li>
</ul>
</li>
<li><a href="#39-dbsmod_usertoken-extends-dbsmod">39. DBSMOD_UserToken extends DBSMOD</a>
<ul>
<li><a href="#391-properties">39.1 Properties</a></li>
<li><a href="#392-settablesprotected">39.2 SetTables(protected)</a></li>
<li><a href="#393-clearexpiredtokenontableprotected">39.3 ClearExpiredTokenOnTable(protected)</a></li>
<li><a href="#394-deletebytokenontableprotected">39.4 DeleteByTokenOnTable(protected)</a></li>
<li><a href="#395-deletebyuserontableprotected">39.5 DeleteByUserOnTable(protected)</a></li>
<li><a href="#396-createtokenontableprotected">39.6 CreateTokenOnTable(protected)</a></li>
<li><a href="#397-checktokenontableprotected">39.7 CheckTokenOnTable(protected)</a></li>
<li><a href="#398-createtoken">39.8 CreateToken</a></li>
<li><a href="#399-createtmptoken">39.9 CreateTMPToken</a></li>
<li><a href="#3910-deletetoken">39.10 DeleteToken</a></li>
<li><a href="#3911-deletetmptoken">39.11 DeleteTMPToken</a></li>
<li><a href="#3912-deletetokenbyuser">39.12 DeleteTokenByUser</a></li>
<li><a href="#3913-deletetmptokenbyuser">39.13 DeleteTMPTokenByUser</a></li>
<li><a href="#3914-checktoken">39.14 CheckToken</a></li>
<li><a href="#3915-checktmptoken">39.15 CheckTMPToken</a></li>
<li><a href="#3916-hashprotected">39.16 Hash(protected)</a></li>
<li><a href="#3917-getrandomtokenprotected">39.17 GetRandomToken(protected)</a></li>
<li><a href="#3918-getusersource">39.18 GetUserSource</a></li>
</ul>
</li>
<li><a href="#40-dbsmod_viewschema-extends-dbsmod">40. DBSMOD_ViewSchema extends DBSMOD</a>
<ul>
<li><a href="#401-settablesprotected">40.1 SetTables(protected)</a></li>
<li><a href="#402-select">40.2 Select</a></li>
<li><a href="#403-create">40.3 Create</a></li>
<li><a href="#404-update">40.4 Update</a></li>
<li><a href="#405-delete">40.5 Delete</a></li>
<li><a href="#406-selecttyp">40.6 SelectTYP</a></li>
<li><a href="#407-createtyp">40.7 CreateTYP</a></li>
<li><a href="#408-updatetyp">40.8 UpdateTYP</a></li>
<li><a href="#409-deletetyp">40.9 DeleteTYP</a></li>
<li><a href="#4010-updatetypifocntprotected">40.10 UpdateTYPIFOCNT(protected)</a></li>
<li><a href="#4011-mergecommonschema">40.11 MergeCommonSchema</a></li>
</ul>
</li>
<li><a href="#41-acstokenentity">41. ACSTokenEntity</a>
<ul>
<li><a href="#411-properties">41.1 Properties</a></li>
<li><a href="#412-__construct">41.2 __construct</a></li>
<li><a href="#413-fromarraystatic">41.3 FromArray(static)</a></li>
<li><a href="#414-toarray">41.4 ToArray</a></li>
</ul>
</li>
<li><a href="#42-archive">42. Archive</a>
<ul>
<li><a href="#421-__construct">42.1 __construct</a></li>
<li><a href="#422-getfileinfo">42.2 GetFileInfo</a></li>
</ul>
</li>
<li><a href="#43-dbstableentity">43. DBSTableEntity</a>
<ul>
<li><a href="#431-properties">43.1 Properties</a></li>
<li><a href="#432-__construct">43.2 __construct</a></li>
<li><a href="#433-setfields">43.3 SetFields</a></li>
<li><a href="#434-getfields">43.4 GetFields</a></li>
<li><a href="#435-validatefields">43.5 ValidateFields</a></li>
</ul>
</li>
<li><a href="#44-jwtentity">44. JWTEntity</a>
<ul>
<li><a href="#441-tostring">44.1 ToString</a></li>
<li><a href="#442-getjti">44.2 GetJTI</a></li>
<li><a href="#443-setjti">44.3 SetJTI</a></li>
<li><a href="#444-getsub">44.4 GetSUB</a></li>
<li><a href="#445-setsub">44.5 SetSUB</a></li>
<li><a href="#446-getiss">44.6 GetISS</a></li>
<li><a href="#447-setiss">44.7 SetISS</a></li>
<li><a href="#448-getaud">44.8 GetAUD</a></li>
<li><a href="#449-setaud">44.9 SetAUD</a></li>
<li><a href="#4410-getexp">44.10 GetEXP</a></li>
<li><a href="#4411-setexp">44.11 SetEXP</a></li>
<li><a href="#4412-getiat">44.12 GetIAT</a></li>
<li><a href="#4413-setiat">44.13 SetIAT</a></li>
<li><a href="#4414-getnbf">44.14 GetNBF</a></li>
<li><a href="#4415-setnbf">44.15 SetNBF</a></li>
<li><a href="#4416-getscopes">44.16 GetScopes</a></li>
<li><a href="#4417-setscopes">44.17 SetScopes</a></li>
</ul>
</li>
<li><a href="#45-mailentity">45. MailEntity</a>
<ul>
<li><a href="#451-properties">45.1 Properties</a></li>
<li><a href="#452-__construct">45.2 __construct</a></li>
<li><a href="#453-fromarraystatic">45.3 FromArray(static)</a></li>
<li><a href="#454-toarray">45.4 ToArray</a></li>
</ul>
</li>
<li><a href="#46-sitesettingsentity">46. SiteSettingsEntity</a>
<ul>
<li><a href="#461-properties">46.1 Properties</a></li>
<li><a href="#462-__construct">46.2 __construct</a></li>
<li><a href="#463-fromarraystatic">46.3 FromArray(static)</a></li>
<li><a href="#464-toarray">46.4 ToArray</a></li>
</ul>
</li>
<li><a href="#47-smsentity">47. SMSEntity</a>
<ul>
<li><a href="#471-properties">47.1 Properties</a></li>
<li><a href="#472-__construct">47.2 __construct</a></li>
<li><a href="#473-fromarraystatic">47.3 FromArray(static)</a></li>
<li><a href="#474-toarray">47.4 ToArray</a></li>
</ul>
</li>
<li><a href="#48-spreadsheet">48. Spreadsheet</a>
<ul>
<li><a href="#481-properties">48.1 Properties</a></li>
<li><a href="#482-__construct">48.2 __construct</a></li>
<li><a href="#483-move">48.3 Move</a></li>
<li><a href="#484-getfileinfo">48.4 GetFileInfo</a></li>
</ul>
</li>
<li><a href="#49-uploadfileinfo-extends-splfileinfo">49. UploadFileInfo extends \SplFileInfo</a>
<ul>
<li><a href="#491-properties">49.1 Properties</a></li>
<li><a href="#492-frompoststatic">49.2 FromPost(static)</a></li>
<li><a href="#493-getuploadfilename">49.3 getUploadFilename</a></li>
<li><a href="#494-setuploadfilename">49.4 setUploadFilename</a></li>
<li><a href="#495-getuploadtype">49.5 getUploadType</a></li>
<li><a href="#496-setuploadtype">49.6 setUploadType</a></li>
<li><a href="#497-getuploadextension">49.7 getUploadExtension</a></li>
<li><a href="#498-setuploadextension">49.8 setUploadExtension</a></li>
<li><a href="#499-rename">49.9 rename</a></li>
<li><a href="#4910-remove">49.10 remove</a></li>
</ul>
</li>
<li><a href="#50-crypt-">50. Crypt {</a>
<ul>
<li><a href="#501-properties">50.1 Properties</a></li>
<li><a href="#502-__construct">50.2 __construct</a></li>
<li><a href="#503-encrypt">50.3 Encrypt</a></li>
<li><a href="#504-decrypt">50.4 Decrypt</a></li>
<li><a href="#505-setciphermethod">50.5 SetCipherMethod</a></li>
<li><a href="#506-getciphermethod">50.6 GetCipherMethod</a></li>
<li><a href="#507-setpassphrase">50.7 SetPassPhrase</a></li>
<li><a href="#508-getpassphrase">50.8 GetPassPhrase</a></li>
</ul>
</li>
<li><a href="#51-dbsaction">51. DBSAction</a>
<ul>
<li><a href="#511-properties">51.1 Properties</a></li>
<li><a href="#512-__construct">51.2 __construct</a></li>
<li><a href="#513-addselect">51.3 AddSelect</a></li>
<li><a href="#514-addpreselect">51.4 AddPreSelect</a></li>
<li><a href="#515-addupdate">51.5 AddUpdate</a></li>
<li><a href="#516-addpreupdate">51.6 AddPreUpdate</a></li>
<li><a href="#517-addinsert">51.7 AddInsert</a></li>
<li><a href="#518-addpreinsert">51.8 AddPreInsert</a></li>
<li><a href="#519-addcommand">51.9 AddCommand</a></li>
<li><a href="#5110-addorder">51.10 AddOrder</a></li>
<li><a href="#5111-addcondition">51.11 AddCondition</a></li>
<li><a href="#5112-addprecondition">51.12 AddPreCondition</a></li>
<li><a href="#5113-addjoinon">51.13 AddJoinOn</a></li>
<li><a href="#5114-addgroupby">51.14 AddGroupBy</a></li>
<li><a href="#5115-addhaving">51.15 AddHaving</a></li>
<li><a href="#5116-addlimit">51.16 AddLimit</a></li>
<li><a href="#5117-clearsql">51.17 ClearSQL</a></li>
<li><a href="#5118-mergeconditionprotected">51.18 MergeCondition(protected)</a></li>
<li><a href="#5119-mergehavingprotected">51.19 MergeHaving(protected)</a></li>
<li><a href="#5120-rendersql">51.20 RenderSQL</a></li>
<li><a href="#5121-executecommand">51.21 ExecuteCommand</a></li>
<li><a href="#5122-executesql">51.22 ExecuteSQL</a></li>
<li><a href="#5123-count">51.23 Count</a></li>
<li><a href="#5124-rowcount">51.24 RowCount</a></li>
<li><a href="#5125-showdatabases">51.25 ShowDatabases</a></li>
<li><a href="#5126-showtables">51.26 ShowTables</a></li>
<li><a href="#5127-showcolumns">51.27 ShowColumns</a></li>
<li><a href="#5128-showprimarykey">51.28 ShowPrimaryKey</a></li>
<li><a href="#5129-dbssearch">51.29 DBSSearch</a></li>
<li><a href="#5130-readcache">51.30 ReadCache</a></li>
<li><a href="#5131-writecache">51.31 WriteCache</a></li>
<li><a href="#5132-removecache">51.32 RemoveCache</a></li>
<li><a href="#5133-getquerytablesprotected">51.33 GetQueryTables(protected)</a></li>
<li><a href="#5134-throwerrorprotected">51.34 ThrowError(protected)</a></li>
</ul>
</li>
<li><a href="#52-dbsconsistency">52. DBSConsistency</a>
<ul>
<li><a href="#521-properties">52.1 Properties</a></li>
</ul>
</li>
<li><a href="#53-ezreceipt">53. EZReceipt</a>
<ul>
<li><a href="#531-properties">53.1 Properties</a></li>
<li><a href="#532-__construct">53.2 __construct</a></li>
<li><a href="#533-requestprivate">53.3 Request(private)</a></li>
<li><a href="#534-genendpointprivate">53.4 GenEndPoint(private)</a></li>
<li><a href="#535-posttoendpointprivate">53.5 PostToEndpoint(private)</a></li>
<li><a href="#536-login">53.6 Login</a></li>
<li><a href="#537-invoicecreate">53.7 InvoiceCreate</a></li>
</ul>
</li>
<li><a href="#54-fileset">54. FileSet</a>
<ul>
<li><a href="#541-properties">54.1 Properties</a></li>
<li><a href="#542-__construct">54.2 __construct</a></li>
<li><a href="#543-validateloopprotected">54.3 ValidateLoop(protected)</a></li>
<li><a href="#544-validateelement">54.4 ValidateElement</a></li>
<li><a href="#545-get">54.5 Get</a></li>
<li><a href="#546-set">54.6 Set</a></li>
<li><a href="#547-getelementschema">54.7 GetElementSchema</a></li>
<li><a href="#548-append">54.8 Append</a></li>
<li><a href="#549-appendexist">54.9 AppendExist</a></li>
<li><a href="#5410-remove">54.10 Remove</a></li>
<li><a href="#5411-geturls">54.11 GetURLs</a></li>
<li><a href="#5412-handleupload">54.12 HandleUpload</a></li>
</ul>
</li>
<li><a href="#55-notice">55. Notice</a>
<ul>
<li><a href="#551-properties">55.1 Properties</a></li>
<li><a href="#552-__construct">55.2 __construct</a></li>
<li><a href="#553-replacedocprotected">55.3 ReplaceDOC(protected)</a></li>
<li><a href="#554-setdetailfromdoc">55.4 SetDetailFromDOC</a></li>
<li><a href="#555-setsubjectfromdoc">55.5 SetSubjectFromDOC</a></li>
<li><a href="#556-send">55.6 Send</a></li>
<li><a href="#557-sendemailprotected">55.7 SendEmail(protected)</a></li>
<li><a href="#558-sendsmsprotected">55.8 SendSMS(protected)</a></li>
<li><a href="#559-sendmailbyproxy">55.9 SendMailByProxy</a></li>
<li><a href="#5510-sendmailbyservice">55.10 SendMailByService</a></li>
</ul>
</li>
<li><a href="#56-picset-extends-fileset">56. PICSet extends FileSet</a>
<ul>
<li><a href="#561-properties">56.1 Properties</a></li>
<li><a href="#562-append">56.2 Append</a></li>
<li><a href="#563-appendexist">56.3 AppendExist</a></li>
<li><a href="#564-copyresizeimageprotected">56.4 CopyResizeImage(protected)</a></li>
<li><a href="#565-getmaxwidth">56.5 GetMaxWidth</a></li>
<li><a href="#566-setmaxwidth">56.6 SetMaxWidth</a></li>
</ul>
</li>
<li><a href="#57-redisaction">57. RedisAction</a>
<ul>
<li><a href="#571-properties">57.1 Properties</a></li>
<li><a href="#572-__construct">57.2 __construct</a></li>
<li><a href="#573-fromconnectionstatic">57.3 FromConnection(static)</a></li>
<li><a href="#574-getkeyprotected">57.4 GetKey(protected)</a></li>
<li><a href="#575-seterrorprotected">57.5 SetError(protected)</a></li>
<li><a href="#576-set">57.6 Set</a></li>
<li><a href="#577-get">57.7 Get</a></li>
<li><a href="#578-delete">57.8 Delete</a></li>
<li><a href="#579-exists">57.9 Exists</a></li>
<li><a href="#5710-expire">57.10 Expire</a></li>
<li><a href="#5711-ping">57.11 Ping</a></li>
<li><a href="#5712-gettype">57.12 GetType</a></li>
<li><a href="#5713-listpush">57.13 ListPush</a></li>
<li><a href="#5714-listget">57.14 ListGet</a></li>
<li><a href="#5715-listremove">57.15 ListRemove</a></li>
<li><a href="#5716-setget">57.16 SetGet</a></li>
<li><a href="#5717-setadd">57.17 SetAdd</a></li>
<li><a href="#5718-setremove">57.18 SetRemove</a></li>
<li><a href="#5719-setexists">57.19 SetExists</a></li>
</ul>
</li>
<li><a href="#58-utility">58. Utility</a>
<ul>
<li><a href="#581-debugprintstatic">58.1 DebugPrint(static)</a></li>
<li><a href="#582-debugshowstatic">58.2 DebugShow(static)</a></li>
<li><a href="#583-getdbsidstatic">58.3 GetDBSID(static)</a></li>
<li><a href="#584-getdbssernostatic">58.4 GetDBSSERNO(static)</a></li>
<li><a href="#585-getrandom36static">58.5 GetRandom36(static)</a></li>
<li><a href="#586-validateemailstatic">58.6 ValidateEmail(static)</a></li>
<li><a href="#587-validatenationalidstatic">58.7 ValidateNationalID(static)</a></li>
<li><a href="#588-linkurlstatic">58.8 LinkURL(static)</a></li>
<li><a href="#589-linkurlswalstatic">58.9 LinkURLSwal(static)</a></li>
<li><a href="#5810-safesqlstatic">58.10 SafeSQL(static)</a></li>
<li><a href="#5811-safescriptstatic">58.11 SafeScript(static)</a></li>
<li><a href="#5812-safexssstatic">58.12 SafeXSS(static)</a></li>
<li><a href="#5813-checkmethodstatic">58.13 CheckMethod(static)</a></li>
<li><a href="#5814-replacetplstatic">58.14 ReplaceTPL(static)</a></li>
<li><a href="#5815-convertdbspictouristatic">58.15 ConvertDBSPICToURI(static)</a></li>
<li><a href="#5816-convertdbsfiletouristatic">58.16 ConvertDBSFileToURI(static)</a></li>
<li><a href="#5817-convertdbspathtouristatic">58.17 ConvertDBSPathToURI(static)</a></li>
<li><a href="#5818-gettimediffstatic">58.18 GetTimeDiff(static)</a></li>
<li><a href="#5819-readflagstatic">58.19 ReadFlag(static)</a></li>
<li><a href="#5820-writeflagstatic">58.20 WriteFlag(static)</a></li>
<li><a href="#5821-filtersensitiveifostatic">58.21 FilterSensitiveIFO(static)</a></li>
<li><a href="#5822-convertdatatimetotimestampstatic">58.22 ConvertDataTimeToTimestamp(static)</a></li>
<li><a href="#5823-converttimestamptodatatimestatic">58.23 ConvertTimestampToDataTime(static)</a></li>
<li><a href="#5824-trydecodejsonstatic">58.24 TryDecodeJson(static)</a></li>
<li><a href="#5825-tryencodejsonstatic">58.25 TryEncodeJson(static)</a></li>
<li><a href="#5826-getchineseweekdaystatic">58.26 GetChineseWeekday(static)</a></li>
<li><a href="#5827-getembedyoutubeurlstatic">58.27 GetEmbedYoutubeURL(static)</a></li>
<li><a href="#5828-replaceblankstatic">58.28 ReplaceBlank(static)</a></li>
<li><a href="#5829-convertnumtoletterstatic">58.29 ConvertNumToLetter(static)</a></li>
<li><a href="#5830-convertlettertonumstatic">58.30 ConvertLetterToNum(static)</a></li>
<li><a href="#5831-convertnumtochinesestatic">58.31 ConvertNumToChinese(static)</a></li>
<li><a href="#5832-convertnewlinestatic">58.32 ConvertNewLine(static)</a></li>
<li><a href="#5833-replacelinkintextstatic">58.33 ReplaceLinkInText(static)</a></li>
<li><a href="#5834-getlanguagepackstatic">58.34 GetLanguagePack(static)</a></li>
<li><a href="#5835-parserawhttprequeststatic">58.35 ParseRawHttpRequest(static)</a></li>
<li><a href="#5836-handlerequestdatastatic">58.36 HandleRequestData(static)</a></li>
<li><a href="#5837-getlanguagestatic">58.37 GetLanguage(static)</a></li>
</ul>
</li>
</ul>
&lt;!-- tocstop --&gt;
<h1>1. abstract Config</h1>
<h2>1.1 SetMultiCaseVariables</h2>
<pre><code class="language-php">public function SetMultiCaseVariables($Key, $Value, &amp;$Scope = null)
</code></pre>
<p>宣告不同命名規則的變數：給予變數的蛇形命名法(小寫)及其值，<br />
自動在指定的陣列中宣告蛇形、全大寫蛇形、小駝峰、大駝峰等四種命名規則的變數</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Key</code></td>
<td align="left"><code>string</code></td>
<td align="left">蛇形命名法(小寫)的變數名稱</td>
</tr>
<tr>
<td align="left"><code>$Value</code></td>
<td align="left"><code>mixed</code></td>
<td align="left">變數的值</td>
</tr>
<tr>
<td align="left"><code>$Scope</code></td>
<td align="left"><code>array</code></td>
<td align="left">變數作用的陣列，預設為 $GLOBALS</td>
</tr>
</tbody>
</table>
<h2>1.2 Validate</h2>
<pre><code class="language-php">public function Validate()
</code></pre>
<p>驗證設定完整性</p>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h1>2. ConfigDatabase extends Config</h1>
<h2>2.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Host</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料庫主機的域名或IP位置，如 <code>localhost</code> 或 <code>100.111.112.1</code></td>
</tr>
<tr>
<td align="left"><code>$Name</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料庫名稱</td>
</tr>
<tr>
<td align="left"><code>$User</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料庫使用者名稱</td>
</tr>
<tr>
<td align="left"><code>$Password</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料庫使用者密碼</td>
</tr>
<tr>
<td align="left"><code>$Link</code></td>
<td align="left"><code>\PDO</code></td>
<td align="left">資料庫連線 PDO 物件</td>
</tr>
</tbody>
</table>
<h2>2.2 __construct</h2>
<pre><code class="language-php">public function __construct($Host, $Name, $User, $Password = null)
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Host</code></td>
<td align="left"><code>string</code></td>
<td align="left">伺服器</td>
</tr>
<tr>
<td align="left"><code>$Name</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料庫名稱</td>
</tr>
<tr>
<td align="left"><code>$User</code></td>
<td align="left"><code>string</code></td>
<td align="left">使用者名稱</td>
</tr>
<tr>
<td align="left"><code>$Password</code></td>
<td align="left"><code>string</code></td>
<td align="left">使用者密碼</td>
</tr>
</tbody>
</table>
<h2>2.3 FromENV(static)</h2>
<pre><code class="language-php">static public function FromENV()
</code></pre>
<p>從環境變數建構</p>
<p><strong>回傳</strong></p>
<p>ConfigDatabase</p>
<h2>2.4 Deploy</h2>
<pre><code class="language-php">public function Deploy()
</code></pre>
<p>部署設定</p>
<h1>3. ConfigInit extends Config</h1>
<h2>3.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ErrorReporting</code></td>
<td align="left"><code>int</code></td>
<td align="left">錯誤回報等級，詳見 <a href="https://www.php.net/manual/en/errorfunc.constants.php">https://www.php.net/manual/en/errorfunc.constants.php</a></td>
</tr>
<tr>
<td align="left"><code>$TimeZone</code></td>
<td align="left"><code>string</code></td>
<td align="left">時區，詳見 <a href="https://www.php.net/manual/en/timezones.php">https://www.php.net/manual/en/timezones.php</a></td>
</tr>
</tbody>
</table>
<h2>3.2 __construct</h2>
<pre><code class="language-php">public function __construct($ErrorLevel = 0, $TimeZone = 'Asia/Taipei')
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ErrorLevel</code></td>
<td align="left"><code>int</code></td>
<td align="left">錯誤回報等級，詳見 <a href="https://www.php.net/manual/en/errorfunc.constants.php">https://www.php.net/manual/en/errorfunc.constants.php</a></td>
</tr>
<tr>
<td align="left"><code>$TimeZone</code></td>
<td align="left"><code>string</code></td>
<td align="left">時區，詳見 <a href="https://www.php.net/manual/en/timezones.php">https://www.php.net/manual/en/timezones.php</a></td>
</tr>
</tbody>
</table>
<h2>3.3 FromENV(static)</h2>
<pre><code class="language-php">static public function FromENV()
</code></pre>
<p>從環境變數建構</p>
<p><strong>回傳</strong></p>
<p>ConfigInit</p>
<h2>3.4 Deploy</h2>
<pre><code class="language-php">public function Deploy()
</code></pre>
<p>部署設定</p>
<h1>4. ConfigLanguage extends Config</h1>
<h2>4.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$LanguageCode</code></td>
<td align="left"><code>string</code></td>
<td align="left">語系代碼</td>
</tr>
<tr>
<td align="left"><code>$LanguageFile</code></td>
<td align="left"><code>string</code></td>
<td align="left">語言包檔案路徑</td>
</tr>
</tbody>
</table>
<h2>4.2 __construct</h2>
<pre><code class="language-php">public function __construct($LanguageCode, $LanguageFile)
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$LanguageCode</code></td>
<td align="left"><code>string</code></td>
<td align="left">語系代碼，如 <code>zh-tw</code></td>
</tr>
<tr>
<td align="left"><code>$LanguageFile</code></td>
<td align="left"><code>string</code></td>
<td align="left">語言包檔案路徑</td>
</tr>
</tbody>
</table>
<h2>4.3 Deploy</h2>
<pre><code class="language-php">public function Deploy()
</code></pre>
<p>部署設定</p>
<h1>5. ConfigPath extends Config</h1>
<h2>5.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$SiteName</code></td>
<td align="left"><code>string</code></td>
<td align="left">專案名稱</td>
</tr>
<tr>
<td align="left"><code>$ProjectDIR</code></td>
<td align="left"><code>string</code></td>
<td align="left">專案根目錄，如 <code>/var/www/misa_manage</code></td>
</tr>
<tr>
<td align="left"><code>$SchemaRootDIR</code></td>
<td align="left"><code>string</code></td>
<td align="left">專案存放用戶端 <code>schema</code> 檔案的資料夾路徑，如 <code>/var/www/misa_manage/site/schema</code></td>
</tr>
<tr>
<td align="left"><code>$ModeDIR</code></td>
<td align="left"><code>string</code></td>
<td align="left"><code>MISA-MOD</code> 資源庫的存放路徑，如 <code>/var/www/allen_mode/gold/v4.1.1/</code></td>
</tr>
<tr>
<td align="left"><code>$RootDIR</code></td>
<td align="left"><code>string</code></td>
<td align="left">專案用戶端的根目錄路徑，如 <code>/var/www/misa_manage/site</code></td>
</tr>
<tr>
<td align="left"><code>$DIRPath</code></td>
<td align="left"><code>string</code></td>
<td align="left">營運端上傳的檔案存放的目錄路徑，如 <code>/var/www/misa_manage/site/data/cht</code></td>
</tr>
<tr>
<td align="left"><code>$JSONPath</code></td>
<td align="left"><code>string</code></td>
<td align="left">專案存放快取的路徑，如 <code>/var/www/misa_manage/site/data</code></td>
</tr>
<tr>
<td align="left"><code>$RootURL</code></td>
<td align="left"><code>string</code></td>
<td align="left">專案用戶端目錄的網址，如 <code>http://localhost/misa_manage/site</code></td>
</tr>
<tr>
<td align="left"><code>$URLPath</code></td>
<td align="left"><code>string</code></td>
<td align="left">營運端上傳的檔案存放的目錄的網址，如 <code>http://localhost/misa_manage/site/data/cht</code></td>
</tr>
</tbody>
</table>
<h2>5.2 __construct</h2>
<pre><code class="language-php">public function __construct($SiteName, $ProjectDIR, $ModeDIR, $Protocol = 'https', $HostPath = 'localhost/site', $SiteDIRName = 'site')
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$SiteName</code></td>
<td align="left"><code>string</code></td>
<td align="left">專案名稱</td>
</tr>
<tr>
<td align="left"><code>$ProjectDIR</code></td>
<td align="left"><code>string</code></td>
<td align="left">專案目錄</td>
</tr>
<tr>
<td align="left"><code>$ModeDIR</code></td>
<td align="left"><code>string</code></td>
<td align="left">模式目錄</td>
</tr>
<tr>
<td align="left"><code>$Protocol</code></td>
<td align="left"><code>string</code></td>
<td align="left">網址協定</td>
</tr>
<tr>
<td align="left"><code>$HostPath</code></td>
<td align="left"><code>string</code></td>
<td align="left">主機名稱與路徑</td>
</tr>
<tr>
<td align="left"><code>$SiteDIRName</code></td>
<td align="left"><code>string</code></td>
<td align="left">專案用戶端目錄名稱</td>
</tr>
</tbody>
</table>
<h2>5.3 FromENV(static)</h2>
<pre><code class="language-php">static public function FromENV()
</code></pre>
<p>從環境變數建構</p>
<p><strong>回傳</strong></p>
<p>ConfigPath</p>
<h2>5.4 Deploy</h2>
<pre><code class="language-php">public function Deploy()
</code></pre>
<p>部署設定</p>
<h1>6. ConfigRedis extends Config</h1>
<h2>6.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Host</code></td>
<td align="left"><code>string</code></td>
<td align="left">Redis 伺服器位址</td>
</tr>
<tr>
<td align="left"><code>$Password</code></td>
<td align="left"><code>string</code></td>
<td align="left">Redis 伺服器密碼，無密碼時請傳入空字串</td>
</tr>
<tr>
<td align="left"><code>$Port</code></td>
<td align="left"><code>int</code></td>
<td align="left">Redis 伺服器埠號，預設為 <code>6379</code></td>
</tr>
<tr>
<td align="left"><code>$Link</code></td>
<td align="left"><code>\Predis\Client</code></td>
<td align="left">Redis 資料庫驅動</td>
</tr>
</tbody>
</table>
<h2>6.2 __construct</h2>
<pre><code class="language-php">public function __construct($Host, $Password = null, $Port = 6379)
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Host</code></td>
<td align="left"><code>string</code></td>
<td align="left">伺服器</td>
</tr>
<tr>
<td align="left"><code>$Password</code></td>
<td align="left"><code>string</code></td>
<td align="left">使用者密碼</td>
</tr>
<tr>
<td align="left"><code>$Port</code></td>
<td align="left"><code>int</code></td>
<td align="left">使用者密碼</td>
</tr>
</tbody>
</table>
<h2>6.3 FromENV(static)</h2>
<pre><code class="language-php">static public function FromENV()
</code></pre>
<p>從環境變數建立 ConfigRedis 物件</p>
<p><strong>回傳</strong></p>
<p>ConfigRedis</p>
<h2>6.4 Deploy</h2>
<pre><code class="language-php">public function Deploy()
</code></pre>
<p>部署設定</p>
<h1>7. ConfigSMS extends Config</h1>
<h2>7.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Username</code></td>
<td align="left"><code>string</code></td>
<td align="left">簡訊服務社帳號</td>
</tr>
<tr>
<td align="left"><code>$Password</code></td>
<td align="left"><code>string</code></td>
<td align="left">簡訊服務社密碼</td>
</tr>
<tr>
<td align="left"><code>$AppURL</code></td>
<td align="left"><code>string</code></td>
<td align="left">簡訊服務社簡訊發送網址</td>
</tr>
</tbody>
</table>
<h2>7.2 __construct</h2>
<pre><code class="language-php">public function __construct($Username, $Password, $URL)
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Service</code></td>
<td align="left"><code>string</code></td>
<td align="left">簡訊服務社</td>
</tr>
<tr>
<td align="left"><code>$Username</code></td>
<td align="left"><code>string</code></td>
<td align="left">簡訊服務社帳號</td>
</tr>
<tr>
<td align="left"><code>$Password</code></td>
<td align="left"><code>string</code></td>
<td align="left">簡訊服務社密碼</td>
</tr>
<tr>
<td align="left"><code>$URL</code></td>
<td align="left"><code>string</code></td>
<td align="left">簡訊服務社簡訊發送網址</td>
</tr>
</tbody>
</table>
<h2>7.3 Deploy</h2>
<pre><code class="language-php">public function Deploy()
</code></pre>
<p>部署設定</p>
<h2>7.4 Validate</h2>
<pre><code class="language-php">public function Validate()
</code></pre>
<p>驗證設定完整性</p>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h1>8. ConfigSMTP extends Config</h1>
<h2>8.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Host</code></td>
<td align="left"><code>string</code></td>
<td align="left">伺服器的域名或IP位置，如 <code>smtp.gmail.com</code> 或 <code>100.111.112.1</code></td>
</tr>
<tr>
<td align="left"><code>$User</code></td>
<td align="left"><code>string</code></td>
<td align="left">伺服器的用戶名稱</td>
</tr>
<tr>
<td align="left"><code>$Password</code></td>
<td align="left"><code>string</code></td>
<td align="left">伺服器的密碼</td>
</tr>
<tr>
<td align="left"><code>$From</code></td>
<td align="left"><code>string</code></td>
<td align="left">寄件人的電子郵件地址</td>
</tr>
<tr>
<td align="left"><code>$FromName</code></td>
<td align="left"><code>string</code></td>
<td align="left">寄件人的名稱</td>
</tr>
<tr>
<td align="left"><code>$ProxyAppID</code></td>
<td align="left"><code>string</code></td>
<td align="left">郵件代理服務應用程式名稱</td>
</tr>
<tr>
<td align="left"><code>$ProxyCryptPassPhrase</code></td>
<td align="left"><code>string</code></td>
<td align="left">郵件代理加密密碼片語</td>
</tr>
<tr>
<td align="left"><code>$ProxyPath</code></td>
<td align="left"><code>string</code></td>
<td align="left">郵件代理服務的 API 網址</td>
</tr>
<tr>
<td align="left"><code>$ProxyURL</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>(protected)</strong> 郵件代理服務的完整 API 網址</td>
</tr>
</tbody>
</table>
<h2>8.2 __construct</h2>
<pre><code class="language-php">public function __construct($Host, $User, $Password, $From, $FromName)
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Host</code></td>
<td align="left"><code>string</code></td>
<td align="left">伺服器</td>
</tr>
<tr>
<td align="left"><code>$User</code></td>
<td align="left"><code>string</code></td>
<td align="left">使用者名稱</td>
</tr>
<tr>
<td align="left"><code>$Password</code></td>
<td align="left"><code>string</code></td>
<td align="left">使用者密碼</td>
</tr>
<tr>
<td align="left"><code>$From</code></td>
<td align="left"><code>string</code></td>
<td align="left">寄件者</td>
</tr>
<tr>
<td align="left"><code>$FromName</code></td>
<td align="left"><code>string</code></td>
<td align="left">寄件者名稱</td>
</tr>
</tbody>
</table>
<h2>8.3 FromENV(static)</h2>
<pre><code class="language-php">static public function FromENV($AddProxyQueue = true)
</code></pre>
<p>從環境變數建構，如果環境變數包含 <code>EMAIL_PROXY_APP_ID</code>，則會一併設定郵件代理服務</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$AddProxyQueue</code></td>
<td align="left"><code>bool</code></td>
<td align="left">是否加入佇列，預設為 <code>true</code></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>ConfigSMTP</p>
<h2>8.4 SetMailProxy</h2>
<pre><code class="language-php">public function SetMailProxy($ProxyAppID, $ProxyCryptPassPhrase, $ProxyRoot, $AddQueue = true)
</code></pre>
<p>設定郵件代理服務</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ProxyAppID</code></td>
<td align="left"><code>string</code></td>
<td align="left">郵件代理服務應用程式名稱</td>
</tr>
<tr>
<td align="left"><code>$ProxyCryptPassPhrase</code></td>
<td align="left"><code>string</code></td>
<td align="left">郵件加密密碼片語</td>
</tr>
<tr>
<td align="left"><code>$ProxyRoot</code></td>
<td align="left"><code>string</code></td>
<td align="left">郵件代理服務的 API 網址</td>
</tr>
<tr>
<td align="left"><code>$AddQueue</code></td>
<td align="left"><code>bool</code></td>
<td align="left">是否加入佇列</td>
</tr>
</tbody>
</table>
<h2>8.5 SetMailService</h2>
<pre><code class="language-php">public function SetMailService($AppId, $CryptPassPhrase, $AppPath, $AddQueue = true)
</code></pre>
<p>設定郵件代理服務 (舊版，請改用 <code>SetMailProxy</code>)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$AppID</code></td>
<td align="left"><code>string</code></td>
<td align="left">郵件代理服務應用程式名稱</td>
</tr>
<tr>
<td align="left"><code>$CryptPassPhrase</code></td>
<td align="left"><code>string</code></td>
<td align="left">郵件加密密碼片語</td>
</tr>
<tr>
<td align="left"><code>$AppPath</code></td>
<td align="left"><code>string</code></td>
<td align="left">郵件代理服務的 API 網址</td>
</tr>
<tr>
<td align="left"><code>$AddQueue</code></td>
<td align="left"><code>bool</code></td>
<td align="left">是否加入佇列</td>
</tr>
</tbody>
</table>
<h2>8.6 Deploy</h2>
<pre><code class="language-php">public function Deploy()
</code></pre>
<p>部署設定</p>
<h2>8.7 Validate</h2>
<pre><code class="language-php">public function Validate()
</code></pre>
<p>驗證設定內容</p>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>8.8 GetProxyURL</h2>
<pre><code class="language-php">public function GetProxyURL()
</code></pre>
<p>取得郵件服務的完整 API 網址</p>
<p><strong>回傳</strong></p>
<p><code>string</code></p>
<h2>8.9 GetSMTPArray</h2>
<pre><code class="language-php">public function GetSMTPArray()
</code></pre>
<p>取得SMTP伺服器的設定關聯陣列，包含 Host, Username, Password, ServiceMail, Title 等鍵</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h1>9. ConfigTableName extends Config</h1>
<h2>9.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$TableJSONFile</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料表名稱快取JSON的路徑</td>
</tr>
<tr>
<td align="left"><code>$DatabaseConfig</code></td>
<td align="left"><code>ConfigDatabase</code></td>
<td align="left"><strong>(protected)</strong> 資料庫連線的設定物件</td>
</tr>
</tbody>
</table>
<h2>9.2 __construct</h2>
<pre><code class="language-php">public function __construct($TableJSONFile, $DatabaseConfig)
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$TableJSONFile</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料表JSON檔案路徑</td>
</tr>
<tr>
<td align="left"><code>$Database</code></td>
<td align="left"><code>ConfigDatabase</code></td>
<td align="left">資料庫連線設定</td>
</tr>
</tbody>
</table>
<h2>9.3 Deploy</h2>
<pre><code class="language-php">public function Deploy()
</code></pre>
<p>部署設定</p>
<h1>10. ConfigTrade extends Config</h1>
<h2>10.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$TaxRate</code></td>
<td align="left"><code>float</code></td>
<td align="left">營業稅率</td>
</tr>
<tr>
<td align="left"><code>$PricePrecision</code></td>
<td align="left"><code>int</code></td>
<td align="left">價格的小數位數</td>
</tr>
<tr>
<td align="left"><code>$UnitPriceIncludesTax</code></td>
<td align="left"><code>bool</code></td>
<td align="left">產品售價是否已含稅</td>
</tr>
<tr>
<td align="left"><code>$Currency</code></td>
<td align="left"><code>string</code></td>
<td align="left">交易用貨幣</td>
</tr>
<tr>
<td align="left"><code>$CreateINVBeforeDelivery</code></td>
<td align="left"><code>bool</code></td>
<td align="left">是否在出貨前建立發票；若此值為 <code>true</code>，則訂單在狀態事件 <code>OnWaitingDelivery</code> 會建立發票；反之則在狀態事件 <code>OnDelivery</code> 建立發票</td>
</tr>
<tr>
<td align="left"><code>$ActiveGoods</code></td>
<td align="left"><code>bool</code></td>
<td align="left">是否在建立產品(PDTIFO)時同步建立物料(Goods)資料</td>
</tr>
<tr>
<td align="left"><code>$SALODRNoticeDocuments</code></td>
<td align="left"><code>array</code></td>
<td align="left">訂單通知訊息範本文件的關聯陣列。&lt;br&gt;陣列的鍵是訂單狀態事件名稱：<code>OnWaitingDeal</code>, <code>OnDeal</code>, <code>OnWaitingPayment</code>, <code>OnPayment</code>, <code>OnWaitingDelivery</code>, <code>OnDelivery</code>, <code>OnWaitingReturn</code>, <code>OnReturn</code>, <code>OnWaitingRefund</code>, <code>OnRefund</code>, <code>OnWaitingClose</code>, <code>OnClose</code>&lt;br&gt;陣列中的每個值都是一個範本文件的資訊陣列，有以下兩個鍵：&lt;br&gt;<code>TPLDOCID</code>：範本文件的 REFODCID&lt;br&gt;<code>ReplaceArray</code>：範本文件的待替換關鍵字數值陣列</td>
</tr>
<tr>
<td align="left"><code>$Receipt</code></td>
<td align="left"><code>array</code></td>
<td align="left">發票相關設定</td>
</tr>
</tbody>
</table>
<h2>10.2 __construct</h2>
<pre><code class="language-php">public function __construct($PricePrecision = 1, $TaxRate = 0.05, $UnitPriceIncludesTax = true, $Currency = 'NTD', $CreateINVBeforeDelivery = true, $ActiveGoods = true, $Receipt = array())
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$PricePrecision</code></td>
<td align="left"><code>int</code></td>
<td align="left">價格的小數位數</td>
</tr>
<tr>
<td align="left"><code>$TaxRate</code></td>
<td align="left"><code>float</code></td>
<td align="left">營業稅率</td>
</tr>
<tr>
<td align="left"><code>$UnitPriceIncludesTax</code></td>
<td align="left"><code>bool</code></td>
<td align="left">產品售價是否已包含營業稅</td>
</tr>
<tr>
<td align="left"><code>$Currency</code></td>
<td align="left"><code>string</code></td>
<td align="left">交易用貨幣</td>
</tr>
<tr>
<td align="left"><code>$CreateINVBeforeDelivery</code></td>
<td align="left"><code>bool</code></td>
<td align="left">是否在出貨前建立發票</td>
</tr>
<tr>
<td align="left"><code>$ActiveGoods</code></td>
<td align="left"><code>bool</code></td>
<td align="left">是否在建立產品(PDTIFO)時同步建立物料(Goods)資料</td>
</tr>
<tr>
<td align="left"><code>$Receipt</code></td>
<td align="left"><code>array</code></td>
<td align="left">發票相關設定</td>
</tr>
</tbody>
</table>
<h2>10.3 FromENV(static)</h2>
<pre><code class="language-php">static public function FromENV()
</code></pre>
<p>從環境變數建構</p>
<p><strong>回傳</strong></p>
<p>ConfigTrade</p>
<h2>10.4 Deploy</h2>
<pre><code class="language-php">public function Deploy()
</code></pre>
<p>部署設定</p>
<h1>11. abstract DBSMOD</h1>
<h2>11.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DBSLink</code></td>
<td align="left"><code>\PDO</code></td>
<td align="left">PDO 物件</td>
</tr>
<tr>
<td align="left"><code>$DBS</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料庫名稱</td>
</tr>
<tr>
<td align="left"><code>$Tables</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> 本物件關聯的資料表資訊關聯陣列&lt;br&gt;陣列中各元素的鍵為資料表名稱，值為 DBSTableEntity 物件&lt;br&gt;本屬性在建構時自動寫入</td>
</tr>
<tr>
<td align="left"><code>$DefaultTable</code></td>
<td align="left"><code>string</code></td>
<td align="left">預設資料表名稱&lt;br&gt;本物件的方法被呼叫時，若未帶入引數 $TableName, $TablePK&lt;br&gt;則使用此屬性作為資料表名稱</td>
</tr>
<tr>
<td align="left"><code>$Error</code></td>
<td align="left"><code>\Exception</code></td>
<td align="left">錯誤訊息</td>
</tr>
</tbody>
</table>
<h2>11.2 __construct</h2>
<pre><code class="language-php">public function __construct($DBSLink, $DBS)
</code></pre>
<p>類別建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DBSLink</code></td>
<td align="left"><code>\PDO</code></td>
<td align="left">PDO 物件</td>
</tr>
<tr>
<td align="left"><code>$DBS</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料庫名稱</td>
</tr>
</tbody>
</table>
<h2>11.3 SetTables(protected)</h2>
<pre><code class="language-php">abstract protected function SetTables();
</code></pre>
<p>抽象方法:<br />
繼承 <code>DBSMOD</code> 的類別必須實作的抽象方法<br />
在建構實例時會呼叫以設定相關資料表的資訊<br />
回傳本物件關聯的資料表名稱的數值陣列<br />
第一個元素為預設的資料表名稱</p>
<pre><code class="language-php">class DBSMOD_Example extends DBSMOD  
{  
  protected function SetTables()  
  {  
    $Tbs = ['PDTIFO', 'PDTStock', 'PDTIFOTYP', 'RT_PDTIFOTYP_PDTIFO'];  
    return array_map(function ($Tb) {  
      return $GLOBALS[$Tb . '_Tb'];  
    }, $Tbs);  
  }  
}  
</code></pre>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>11.4 DBSSelect(protected)</h2>
<pre><code class="language-php">protected function DBSSelect($ID, $Field_Array = array(), $TableName = &quot;&quot;, $TablePK = &quot;&quot;)
</code></pre>
<p>在指定資料表(預設為主要資料表)查詢指定 ID 的單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">查詢目標的主鍵</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">資料表欄位名稱的陣列</td>
</tr>
<tr>
<td align="left"><code>$TableName</code></td>
<td align="left"><code>string</code></td>
<td align="left">非必填: 資料表名稱，預設為物件的 $TableName</td>
</tr>
<tr>
<td align="left"><code>$TablePK</code></td>
<td align="left"><code>string</code></td>
<td align="left">非必填: 資料表主鍵欄位名稱，預設為物件的 $TablePK</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 查詢成功時回傳以資料表欄位名稱為鍵的關聯式陣列</p>
<h2>11.5 DBSInsert(protected)</h2>
<pre><code class="language-php">protected function DBSInsert($R_Data, $TableName = &quot;&quot;, $TablePK = &quot;&quot;)
</code></pre>
<p>在指定資料表(預設為主要資料表)新增單筆資料，被 <code>$TablePK</code> 指定的欄位會填入自動產生的 ID</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">資料表欄位名稱與資料的映射</td>
</tr>
<tr>
<td align="left"><code>$TableName</code></td>
<td align="left"><code>string</code></td>
<td align="left">非必填: 資料表名稱，預設為物件的 $TableName</td>
</tr>
<tr>
<td align="left"><code>$TablePK</code></td>
<td align="left"><code>string</code></td>
<td align="left">非必填: 資料表主鍵欄位名稱，預設為物件的 $TablePK</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 新增成功時回傳包含主鍵及 <code>SERNO</code> 的關聯式陣列</p>
<h2>11.6 DBSUpdate(protected)</h2>
<pre><code class="language-php">protected function DBSUpdate($ID, $R_Data, $TableName = &quot;&quot;, $TablePK = &quot;&quot;)
</code></pre>
<p>在指定資料表(預設為主要資料表)更新指定 ID 的單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">查詢目標的主鍵</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">資料表欄位名稱與資料的映射</td>
</tr>
<tr>
<td align="left"><code>$TableName</code></td>
<td align="left"><code>string</code></td>
<td align="left">非必填: 資料表名稱，預設為物件的 $TableName</td>
</tr>
<tr>
<td align="left"><code>$TablePK</code></td>
<td align="left"><code>string</code></td>
<td align="left">非必填: 資料表主鍵欄位名稱，預設為物件的 $TablePK</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 更新成功時回傳包含主鍵及 <code>SERNO</code> 的關聯式陣列</p>
<h2>11.7 DBSDelete(protected)</h2>
<pre><code class="language-php">protected function DBSDelete($ID, $TableName = &quot;&quot;, $TablePK = &quot;&quot;, $ForceDelete = false)
</code></pre>
<p>在指定資料表(預設為主要資料表)刪除指定 ID 的單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">查詢目標的主鍵</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 刪除成功時回傳 <code>true</code></p>
<h2>11.8 DataExist(protected)</h2>
<pre><code class="language-php">protected function DataExist($ID, $TableName = &quot;&quot;, $TablePK = &quot;&quot;)
</code></pre>
<p>在指定資料表(預設為主要資料表)檢查指定 ID 的單筆資料是否存在</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">查詢目標的主鍵</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">資料表欄位名稱與資料的映射</td>
</tr>
<tr>
<td align="left"><code>$TableName</code></td>
<td align="left"><code>string</code></td>
<td align="left">非必填: 資料表名稱，預設為物件的 $TableName</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 若指定 ID 資料已存在回傳 <code>true</code>，反之回傳 <code>false</code></p>
<h2>11.9 ReadFlag</h2>
<pre><code class="language-php">public function ReadFlag($Flag, $Index)
</code></pre>
<p>旗標字串讀取函式，以最右側的字元為 <code>0</code> 位</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Flag</code></td>
<td align="left"><code>string</code></td>
<td align="left">待讀取的旗標</td>
</tr>
<tr>
<td align="left"><code>$Index</code></td>
<td align="left"><code>int</code></td>
<td align="left">指定的索引，以字串中最右邊的字元為 <code>0</code> 位</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code>|<code>false</code> 回傳指定索引的旗標字元</p>
<h2>11.10 WriteFlag</h2>
<pre><code class="language-php">public function WriteFlag($Flag, $Index, $NewChar = &quot;&quot;)
</code></pre>
<p>旗標字串寫入函式，以最右側的字元為 <code>0</code> 位</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Flag</code></td>
<td align="left"><code>string</code></td>
<td align="left">待寫入的旗標</td>
</tr>
<tr>
<td align="left"><code>$Index</code></td>
<td align="left"><code>int</code></td>
<td align="left">指定的索引，以字串中最右邊的字元為 <code>0</code> 位</td>
</tr>
<tr>
<td align="left"><code>$NewChar</code></td>
<td align="left"><code>string</code></td>
<td align="left">寫入旗標指定索引的字元</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code>|<code>false</code> 回傳修改後的旗標字串</p>
<h2>11.11 GetTables</h2>
<pre><code class="language-php">public function GetTables()
</code></pre>
<p>取得物件的 Tables 屬性</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h1>12. DBSMOD_Appointment extends DBSMOD</h1>
<h2>12.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$StatusFlagKeys</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>Appointment.StatusFlag</code> 掛號每個旗標所象徵的狀態</td>
</tr>
<tr>
<td align="left"><code>$RequiredStatus</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>Appointment.StatusFlag</code> 初始即不為空值的旗標</td>
</tr>
<tr>
<td align="left"><code>$AutoCompleteStatus</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>Appointment.StatusFlag</code> 初始即為完成的旗標</td>
</tr>
</tbody>
</table>
<h2>12.2 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>12.3 Select</h2>
<pre><code class="language-php">public function Select($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">AppointmentID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>12.4 Create</h2>
<pre><code class="language-php">public function Create($R_Data)
</code></pre>
<p>新增掛號資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">掛號資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>12.5 Update</h2>
<pre><code class="language-php">public function Update($ID, $R_Data)
</code></pre>
<p>更新掛號資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">AppointmentID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">掛號資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>12.6 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除掛號資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">AppointmentID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>12.7 GetInitStatusFlag(protected)</h2>
<pre><code class="language-php">protected function GetInitStatusFlag()
</code></pre>
<p>取得初始狀態旗標字串</p>
<p><strong>回傳</strong></p>
<p><code>string</code></p>
<h1>13. DBSMOD_Assignment extends DBSMOD_DOC</h1>
<h2>13.1 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>13.2 SelectHandIn</h2>
<pre><code class="language-php">public function SelectHandIn($ID, $Field_Array = array())
</code></pre>
<p>取得作業繳交資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">AssignmentHandInID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>13.3 CreateHandIn</h2>
<pre><code class="language-php">public function CreateHandIn($R_Data)
</code></pre>
<p>建立作業繳交資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">作業繳交的資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>13.4 UpdateHandIn</h2>
<pre><code class="language-php">public function UpdateHandIn($ID, $R_Data)
</code></pre>
<p>更新作業繳交資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">AssignmentHandInID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">作業繳交的資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>13.5 DeleteHandIn</h2>
<pre><code class="language-php">public function DeleteHandIn($ID)
</code></pre>
<p>刪除作業繳交資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">AssignmentHandInID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>13.6 AppendCourse</h2>
<pre><code class="language-php">public function AppendCourse($AssignmentDOCID, $CourseID)
</code></pre>
<p>新增作業文件與課程關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$AssignmentDOCID</code></td>
<td align="left"><code>string</code></td>
<td align="left">AssignmentDOCID</td>
</tr>
<tr>
<td align="left"><code>$CourseID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CourseID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>13.7 RemoveCourse</h2>
<pre><code class="language-php">public function RemoveCourse($AssignmentDOCID, $CourseID)
</code></pre>
<p>移除作業文件與課程關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$AssignmentDOCID</code></td>
<td align="left"><code>string</code></td>
<td align="left">AssignmentDOCID</td>
</tr>
<tr>
<td align="left"><code>$CourseID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CourseID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>13.8 Export</h2>
<pre><code class="language-php">public function Export($AssignmentDOCID)
</code></pre>
<p>TODO: 匯出作業文件、所屬課程、底下的作業繳交資料<br />
待完成 Archive, Spreadsheet 等模組後，再實作</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$AssignmentDOCID</code></td>
<td align="left"><code>string</code></td>
<td align="left">AssignmentDOCID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>bool</code></p>
<h1>14. DBSMOD_BulletinDOC extends DBSMOD_DOC</h1>
<h2>14.1 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>14.2 AppendCourse</h2>
<pre><code class="language-php">public function AppendCourse($BulletinDOCID, $CourseID)
</code></pre>
<p>新增公告文件與課程關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$BulletinDOCID</code></td>
<td align="left"><code>string</code></td>
<td align="left">BulletinDOCID</td>
</tr>
<tr>
<td align="left"><code>$CourseID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CourseID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>14.3 RemoveCourse</h2>
<pre><code class="language-php">public function RemoveCourse($BulletinDOCID, $CourseID)
</code></pre>
<p>移除公告文件與課程關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$CourseID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CourseID</td>
</tr>
<tr>
<td align="left"><code>$BulletinDOCID</code></td>
<td align="left"><code>string</code></td>
<td align="left">BulletinDOCID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h1>15. DBSMOD_Coupon extends DBSMOD</h1>
<h2>15.1 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>15.2 Select</h2>
<pre><code class="language-php">public function Select($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CouponID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>15.3 Create</h2>
<pre><code class="language-php">public function Create($R_Data)
</code></pre>
<p>新增資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">Coupon資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>15.4 Update</h2>
<pre><code class="language-php">public function Update($ID, $R_Data)
</code></pre>
<p>更新資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CouponID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">Coupon資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>15.5 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CouponID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>15.6 SelectTYP</h2>
<pre><code class="language-php">public function SelectTYP($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆 CouponTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CouponTYPID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>15.7 CreateTYP</h2>
<pre><code class="language-php">public function CreateTYP($R_Data)
</code></pre>
<p>新增資料 CouponTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">CouponTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>15.8 UpdateTYP</h2>
<pre><code class="language-php">public function UpdateTYP($ID, $R_Data)
</code></pre>
<p>更新資料 CouponTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CouponTYPID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">CouponTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>15.9 DeleteTYP</h2>
<pre><code class="language-php">public function DeleteTYP($ID)
</code></pre>
<p>刪除資料 CouponTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CouponTYPID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>15.10 SelectCode</h2>
<pre><code class="language-php">public function SelectCode($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆 CouponCode</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CouponCodeID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>15.11 CreateCode</h2>
<pre><code class="language-php">public function CreateCode($R_Data)
</code></pre>
<p>新增資料 CouponCode</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">CouponCode資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>15.12 UpdateCode</h2>
<pre><code class="language-php">public function UpdateCode($ID, $R_Data)
</code></pre>
<p>更新資料 CouponCode</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CouponCodeID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">CouponCode資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>15.13 DeleteCode</h2>
<pre><code class="language-php">public function DeleteCode($ID)
</code></pre>
<p>刪除資料 CouponCode</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CouponCodeID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>15.14 ExchangeCoupon</h2>
<pre><code class="language-php">public function ExchangeCoupon($CouponID, $UserID, $Note = '', $DateTime = null)
</code></pre>
<p>兌換 Coupon；若成功，會同時更新 CouponCode、CouponEHG、Coupon 資料表</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$CouponID</code></td>
<td align="left"><code>string</code></td>
<td align="left">要兌換的 CouponID</td>
</tr>
<tr>
<td align="left"><code>$UserID</code></td>
<td align="left"><code>string</code></td>
<td align="left">兌換者的 UserID</td>
</tr>
<tr>
<td align="left"><code>$Note</code></td>
<td align="left"><code>string</code></td>
<td align="left">非必填，兌換備註，預設為空字串</td>
</tr>
<tr>
<td align="left"><code>$DateTime</code></td>
<td align="left"><code>string</code></td>
<td align="left">非必填，兌換時間，預設為當前時間</td>
</tr>
</tbody>
</table>
<h2>15.15 UpdateTYPIFOCNT(protected)</h2>
<pre><code class="language-php">protected function UpdateTYPIFOCNT($ID, $Count = 1)
</code></pre>
<p>更新資料計數</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CouponTYPID</td>
</tr>
<tr>
<td align="left"><code>$Count</code></td>
<td align="left"><code>integer</code></td>
<td align="left">計數待相加的數字</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>int</code>|<code>bool</code></p>
<h1>16. DBSMOD_Course extends DBSMOD</h1>
<h2>16.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$StatusFlagKeys</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>Course.StatusFlag</code> 課程每個旗標所象徵的狀態</td>
</tr>
<tr>
<td align="left"><code>$RequiredStatus</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>Course.StatusFlag</code> 初始即不為空值的旗標</td>
</tr>
<tr>
<td align="left"><code>$AutoCompleteStatus</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>Course.StatusFlag</code> 初始即為完成的旗標</td>
</tr>
</tbody>
</table>
<h2>16.2 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>16.3 Select</h2>
<pre><code class="language-php">public function Select($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CourseID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>16.4 Create</h2>
<pre><code class="language-php">public function Create($R_Data)
</code></pre>
<p>新增資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">Course資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>16.5 Update</h2>
<pre><code class="language-php">public function Update($ID, $R_Data)
</code></pre>
<p>更新資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CourseID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">Course 資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>16.6 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除課程資料；一併刪除教科書的關聯資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CourseID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>16.7 SelectTYP</h2>
<pre><code class="language-php">public function SelectTYP($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆 CourseTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CourseTYPID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>16.8 CreateTYP</h2>
<pre><code class="language-php">public function CreateTYP($R_Data)
</code></pre>
<p>新增資料 CourseTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">CourseTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>16.9 UpdateTYP</h2>
<pre><code class="language-php">public function UpdateTYP($ID, $R_Data)
</code></pre>
<p>更新資料 CourseTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CourseTYPID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">CourseTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>16.10 DeleteTYP</h2>
<pre><code class="language-php">public function DeleteTYP($ID)
</code></pre>
<p>刪除資料 CourseTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CourseTYPID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>16.11 SelectTOCItem</h2>
<pre><code class="language-php">public function SelectTOCItem($ID, $Field_Array = array())
</code></pre>
<p>取得課程目錄項目</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CourseTOCITMID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>16.12 CreateTOCItem</h2>
<pre><code class="language-php">public function CreateTOCItem($R_Data, $PreviousItemID = null)
</code></pre>
<p>建立課程目錄項目，並更新同課程中其他章節的序號</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">課程目錄項目的資料</td>
</tr>
<tr>
<td align="left"><code>$PreviousItemID</code></td>
<td align="left"><code>string</code></td>
<td align="left">排序在前一個的課程目錄項目ID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>16.13 UpdateTOCItem</h2>
<pre><code class="language-php">public function UpdateTOCItem($ID, $R_Data)
</code></pre>
<p>更新課程目錄項目，並更新同課程中其他章節的序號</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CourseTOCITMID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">課程目錄項目的資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>16.14 DeleteTOCItem</h2>
<pre><code class="language-php">public function DeleteTOCItem($ID)
</code></pre>
<p>刪除課程目錄項目，並更新同課程中其他章節的序號</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CourseTOCITMID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>16.15 AppendTextbook</h2>
<pre><code class="language-php">public function AppendTextbook($CourseID, $TextbookID)
</code></pre>
<p>新增教科書與課程關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$CourseID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CourseID</td>
</tr>
<tr>
<td align="left"><code>$TextbookID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TextbookID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>16.16 RemoveTextbook</h2>
<pre><code class="language-php">public function RemoveTextbook($CourseID, $TextbookID)
</code></pre>
<p>移除課程與教科書的關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$CourseID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CourseID</td>
</tr>
<tr>
<td align="left"><code>$TextbookID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TextbookID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>16.17 UpdateTYPIFOCNT(protected)</h2>
<pre><code class="language-php">protected function UpdateTYPIFOCNT($ID, $Count = 1)
</code></pre>
<p>更新資料計數</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CourseTYPID</td>
</tr>
<tr>
<td align="left"><code>$Count</code></td>
<td align="left"><code>integer</code></td>
<td align="left">計數待相加的數字</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>int</code>|<code>bool</code></p>
<h2>16.18 GetInitStatusFlag(protected)</h2>
<pre><code class="language-php">protected function GetInitStatusFlag()
</code></pre>
<p>取得初始狀態旗標字串</p>
<p><strong>回傳</strong></p>
<p><code>string</code></p>
<h1>17. DBSMOD_CUS extends DBSMOD</h1>
<h2>17.1 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>17.2 Select</h2>
<pre><code class="language-php">public function Select($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CUSIFOID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>17.3 Create</h2>
<pre><code class="language-php">public function Create($R_Data)
</code></pre>
<p>新增資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">CUSIFO資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>17.4 Update</h2>
<pre><code class="language-php">public function Update($ID, $R_Data)
</code></pre>
<p>更新資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CUSIFOID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">CUSIFO資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>17.5 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CUSIFOID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>17.6 SelectTYP</h2>
<pre><code class="language-php">public function SelectTYP($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆 CUSIFOTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CUSIFOTYPID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>17.7 CreateTYP</h2>
<pre><code class="language-php">public function CreateTYP($R_Data)
</code></pre>
<p>新增資料 CUSIFOTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">CUSIFOTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>17.8 UpdateTYP</h2>
<pre><code class="language-php">public function UpdateTYP($ID, $R_Data)
</code></pre>
<p>更新資料 CUSIFOTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CUSIFOTYPID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">CUSIFOTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>17.9 DeleteTYP</h2>
<pre><code class="language-php">public function DeleteTYP($ID)
</code></pre>
<p>刪除資料 CUSIFOTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CUSIFOTYPID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>17.10 UpdateTYPIFOCNT(protected)</h2>
<pre><code class="language-php">protected function UpdateTYPIFOCNT($ID, $Count = 1)
</code></pre>
<p>更新資料計數</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CUSIFOTYPID</td>
</tr>
<tr>
<td align="left"><code>$Count</code></td>
<td align="left"><code>integer</code></td>
<td align="left">計數待相加的數字</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>int</code>|<code>bool</code></p>
<h1>18. DBSMOD_DOC extends DBSMOD</h1>
<h2>18.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$StatusFlagKeys</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>REFDOC.StatusFlag</code> 文件每個旗標所象徵的狀態</td>
</tr>
<tr>
<td align="left"><code>$RequiredStatus</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>REFDOC.StatusFlag</code> 初始即不為空值的旗標</td>
</tr>
<tr>
<td align="left"><code>$AutoCompleteStatus</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>REFDOC.StatusFlag</code> 初始即為完成的旗標</td>
</tr>
<tr>
<td align="left"><code>$DraftFields</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> 文件在草稿時可寫入的 <code>REFDOC</code> 資料欄位名稱的數值陣列</td>
</tr>
<tr>
<td align="left"><code>$TYPTable</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>(protected)</strong> 文件類別資料表名稱</td>
</tr>
<tr>
<td align="left"><code>$TYPTablePK</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>(protected)</strong> 文件類別資料表主鍵欄位名稱</td>
</tr>
</tbody>
</table>
<h2>18.2 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)，並寫入 $this-&gt;TYPTable, $this-&gt;TYPTablePK</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>18.3 Select</h2>
<pre><code class="language-php">public function Select($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">REFDOCID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>18.4 Create</h2>
<pre><code class="language-php">public function Create($R_Data)
</code></pre>
<p>新增資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">REFDOC資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>18.5 Update</h2>
<pre><code class="language-php">public function Update($ID, $R_Data, $AccumulateModifyCNT = false)
</code></pre>
<p>更新資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">REFDOCID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">REFDOC 資料表欄位名稱與資料的映射</td>
</tr>
<tr>
<td align="left"><code>$AccumulateModifyCNT</code></td>
<td align="left"><code>bool</code></td>
<td align="left">是否需要累計修改計數，若為 <code>true</code> 則累計</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>18.6 Approve</h2>
<pre><code class="language-php">public function Approve($DraftID)
</code></pre>
<p>核准文件</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DraftID</code></td>
<td align="left"><code>string</code></td>
<td align="left">草稿的 REFDOCID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>18.7 AccumulateCNT</h2>
<pre><code class="language-php">public function AccumulateCNT($ID, $Field, $Count = 1)
</code></pre>
<p>累計文件計數 ReadCNT|RSPCNT|TotalRSPCNT|LikeCNT|ShareCNT|CMTCNT|ModifyCNT</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">REFDOCID</td>
</tr>
<tr>
<td align="left"><code>$Field</code></td>
<td align="left"><code>string</code></td>
<td align="left">累計計數的欄位</td>
</tr>
<tr>
<td align="left"><code>$Count</code></td>
<td align="left"><code>int</code></td>
<td align="left">累計的值</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>18.8 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除文件資料；若刪除的文件為草稿，則一併變更原文件狀態旗標；若刪除的文件為發佈文件，則一併刪除草稿</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">REFDOCID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>18.9 CreateDraftFromDOC</h2>
<pre><code class="language-php">public function CreateDraftFromDOC($ID, $R_Data)
</code></pre>
<p>建立既有文件的草稿，並將原文件標註狀態為編輯中</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">欲建立草稿的文件 REFDOCID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">草稿的文件內容</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 建立草稿成功時回傳包含主鍵及 <code>SERNO</code> 的關聯式陣列</p>
<h2>18.10 CopyToTable</h2>
<pre><code class="language-php">public function CopyToTable($ID, $Table, $TablePK, $Field_Array = array())
</code></pre>
<p>複製文件資料到指定資料表</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">欲複製的文件 REFDOCID</td>
</tr>
<tr>
<td align="left"><code>$Table</code></td>
<td align="left"><code>string</code></td>
<td align="left">複製到的資料表名稱</td>
</tr>
<tr>
<td align="left"><code>$TablePK</code></td>
<td align="left"><code>string</code></td>
<td align="left">複製到的資料表的主鍵名稱</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">複製的欄位</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 複製成功時回傳主鍵的關聯式陣列</p>
<h2>18.11 SelectTYP</h2>
<pre><code class="language-php">public function SelectTYP($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆 REFDOCTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">REFDOCTYPID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>18.12 CreateTYP</h2>
<pre><code class="language-php">public function CreateTYP($R_Data)
</code></pre>
<p>新增資料 REFDOCTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">REFDOCTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>18.13 UpdateTYP</h2>
<pre><code class="language-php">public function UpdateTYP($ID, $R_Data)
</code></pre>
<p>更新資料 REFDOCTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">REFDOCTYPID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">REFDOCTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>18.14 DeleteTYP</h2>
<pre><code class="language-php">public function DeleteTYP($ID)
</code></pre>
<p>刪除資料 REFDOCTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">REFDOCTYPID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>18.15 UpdateTYPIFOCNT(protected)</h2>
<pre><code class="language-php">protected function UpdateTYPIFOCNT($ID, $Count = 1)
</code></pre>
<p>更新資料計數</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">REFDOCTYPID</td>
</tr>
<tr>
<td align="left"><code>$Count</code></td>
<td align="left"><code>integer</code></td>
<td align="left">計數待相加的數字</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>int</code>|<code>bool</code></p>
<h2>18.16 GetInitStatusFlag(protected)</h2>
<pre><code class="language-php">protected function GetInitStatusFlag()
</code></pre>
<p>取得初始狀態旗標字串</p>
<p><strong>回傳</strong></p>
<p><code>string</code></p>
<h2>18.17 GetORIDOCField(protected)</h2>
<pre><code class="language-php">protected function GetORIDOCField() {
</code></pre>
<p>取得記錄原始文件ID的資料表欄位名稱，如 <code>ORIREFDOCID</code></p>
<p><strong>回傳</strong></p>
<p><code>string</code></p>
<h2>18.18 AppendMultilingualIndex</h2>
<pre><code class="language-php">public function AppendMultilingualIndex($ID, $Language, $ReferenceID = '', $ReferenceLanguage = '')
</code></pre>
<p>附加語系關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">欲附加語系關聯的文件 UID</td>
</tr>
<tr>
<td align="left"><code>$Language</code></td>
<td align="left"><code>string</code></td>
<td align="left">欲附加的語系代碼，如 <code>zh-TW</code></td>
</tr>
<tr>
<td align="left"><code>$ReferenceID</code></td>
<td align="left"><code>string</code></td>
<td align="left">(選擇性) 文件資料對應的其他語系的文件 UID</td>
</tr>
<tr>
<td align="left"><code>$ReferenceLanguage</code></td>
<td align="left"><code>string</code></td>
<td align="left">(選擇性) 其他語系文件的語系代碼，如 <code>en-US</code></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>18.19 RemoveMultilingualIndex</h2>
<pre><code class="language-php">public function RemoveMultilingualIndex($ID, $Language)
</code></pre>
<p>移除語系關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">欲移除語系關聯的文件 UID</td>
</tr>
<tr>
<td align="left"><code>$Language</code></td>
<td align="left"><code>string</code></td>
<td align="left">欲移除的語系代碼，如 <code>zh-TW</code></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h1>19. DBSMOD_DOC_enUS extends DBSMOD_DOC</h1>
<h2>19.1 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)，並寫入 $this-&gt;TYPTable, $this-&gt;TYPTablePK</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h1>20. DBSMOD_DSCDOC extends DBSMOD_DOC</h1>
<h2>20.1 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>20.2 Create</h2>
<pre><code class="language-php">public function Create($R_Data)
</code></pre>
<p>新增資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">DSSCDOC資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>20.3 SelectTopic</h2>
<pre><code class="language-php">public function SelectTopic($ID, $Field_Array = array())
</code></pre>
<p>取得討論主題</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">DSCTopicID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>20.4 CreateTopic</h2>
<pre><code class="language-php">public function CreateTopic($R_Data)
</code></pre>
<p>建立討論主題資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">討論主題的資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>20.5 UpdateTopic</h2>
<pre><code class="language-php">public function UpdateTopic($ID, $R_Data)
</code></pre>
<p>更新討論主題資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">DSCTopicID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">討論主題的資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>20.6 DeleteTopic</h2>
<pre><code class="language-php">public function DeleteTopic($ID)
</code></pre>
<p>刪除討論主題資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">DSCTopicID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>20.7 SelectReply</h2>
<pre><code class="language-php">public function SelectReply($ID, $Field_Array = array())
</code></pre>
<p>取得討論回覆</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">DSCReplyID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>20.8 CreateReply</h2>
<pre><code class="language-php">public function CreateReply($R_Data)
</code></pre>
<p>建立討論回覆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">討論回覆的資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>20.9 UpdateReply</h2>
<pre><code class="language-php">public function UpdateReply($ID, $R_Data)
</code></pre>
<p>更新討論回覆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">DSCReplyID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">討論回覆的資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>20.10 DeleteReply</h2>
<pre><code class="language-php">public function DeleteReply($ID)
</code></pre>
<p>刪除討論回覆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">DSCTopicID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>20.11 AppendCourse</h2>
<pre><code class="language-php">public function AppendCourse($DSCDOCID, $CourseID)
</code></pre>
<p>新增課程與討論文件、討論主題關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DSCDOCID</code></td>
<td align="left"><code>string</code></td>
<td align="left">DSCDOCID</td>
</tr>
<tr>
<td align="left"><code>$CourseID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CourseID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>20.12 RemoveCourse</h2>
<pre><code class="language-php">public function RemoveCourse($DSCDOCID, $CourseID)
</code></pre>
<p>移除課程與討論文件、討論主題關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DSCDOCID</code></td>
<td align="left"><code>string</code></td>
<td align="left">DSCDOCID</td>
</tr>
<tr>
<td align="left"><code>$CourseID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CourseID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h1>21. DBSMOD_File extends DBSMOD</h1>
<h2>21.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$UserPermissionFields</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> 權限相關資料表欄位與權限常數的映射</td>
</tr>
</tbody>
</table>
<h2>21.2 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>21.3 Select</h2>
<pre><code class="language-php">public function Select($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">FileID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>21.4 Create</h2>
<pre><code class="language-php">public function Create($R_Data)
</code></pre>
<p>新增資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">File資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>21.5 Update</h2>
<pre><code class="language-php">public function Update($ID, $R_Data)
</code></pre>
<p>更新資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">FileID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">File資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>21.6 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">FileID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>21.7 SetPermission(protected)</h2>
<pre><code class="language-php">protected function SetPermission($Fields, $ID, $AgentID, $Scope = FILE_PERMISSION_ALL)
</code></pre>
<p>設定用戶或用戶群組對檔案的權限<br />
<code>Scope</code> 參數建議使用 <code>FILE_PERMISSION_*</code> 常數:<br />
FILE_PERMISSION_DELETE =&gt; 1<br />
FILE_PERMISSION_WRITE =&gt; 2<br />
FILE_PERMISSION_READ =&gt; 4<br />
FILE_PERMISSION_WRITE_DELETE =&gt; 3<br />
FILE_PERMISSION_DELETE_WRITE =&gt; 3<br />
FILE_PERMISSION_READ_DELETE =&gt; 5<br />
FILE_PERMISSION_DELETE_READ =&gt; 5<br />
FILE_PERMISSION_READ_WRITE =&gt; 6<br />
FILE_PERMISSION_WRITE_READ =&gt; 6<br />
FILE_PERMISSION_ALL =&gt; 7</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Fields</code></td>
<td align="left"><code>array</code></td>
<td align="left">File 資料表權限相關欄位名稱與資料的映射</td>
</tr>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">FileID</td>
</tr>
<tr>
<td align="left"><code>$AgentID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserID 或 UserGroupID</td>
</tr>
<tr>
<td align="left"><code>$Scope</code></td>
<td align="left"><code>int</code></td>
<td align="left">權限範圍，建議使用 FILE_PERMISSION_* 常數</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> <code>true</code>: 成功，<code>false</code>: 失敗</p>
<h2>21.8 SetUserPermission</h2>
<pre><code class="language-php">public function SetUserPermission($ID, $UserID, $Scope = FILE_PERMISSION_ALL)
</code></pre>
<p>設定用戶對檔案的權限<br />
<code>Scope</code> 參數建議使用 <code>FILE_PERMISSION_*</code> 常數:<br />
FILE_PERMISSION_DELETE =&gt; 1<br />
FILE_PERMISSION_WRITE =&gt; 2<br />
FILE_PERMISSION_READ =&gt; 4<br />
FILE_PERMISSION_WRITE_DELETE =&gt; 3<br />
FILE_PERMISSION_DELETE_WRITE =&gt; 3<br />
FILE_PERMISSION_READ_DELETE =&gt; 5<br />
FILE_PERMISSION_DELETE_READ =&gt; 5<br />
FILE_PERMISSION_READ_WRITE =&gt; 6<br />
FILE_PERMISSION_WRITE_READ =&gt; 6<br />
FILE_PERMISSION_ALL =&gt; 7</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">FileID</td>
</tr>
<tr>
<td align="left"><code>$UserID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserID</td>
</tr>
<tr>
<td align="left"><code>$Scope</code></td>
<td align="left"><code>int</code></td>
<td align="left">權限範圍，建議使用 FILE_PERMISSION_* 常數</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> <code>true</code>: 成功，<code>false</code>: 失敗</p>
<h2>21.9 SetGroupPermission</h2>
<pre><code class="language-php">public function SetGroupPermission($ID, $UserGRPID, $Scope = FILE_PERMISSION_ALL)
</code></pre>
<p>設定用戶群組對檔案的權限<br />
<code>Scope</code> 參數建議使用 <code>FILE_PERMISSION_*</code> 常數:<br />
FILE_PERMISSION_DELETE =&gt; 1<br />
FILE_PERMISSION_WRITE =&gt; 2<br />
FILE_PERMISSION_READ =&gt; 4<br />
FILE_PERMISSION_WRITE_DELETE =&gt; 3<br />
FILE_PERMISSION_DELETE_WRITE =&gt; 3<br />
FILE_PERMISSION_READ_DELETE =&gt; 5<br />
FILE_PERMISSION_DELETE_READ =&gt; 5<br />
FILE_PERMISSION_READ_WRITE =&gt; 6<br />
FILE_PERMISSION_WRITE_READ =&gt; 6<br />
FILE_PERMISSION_ALL =&gt; 7</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">FileID</td>
</tr>
<tr>
<td align="left"><code>$UserGRPID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserGRPID</td>
</tr>
<tr>
<td align="left"><code>$Scope</code></td>
<td align="left"><code>int</code></td>
<td align="left">權限範圍，建議使用 FILE_PERMISSION_* 常數</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> <code>true</code>: 成功，<code>false</code>: 失敗</p>
<h2>21.10 AlterSinglePermission(protected)</h2>
<pre><code class="language-php">protected function AlterSinglePermission($Field, $ID, $AgentID, $Allow)
</code></pre>
<p>設定用戶或用戶群組對檔案的單一權限</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Field</code></td>
<td align="left"><code>string</code></td>
<td align="left">權限欄位名稱</td>
</tr>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">FileID</td>
</tr>
<tr>
<td align="left"><code>$AgentID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserID 或 UserGroupID</td>
</tr>
<tr>
<td align="left"><code>$Allow</code></td>
<td align="left"><code>bool</code></td>
<td align="left">true: 允許，false: 禁止</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> <code>true</code>: 成功，<code>false</code>: 失敗</p>
<h2>21.11 AlterUserReadPermission</h2>
<pre><code class="language-php">public function AlterUserReadPermission($ID, $UserID, $Allow)
</code></pre>
<p>設定用戶對檔案的讀取權限，不影響其他權限</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">FileID</td>
</tr>
<tr>
<td align="left"><code>$UserID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserID</td>
</tr>
<tr>
<td align="left"><code>$Allow</code></td>
<td align="left"><code>bool</code></td>
<td align="left">true: 允許讀取，false: 禁止讀取</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> <code>true</code>: 成功，<code>false</code>: 失敗</p>
<h2>21.12 AlterGroupReadPermission</h2>
<pre><code class="language-php">public function AlterGroupReadPermission($ID, $UserGRPID, $Allow)
</code></pre>
<p>設定用戶群組對檔案的讀取權限，不影響其他權限</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">FileID</td>
</tr>
<tr>
<td align="left"><code>$UserGRPID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserGRPID</td>
</tr>
<tr>
<td align="left"><code>$Allow</code></td>
<td align="left"><code>bool</code></td>
<td align="left">true: 允許讀取，false: 禁止讀取</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> <code>true</code>: 成功，<code>false</code>: 失敗</p>
<h2>21.13 AlterUserWritePermission</h2>
<pre><code class="language-php">public function AlterUserWritePermission($ID, $UserID, $Allow)
</code></pre>
<p>設定用戶對檔案的寫入權限，不影響其他權限</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">FileID</td>
</tr>
<tr>
<td align="left"><code>$UserID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserID</td>
</tr>
<tr>
<td align="left"><code>$Allow</code></td>
<td align="left"><code>bool</code></td>
<td align="left">true: 允許寫入，false: 禁止寫入</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> <code>true</code>: 成功，<code>false</code>: 失敗</p>
<h2>21.14 AlterGroupWritePermission</h2>
<pre><code class="language-php">public function AlterGroupWritePermission($ID, $UserGRPID, $Allow)
</code></pre>
<p>設定用戶對檔案的寫入權限，不影響其他權限</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">FileID</td>
</tr>
<tr>
<td align="left"><code>$UserGRPID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserGRPID</td>
</tr>
<tr>
<td align="left"><code>$Allow</code></td>
<td align="left"><code>bool</code></td>
<td align="left">true: 允許寫入，false: 禁止寫入</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> <code>true</code>: 成功，<code>false</code>: 失敗</p>
<h2>21.15 AlterUserDeletePermission</h2>
<pre><code class="language-php">public function AlterUserDeletePermission($ID, $UserID, $Allow)
</code></pre>
<p>設定用戶對檔案的刪除權限，不影響其他權限</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">FileID</td>
</tr>
<tr>
<td align="left"><code>$UserID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserID</td>
</tr>
<tr>
<td align="left"><code>$Allow</code></td>
<td align="left"><code>bool</code></td>
<td align="left">true: 允許刪除，false: 禁止刪除</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> <code>true</code>: 成功，<code>false</code>: 失敗</p>
<h2>21.16 AlterGroupDeletePermission</h2>
<pre><code class="language-php">public function AlterGroupDeletePermission($ID, $UserGRPID, $Allow)
</code></pre>
<p>設定用戶對檔案的刪除權限，不影響其他權限</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">FileID</td>
</tr>
<tr>
<td align="left"><code>$UserGRPID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserGRPID</td>
</tr>
<tr>
<td align="left"><code>$Allow</code></td>
<td align="left"><code>bool</code></td>
<td align="left">true: 允許刪除，false: 禁止刪除</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> <code>true</code>: 成功，<code>false</code>: 失敗</p>
<h1>22. DBSMOD_Goods extends DBSMOD</h1>
<h2>22.1 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>22.2 Select</h2>
<pre><code class="language-php">public function Select($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆物料資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">GoodsID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>22.3 Create</h2>
<pre><code class="language-php">public function Create($R_Data)
</code></pre>
<p>新增物料資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">Goods 資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>22.4 Update</h2>
<pre><code class="language-php">public function Update($ID, $R_Data)
</code></pre>
<p>更新物料資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">GoodsID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">Goods 資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>22.5 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除物料、物料庫存等資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">GoodsID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>22.6 CreateStock</h2>
<pre><code class="language-php">public function CreateStock($R_Data)
</code></pre>
<p>新增物料資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">GoodsStock 資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>22.7 SelectStockByGoodsID</h2>
<pre><code class="language-php">public function SelectStockByGoodsID($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆物料庫存資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">GoodsID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的 GoodsStock 資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>22.8 UpdateStockByGoodsID</h2>
<pre><code class="language-php">public function UpdateStockByGoodsID($ID, $R_Data)
</code></pre>
<p>更新物料庫存資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">GoodsID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">GoodsStock 資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>22.9 UpdateStockNewQTY</h2>
<pre><code class="language-php">public function UpdateStockNewQTY($GoodsID, $QTY, $Flag = STOCK_OVERWRITE)
</code></pre>
<p>修改庫存的新品數量 (以 GoodsID 為索引)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$GoodsID</code></td>
<td align="left"><code>string</code></td>
<td align="left">GoodsID</td>
</tr>
<tr>
<td align="left"><code>$QTY</code></td>
<td align="left"><code>int</code></td>
<td align="left">修改數量</td>
</tr>
<tr>
<td align="left"><code>$Flag</code></td>
<td align="left"><code>int</code></td>
<td align="left"><code>STOCK_OVERWRITE</code>: 以 $QTY 覆寫庫存新品數量；<code>STOCK_PLUS</code>: 既有的庫存數量與 $QTY 相加</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 修改成功回傳 <code>true</code>，反之回傳 <code>false</code></p>
<h2>22.10 UpdateStockNewQTYByProductID</h2>
<pre><code class="language-php">public function UpdateStockNewQTYByProductID($PDTIFOID, $QTY, $Flag = STOCK_OVERWRITE)
</code></pre>
<p>修改庫存的新品數量 (以 PDTIFOID 為索引)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$PDTIFOID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PDTIFOID</td>
</tr>
<tr>
<td align="left"><code>$QTY</code></td>
<td align="left"><code>int</code></td>
<td align="left">修改數量</td>
</tr>
<tr>
<td align="left"><code>$Flag</code></td>
<td align="left"><code>int</code></td>
<td align="left"><code>STOCK_OVERWRITE</code>: 以 $QTY 覆寫庫存新品數量；<code>STOCK_PLUS</code>: 既有的庫存數量與 $QTY 相加</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 修改成功回傳 <code>true</code>，反之回傳 <code>false</code></p>
<h2>22.11 SelectTYP</h2>
<pre><code class="language-php">public function SelectTYP($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆 GoodsTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">GoodsTYPID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>22.12 CreateTYP</h2>
<pre><code class="language-php">public function CreateTYP($R_Data)
</code></pre>
<p>新增資料 GoodsTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">GoodsTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>22.13 UpdateTYP</h2>
<pre><code class="language-php">public function UpdateTYP($ID, $R_Data)
</code></pre>
<p>更新資料 GoodsTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">GoodsTYPID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">GoodsTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>22.14 DeleteTYP</h2>
<pre><code class="language-php">public function DeleteTYP($ID)
</code></pre>
<p>刪除資料 GoodsTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">GoodsTYPID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>22.15 UpdateTYPIFOCNT(protected)</h2>
<pre><code class="language-php">protected function UpdateTYPIFOCNT($ID, $Count = 1)
</code></pre>
<p>更新物料類別資料計數</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">GoodsTYPID</td>
</tr>
<tr>
<td align="left"><code>$Count</code></td>
<td align="left"><code>integer</code></td>
<td align="left">計數待相加的數字</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>int</code>|<code>false</code></p>
<h2>22.16 AppendRLVProduct</h2>
<pre><code class="language-php">public function AppendRLVProduct($GoodsID, $PDTIFOID, $OptionSet)
</code></pre>
<p>新增產品與物料的關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$GoodsID</code></td>
<td align="left"><code>string</code></td>
<td align="left">GoodsID</td>
</tr>
<tr>
<td align="left"><code>$PDTIFOID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PDTIFOID</td>
</tr>
<tr>
<td align="left"><code>$OptionSet</code></td>
<td align="left"><code>string</code></td>
<td align="left">規格關聯陣列的JSON字串，寫入 <code>RT_PDTIFO_Goods_Tb.AvailableOptionSet</code> 欄位</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>22.17 RemoveRLVProduct</h2>
<pre><code class="language-php">public function RemoveRLVProduct($GoodsID, $PDTIFOID)
</code></pre>
<p>移除產品與物料的關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$GoodsID</code></td>
<td align="left"><code>string</code></td>
<td align="left">GoodsID</td>
</tr>
<tr>
<td align="left"><code>$PDTIFOID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PDTIFOID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h1>23. DBSMOD_INV extends DBSMOD</h1>
<h2>23.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$StatusFlagKeys</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>INVIFO.StatusFlag</code> 訂單每個旗標所象徵的狀態</td>
</tr>
<tr>
<td align="left"><code>$RequiredStatus</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>INVIFO.StatusFlag</code> 初始即不為空值的旗標</td>
</tr>
<tr>
<td align="left"><code>$AutoCompleteStatus</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>INVIFO.StatusFlag</code> 初始即為完成的旗標</td>
</tr>
<tr>
<td align="left"><code>$DateTimeFieldMapping</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> <code>INVIFO.StatusFlag</code> 旗標對應的時間</td>
</tr>
<tr>
<td align="left"><code>$INVEventFlagKeys</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>INVIFO.EventFlag</code> 每個旗標所象徵的狀態</td>
</tr>
<tr>
<td align="left"><code>$TradeSettings</code></td>
<td align="left"><code>ConfigTrade</code></td>
<td align="left">交易稅率、價格小數位數等的設定物件</td>
</tr>
</tbody>
</table>
<h2>23.2 __construct</h2>
<pre><code class="language-php">public function __construct($DBSLink, $DBS, $TradeSettings = null)
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DBSLink</code></td>
<td align="left"><code>\PDO</code></td>
<td align="left">PDO 物件</td>
</tr>
<tr>
<td align="left"><code>$DBS</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料庫名稱</td>
</tr>
<tr>
<td align="left"><code>$TradeSettings</code></td>
<td align="left"><code>ConfigTrade</code></td>
<td align="left">交易稅率、價格小數位數等的設定物件</td>
</tr>
</tbody>
</table>
<h2>23.3 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>23.4 Select</h2>
<pre><code class="language-php">public function Select($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALINVID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>23.5 Create</h2>
<pre><code class="language-php">public function Create($R_Data, $ItemArray = array())
</code></pre>
<p>新增資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">INVIFO資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>23.6 Update</h2>
<pre><code class="language-php">public function Update($ID, $R_Data)
</code></pre>
<p>更新資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALINVID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">INVIFO資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>23.7 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALINVID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>23.8 UpdateItem</h2>
<pre><code class="language-php">public function UpdateItem($SALODRITMID, $R_Data)
</code></pre>
<p>更新訂購項目</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$SALODRITMID</code></td>
<td align="left"><code>string</code></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>23.9 CreateItem(protected)</h2>
<pre><code class="language-php">protected function CreateItem($R_Data)
</code></pre>
<p>建立訂購項目</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>23.10 GetInitStatusFlag(protected)</h2>
<pre><code class="language-php">protected function GetInitStatusFlag()
</code></pre>
<p>取得初始狀態旗標字串</p>
<p><strong>回傳</strong></p>
<p><code>string</code></p>
<h2>23.11 GetInvoiceForReceipt(protected)</h2>
<pre><code class="language-php">protected function GetInvoiceForReceipt($R_Data)
</code></pre>
<p>易發票開立</p>
<p><strong>回傳</strong></p>
<p><code>string</code></p>
<h1>24. DBSMOD_Link extends DBSMOD</h1>
<h2>24.1 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>24.2 Select</h2>
<pre><code class="language-php">public function Select($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">LinkIFOID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>24.3 Create</h2>
<pre><code class="language-php">public function Create($R_Data)
</code></pre>
<p>新增資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">LinkIFO資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>24.4 Update</h2>
<pre><code class="language-php">public function Update($ID, $R_Data)
</code></pre>
<p>更新資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">LinkIFOID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">LinkIFO資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>24.5 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">LinkIFOID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h1>25. DBSMOD_Link_enUS extends DBSMOD_Link</h1>
<h2>25.1 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h1>26. DBSMOD_Monitor extends DBSMOD</h1>
<h2>26.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$MonitorLogItemCacheValidDuration</code></td>
<td align="left"><code>int</code></td>
<td align="left">監測記錄快取的效期 (秒)</td>
</tr>
</tbody>
</table>
<h2>26.2 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>26.3 Select</h2>
<pre><code class="language-php">public function Select($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">MonitorIFOID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>26.4 Create</h2>
<pre><code class="language-php">public function Create($R_Data)
</code></pre>
<p>新增資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">MonitorIFO 資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>26.5 Update</h2>
<pre><code class="language-php">public function Update($ID, $R_Data)
</code></pre>
<p>更新資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">MonitorIFOID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">MonitorIFO 資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>26.6 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">MonitorIFOID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>26.7 SelectLog</h2>
<pre><code class="language-php">public function SelectLog($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">MonitorLogID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>26.8 CreateLog</h2>
<pre><code class="language-php">public function CreateLog($R_Data, $MonitorIFOID)
</code></pre>
<p>新增資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">MonitorLog 資料表欄位名稱與資料的映射</td>
</tr>
<tr>
<td align="left"><code>$MonitorIFOID</code></td>
<td align="left"><code>string</code></td>
<td align="left">MonitorIFOID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>26.9 UpdateLog</h2>
<pre><code class="language-php">public function UpdateLog($ID, $R_Data)
</code></pre>
<p>更新資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">MonitorLogID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">MonitorLog 資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>26.10 DeleteLog</h2>
<pre><code class="language-php">public function DeleteLog($ID)
</code></pre>
<p>刪除資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">MonitorLogID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>26.11 SelectITM</h2>
<pre><code class="language-php">public function SelectITM($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">MonitorITMID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>26.12 CreateITM</h2>
<pre><code class="language-php">public function CreateITM($R_Data)
</code></pre>
<p>新增資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">MonitorITM 資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>26.13 UpdateITM</h2>
<pre><code class="language-php">public function UpdateITM($ID, $R_Data)
</code></pre>
<p>更新資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">MonitorITMID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">MonitorITM 資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>26.14 DeleteITM</h2>
<pre><code class="language-php">public function DeleteITM($ID)
</code></pre>
<p>刪除資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">MonitorITMID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>26.15 SelectDEV</h2>
<pre><code class="language-php">public function SelectDEV($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">MonitorDEVID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>26.16 CreateDEV</h2>
<pre><code class="language-php">public function CreateDEV($R_Data)
</code></pre>
<p>新增資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">MonitorDEV 資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>26.17 UpdateDEV</h2>
<pre><code class="language-php">public function UpdateDEV($ID, $R_Data)
</code></pre>
<p>更新資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">MonitorDEVID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">MonitorDEV 資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>26.18 DeleteDEV</h2>
<pre><code class="language-php">public function DeleteDEV($ID)
</code></pre>
<p>刪除資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">MonitorDEVID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>26.19 SelectDEVTYP</h2>
<pre><code class="language-php">public function SelectDEVTYP($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">MonitorDEVTYPID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>26.20 CreateDEVTYP</h2>
<pre><code class="language-php">public function CreateDEVTYP($R_Data)
</code></pre>
<p>新增資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">MonitorDEVTYP 資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>26.21 UpdateDEVTYP</h2>
<pre><code class="language-php">public function UpdateDEVTYP($ID, $R_Data)
</code></pre>
<p>更新資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">MonitorDEVTYPID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">MonitorDEVTYP 資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>26.22 DeleteDEVTYP</h2>
<pre><code class="language-php">public function DeleteDEVTYP($ID)
</code></pre>
<p>刪除資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">MonitorDEVTYPID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>26.23 UpdateDEVTYPIFOCNT(protected)</h2>
<pre><code class="language-php">protected function UpdateDEVTYPIFOCNT($ID, $Count = 1)
</code></pre>
<p>更新資料計數</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">MonitorDEVTYPID</td>
</tr>
<tr>
<td align="left"><code>$Count</code></td>
<td align="left"><code>integer</code></td>
<td align="left">計數待相加的數字</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>int</code>|<code>bool</code></p>
<h2>26.24 CreateLogItem</h2>
<pre><code class="language-php">public function CreateLogItem($R_Data, $MonitorLogID)
</code></pre>
<p>新增監測紀錄</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">MonitorLog 資料表欄位名稱與資料的映射，必須包含 MonitorLogID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>26.25 ClearExpiredLogItemCache</h2>
<pre><code class="language-php">public function ClearExpiredLogItemCache($CacheTableName)
</code></pre>
<p>清理過期的監測紀錄快取</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$CacheTableName</code></td>
<td align="left"><code>string</code></td>
<td align="left">快取資料表名稱</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>true</code></p>
<h1>27. DBSMOD_OAuthToken extends DBSMOD</h1>
<h2>27.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ExpireTime</code></td>
<td align="left"><code>int</code></td>
<td align="left">令牌有效期 (秒)，預設為 3600 秒 (1 小時)</td>
</tr>
</tbody>
</table>
<h2>27.2 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>27.3 CreateToken</h2>
<pre><code class="language-php">public function CreateToken($UserID, $PrivateKeyUri, $ClientID = '', $Scopes = array())
</code></pre>
<p>產生令牌並儲存於 OAuthACSToken，回傳令牌物件</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$UserID</code></td>
<td align="left"><code>string</code></td>
<td align="left">使用者 ID</td>
</tr>
<tr>
<td align="left"><code>$PrivateKeyUri</code></td>
<td align="left"><code>string</code></td>
<td align="left">私鑰位置</td>
</tr>
<tr>
<td align="left"><code>$ClientID</code></td>
<td align="left"><code>string</code></td>
<td align="left">客戶端 ID</td>
</tr>
<tr>
<td align="left"><code>$Scopes</code></td>
<td align="left"><code>array</code></td>
<td align="left">權限範圍</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>JWTEntity</p>
<h2>27.4 CheckToken</h2>
<pre><code class="language-php">public function CheckToken($JWTString, $PublicKeyUri)
</code></pre>
<p>檢查令牌是否有效 (UserToken)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$JWTString</code></td>
<td align="left"><code>string</code></td>
<td align="left">待驗證的令牌</td>
</tr>
<tr>
<td align="left"><code>$PublicKeyUri</code></td>
<td align="left"><code>string</code></td>
<td align="left">公鑰位置</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>JWTEntity|<code>false</code> 回傳 ACSToken 物件，若失敗則回傳 <code>false</code></p>
<h2>27.5 DeleteToken</h2>
<pre><code class="language-php">public function DeleteToken($JWTString, $PublicKeyUri)
</code></pre>
<p>刪除指定令牌</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$JWTString</code></td>
<td align="left"><code>string</code></td>
<td align="left">待刪除的令牌</td>
</tr>
<tr>
<td align="left"><code>$PublicKeyUri</code></td>
<td align="left"><code>string</code></td>
<td align="left">公鑰位置</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>true</code></p>
<h2>27.6 GenerateID(protected)</h2>
<pre><code class="language-php">protected function GenerateID($Length = 40)
</code></pre>
<p>產生隨機 ID (16 進位)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Length</code></td>
<td align="left"><code>int</code></td>
<td align="left">ID 長度</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code></p>
<h2>27.7 IsRevoked(protected)</h2>
<pre><code class="language-php">protected function IsRevoked($JTI)
</code></pre>
<p>檢查令牌是否已被刪除</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$JTI</code></td>
<td align="left"><code>string</code></td>
<td align="left">令牌 ID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code>ean 回傳 <code>true</code> 表示已被刪除</p>
<h1>28. DBSMOD_PDT extends DBSMOD</h1>
<h2>28.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$TradeSettings</code></td>
<td align="left"><code>ConfigTrade</code></td>
<td align="left">控制自動建立物料資料的參數設定物件</td>
</tr>
</tbody>
</table>
<h2>28.2 __construct</h2>
<pre><code class="language-php">public function __construct($DBSLink, $DBS, $TradeSettings = null)
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DBSLink</code></td>
<td align="left"><code>\PDO</code></td>
<td align="left">PDO 物件</td>
</tr>
<tr>
<td align="left"><code>$DBS</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料庫名稱</td>
</tr>
<tr>
<td align="left"><code>$TradeSettings</code></td>
<td align="left"><code>ConfigTrade</code></td>
<td align="left">交易稅率、價格小數位數等的設定物件</td>
</tr>
</tbody>
</table>
<h2>28.3 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>28.4 Select</h2>
<pre><code class="language-php">public function Select($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆產品資料<br />
若引數 <code>$Field_Array</code> 包括 <code>PDTIFOTYPID</code> 則同時查詢相關聯的產品類別，並回傳所有產品類別的 <code>PDTIFOTYPID</code> 的數值陣列</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PDTIFOID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>28.5 Create</h2>
<pre><code class="language-php">public function Create($R_Data)
</code></pre>
<p>新增產品、產品庫存(庫存0)、產品類別關聯等資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">PDTIFO資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>28.6 Update</h2>
<pre><code class="language-php">public function Update($ID, $R_Data)
</code></pre>
<p>更新產品資料<br />
若引數 <code>$R_Data</code> 包含 <code>PDTIFOTYPID</code>，則更新產品類別關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PDTIFOID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">PDTIFO資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>28.7 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除產品、產品庫存、產品類別關聯等資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PDTIFOID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>28.8 AppendRLVTYP</h2>
<pre><code class="language-php">public function AppendRLVTYP($ID, $TYPID)
</code></pre>
<p>新增產品與產品類別的關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PDTIFOID</td>
</tr>
<tr>
<td align="left"><code>$TYPID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PDTIFOTYPID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>28.9 RemoveRLVTYP</h2>
<pre><code class="language-php">public function RemoveRLVTYP($ID, $TYPID)
</code></pre>
<p>移除產品與產品類別的關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PDTIFOID</td>
</tr>
<tr>
<td align="left"><code>$TYPID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PDTIFOTYPID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>28.10 SelectTYP</h2>
<pre><code class="language-php">public function SelectTYP($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆 PDTIFOTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PDTIFOTYPID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>28.11 CreateTYP</h2>
<pre><code class="language-php">public function CreateTYP($R_Data)
</code></pre>
<p>新增資料 PDTIFOTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">PDTIFOTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>28.12 UpdateTYP</h2>
<pre><code class="language-php">public function UpdateTYP($ID, $R_Data)
</code></pre>
<p>更新資料 PDTIFOTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PDTIFOTYPID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">PDTIFOTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>28.13 DeleteTYP</h2>
<pre><code class="language-php">public function DeleteTYP($ID)
</code></pre>
<p>刪除資料 PDTIFOTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PDTIFOTYPID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>28.14 UpdateTYPIFOCNT(protected)</h2>
<pre><code class="language-php">protected function UpdateTYPIFOCNT($ID, $Count = 1)
</code></pre>
<p>更新產品類別資料計數</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PDTIFOTYPID</td>
</tr>
<tr>
<td align="left"><code>$Count</code></td>
<td align="left"><code>integer</code></td>
<td align="left">計數待相加的數字</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>int</code>|<code>false</code></p>
<h2>28.15 AppendRLVCNR</h2>
<pre><code class="language-php">public function AppendRLVCNR($ID, $CNRID, $R_Data = array())
</code></pre>
<p>新增產品與專櫃的關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PDTIFOID</td>
</tr>
<tr>
<td align="left"><code>$CNRID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CNRIFOID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">新增到 'RT_CNRPDT` 的資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>28.16 RemoveRLVCNR</h2>
<pre><code class="language-php">public function RemoveRLVCNR($ID, $CNRID)
</code></pre>
<p>移除產品與專櫃的關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PDTIFOID</td>
</tr>
<tr>
<td align="left"><code>$CNRID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CNRIFOID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>28.17 SelectCNR</h2>
<pre><code class="language-php">public function SelectCNR($CNRID, $Field_Array = array())
</code></pre>
<p>查詢單筆專櫃資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$CNRID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CNRIFOID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>28.18 CreateCNR</h2>
<pre><code class="language-php">public function CreateCNR($R_Data)
</code></pre>
<p>新增資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">CNRIFO資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>28.19 UpdateCNR</h2>
<pre><code class="language-php">public function UpdateCNR($CNRID, $R_Data)
</code></pre>
<p>更新專櫃資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$CNRID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CNRIFOID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">CNRIFO資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>28.20 DeleteCNR</h2>
<pre><code class="language-php">public function DeleteCNR($CNRID)
</code></pre>
<p>刪除專櫃資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$CNRID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CNRIFOID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>28.21 SelectCNRTYP</h2>
<pre><code class="language-php">public function SelectCNRTYP($CNRID, $Field_Array = array())
</code></pre>
<p>查詢單筆 CNRIFOTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$CNRID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CNRIFOTYPID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>28.22 CreateCNRTYP</h2>
<pre><code class="language-php">public function CreateCNRTYP($R_Data)
</code></pre>
<p>新增資料 CNRIFOTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">CNRIFOTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>28.23 UpdateCNRTYP</h2>
<pre><code class="language-php">public function UpdateCNRTYP($CNRID, $R_Data)
</code></pre>
<p>更新資料 CNRIFOTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$CNRID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CNRIFOTYPID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">CNRIFOTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>28.24 DeleteCNRTYP</h2>
<pre><code class="language-php">public function DeleteCNRTYP($CNRID)
</code></pre>
<p>刪除資料 CNRIFOTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$CNRID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CNRIFOTYPID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>28.25 UpdateCNRTYPIFOCNT(protected)</h2>
<pre><code class="language-php">protected function UpdateCNRTYPIFOCNT($CNRID, $Count = 1)
</code></pre>
<p>更新 CNRIFOTYP 資料計數</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$CNRID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CNRIFOTYPID</td>
</tr>
<tr>
<td align="left"><code>$Count</code></td>
<td align="left"><code>integer</code></td>
<td align="left">計數待相加的數字</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>int</code>|<code>bool</code></p>
<h1>29. DBSMOD_PHSSAL extends DBSMOD</h1>
<h2>29.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$StatusFlagKeys</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>PHSSAL.StatusFlag</code> 訂單每個旗標所象徵的狀態</td>
</tr>
<tr>
<td align="left"><code>$RequiredStatus</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>PHSSAL.StatusFlag</code> 初始即不為空值的旗標</td>
</tr>
<tr>
<td align="left"><code>$AutoCompleteStatus</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>PHSSAL.StatusFlag</code> 初始即為完成的旗標</td>
</tr>
<tr>
<td align="left"><code>$TradeSettings</code></td>
<td align="left"><code>ConfigTrade</code></td>
<td align="left">交易稅率、價格小數位數等的設定物件</td>
</tr>
</tbody>
</table>
<h2>29.2 __construct</h2>
<pre><code class="language-php">public function __construct($DBSLink, $DBS, $TradeSettings = null)
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DBSLink</code></td>
<td align="left"><code>\PDO</code></td>
<td align="left">PDO 物件</td>
</tr>
<tr>
<td align="left"><code>$DBS</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料庫名稱</td>
</tr>
<tr>
<td align="left"><code>$TradeSettings</code></td>
<td align="left"><code>ConfigTrade</code></td>
<td align="left">交易稅率、價格小數位數等的設定物件</td>
</tr>
</tbody>
</table>
<h2>29.3 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>29.4 Select</h2>
<pre><code class="language-php">public function Select($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PHSSALID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>29.5 Create</h2>
<pre><code class="language-php">public function Create($R_Data, $ItemArray = array())
</code></pre>
<p>新增資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">PHSSAL資料表欄位名稱與資料的映射</td>
</tr>
<tr>
<td align="left"><code>$ItemArray</code></td>
<td align="left"><code>array</code></td>
<td align="left">訂購項目的數值陣列，每個元素為包含 <code>UnitPrice</code>、<code>QTY</code> 等鍵的關聯陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>29.6 Update</h2>
<pre><code class="language-php">public function Update($ID, $R_Data)
</code></pre>
<p>更新資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PHSSALID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">PHSSAL資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>29.7 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PHSSALID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>29.8 UpdateItem</h2>
<pre><code class="language-php">public function UpdateItem($PHSSALITMID, $R_Data)
</code></pre>
<p>更新訂購項目</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$PHSSALITMID</code></td>
<td align="left"><code>string</code></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>29.9 CreateItem(protected)</h2>
<pre><code class="language-php">protected function CreateItem($R_Data)
</code></pre>
<p>建立訂購項目</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>29.10 GetInitStatusFlag(protected)</h2>
<pre><code class="language-php">protected function GetInitStatusFlag()
</code></pre>
<p>取得初始狀態旗標字串</p>
<p><strong>回傳</strong></p>
<p><code>string</code></p>
<h1>30. DBSMOD_PMO extends DBSMOD</h1>
<h2>30.1 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>30.2 Select</h2>
<pre><code class="language-php">public function Select($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆促銷資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PMOID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>30.3 Create</h2>
<pre><code class="language-php">public function Create($R_Data)
</code></pre>
<p>新增促銷</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">PMO資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>30.4 Update</h2>
<pre><code class="language-php">public function Update($ID, $R_Data)
</code></pre>
<p>更新促銷</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PMOID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">PMO資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>30.5 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除促銷資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PMOID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>30.6 SelectTYP</h2>
<pre><code class="language-php">public function SelectTYP($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆 PMOTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PMOTYPID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>30.7 CreateTYP</h2>
<pre><code class="language-php">public function CreateTYP($R_Data)
</code></pre>
<p>新增資料 PMOTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">PMOTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>30.8 UpdateTYP</h2>
<pre><code class="language-php">public function UpdateTYP($ID, $R_Data)
</code></pre>
<p>更新資料 PMOTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PMOTYPID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">PMOTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>30.9 DeleteTYP</h2>
<pre><code class="language-php">public function DeleteTYP($ID)
</code></pre>
<p>刪除資料 PMOTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PMOTYPID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>30.10 SelectPMOPDTDCN</h2>
<pre><code class="language-php">public function SelectPMOPDTDCN($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆 促銷產品折扣</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PMOPDTDCNID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>30.11 CreatePMOPDTDCN</h2>
<pre><code class="language-php">public function CreatePMOPDTDCN($R_Data)
</code></pre>
<p>新增資料 促銷產品折扣</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">PMOPDTDCN資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>30.12 UpdatePMOPDTDCN</h2>
<pre><code class="language-php">public function UpdatePMOPDTDCN($PMOPDTDCNID, $R_Data)
</code></pre>
<p>更新 促銷產品折扣</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$PMOPDTDCNID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PMOPDTDCNID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">PMOPDTDCN資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>30.13 DeletePMOPDTDCN</h2>
<pre><code class="language-php">public function DeletePMOPDTDCN($PMOPDTDCNID)
</code></pre>
<p>刪除 促銷產品折扣</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$PMOPDTDCNID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PMOPDTDCNID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h1>31. DBSMOD_PMSGRP extends DBSMOD</h1>
<h2>31.2 Select</h2>
<pre><code class="language-php">public function Select($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆權限群組</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PMSGRPID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>31.3 Create</h2>
<pre><code class="language-php">public function Create($R_Data)
</code></pre>
<p>新增權限群組</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">PMSGRP 資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>31.4 Update</h2>
<pre><code class="language-php">public function Update($ID, $R_Data)
</code></pre>
<p>更新權限群組</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PMSGRPID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">PMSGRP 資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>31.5 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除權限群組</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PMSGRPID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>31.6 SelectPMSScope</h2>
<pre><code class="language-php">public function SelectPMSScope($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆權限範圍</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PMSGRPID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>31.7 CreatePMSScope</h2>
<pre><code class="language-php">public function CreatePMSScope($R_Data)
</code></pre>
<p>新增權限範圍</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">PMSScope 資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>31.8 UpdatePMSScope</h2>
<pre><code class="language-php">public function UpdatePMSScope($ID, $R_Data)
</code></pre>
<p>更新權限範圍</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PMSScopeID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">PMSScope 資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>31.9 DeletePMSScope</h2>
<pre><code class="language-php">public function DeletePMSScope($ID)
</code></pre>
<p>刪除權限範圍</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PMSScopeID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>31.10 AppendPMSScope</h2>
<pre><code class="language-php">public function AppendPMSScope($PMSGRPID, $PMSScopeID)
</code></pre>
<p>新增權限群組與權限範圍關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$PMSGRPID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PMSGRPID</td>
</tr>
<tr>
<td align="left"><code>$PMSScopeID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PMSScopeID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>31.11 RemovePMSScope</h2>
<pre><code class="language-php">public function RemovePMSScope($PMSGRPID, $PMSScopeID)
</code></pre>
<p>移除權限群組與權限範圍關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$PMSGRPID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PMSGRPID</td>
</tr>
<tr>
<td align="left"><code>$PMSScopeID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PMSScopeID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>31.12 AppendPMSScopeByDCP</h2>
<pre><code class="language-php">public function AppendPMSScopeByDCP($PMSGRPID, $ScopeDCP)
</code></pre>
<p>新增權限群組與權限範圍關聯，以權限範圍的描述為索引</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$PMSGRPID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PMSGRPID</td>
</tr>
<tr>
<td align="left"><code>$ScopeDCP</code></td>
<td align="left"><code>string</code></td>
<td align="left">權限範圍描述 (PMSScope.DCP)</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>31.13 RemovePMSScopeByDCP</h2>
<pre><code class="language-php">public function RemovePMSScopeByDCP($PMSGRPID, $ScopeDCP)
</code></pre>
<p>移除權限群組與權限範圍關聯，以權限範圍的描述為索引</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$PMSGRPID</code></td>
<td align="left"><code>string</code></td>
<td align="left">PMSGRPID</td>
</tr>
<tr>
<td align="left"><code>$ScopeDCP</code></td>
<td align="left"><code>string</code></td>
<td align="left">權限範圍描述 (PMSScope.DCP)</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>31.14 CheckUser</h2>
<pre><code class="language-php">public function CheckUser($UserID, $Scope)
</code></pre>
<p>檢查使用者對指定權限範圍是否有權限</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$UserID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserID</td>
</tr>
<tr>
<td align="left"><code>$Scope</code></td>
<td align="left"><code>string</code></td>
<td align="left">權限範圍的定義 (PMSScope.Scope)</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h1>32. DBSMOD_RSCDOC extends DBSMOD_DOC</h1>
<h2>32.1 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>32.2 AppendCourseTOCItem</h2>
<pre><code class="language-php">public function AppendCourseTOCItem($RSCDOCID, $CourseTOCITMID)
</code></pre>
<p>新增資源文件與課程目錄項目關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$RSCDOCID</code></td>
<td align="left"><code>string</code></td>
<td align="left">RSCDOCID</td>
</tr>
<tr>
<td align="left"><code>$CourseTOCITMID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CourseTOCITMID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>32.3 RemoveCourseTOCItem</h2>
<pre><code class="language-php">public function RemoveCourseTOCItem($RSCDOCID, $CourseTOCITMID)
</code></pre>
<p>移除資源文件與課程目錄項目關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$RSCDOCID</code></td>
<td align="left"><code>string</code></td>
<td align="left">RSCDOCID</td>
</tr>
<tr>
<td align="left"><code>$CourseTOCITMID</code></td>
<td align="left"><code>string</code></td>
<td align="left">CourseTOCITMID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>32.4 AppendTextbookTOCItem</h2>
<pre><code class="language-php">public function AppendTextbookTOCItem($RSCDOCID, $TextbookTOCITMID)
</code></pre>
<p>新增資源文件與課程目錄項目關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$RSCDOCID</code></td>
<td align="left"><code>string</code></td>
<td align="left">RSCDOCID</td>
</tr>
<tr>
<td align="left"><code>$TextbookTOCITMID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TextbookTOCITMID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>32.5 RemoveTextbookTOCItem</h2>
<pre><code class="language-php">public function RemoveTextbookTOCItem($RSCDOCID, $TextbookTOCITMID)
</code></pre>
<p>移除資源文件與課程目錄項目關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$RSCDOCID</code></td>
<td align="left"><code>string</code></td>
<td align="left">RSCDOCID</td>
</tr>
<tr>
<td align="left"><code>$TextbookTOCITMID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TextbookTOCITMID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h1>33. DBSMOD_SALODR extends DBSMOD</h1>
<h2>33.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$StatusFlagKeys</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>SALODR.StatusFlag</code> 訂單每個旗標所象徵的狀態</td>
</tr>
<tr>
<td align="left"><code>$RequiredStatus</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>SALODR.StatusFlag</code> 初始即不為空值的旗標</td>
</tr>
<tr>
<td align="left"><code>$AutoCompleteStatus</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>SALODR.StatusFlag</code> 初始即為完成的旗標</td>
</tr>
<tr>
<td align="left"><code>$DateTimeFieldMapping</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> <code>SALODR.StatusFlag</code> 旗標對應的時間</td>
</tr>
<tr>
<td align="left"><code>$TradeSettings</code></td>
<td align="left"><code>ConfigTrade</code></td>
<td align="left">交易稅率、價格小數位數等的交易參數設定物件</td>
</tr>
</tbody>
</table>
<h2>33.2 __construct</h2>
<pre><code class="language-php">public function __construct($DBSLink, $DBS, $TradeSettings = null)
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DBSLink</code></td>
<td align="left"><code>\PDO</code></td>
<td align="left">PDO 物件</td>
</tr>
<tr>
<td align="left"><code>$DBS</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料庫名稱</td>
</tr>
<tr>
<td align="left"><code>$TradeSettings</code></td>
<td align="left"><code>ConfigTrade</code></td>
<td align="left">交易稅率、價格小數位數等的設定物件</td>
</tr>
</tbody>
</table>
<h2>33.3 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>33.4 Select</h2>
<pre><code class="language-php">public function Select($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>33.5 Create</h2>
<pre><code class="language-php">public function Create($R_Data, $ItemArray = [])
</code></pre>
<p>新增資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">SALODR資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>33.6 Update</h2>
<pre><code class="language-php">public function Update($ID, $R_Data)
</code></pre>
<p>更新資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">SALODR資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>33.7 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>33.8 SelectItems</h2>
<pre><code class="language-php">public function SelectItems($ID, $Field_Array = ['SALODRITMID'])
</code></pre>
<p>SelectItems</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>33.9 UpdateItem</h2>
<pre><code class="language-php">public function UpdateItem($ID, $SALODRITMID, $R_Data, $ReCalculate = true)
</code></pre>
<p>更新訂購項目，但若訂單符合以下任一狀態，則不執行: 待出貨、已出貨、待退貨、已退貨、待退款、已退款、待結案、已結案<br />
若要刪除訂購項目，請將 <code>$R_Data['QTY]</code> 設為 <code>0</code>。</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
<tr>
<td align="left"><code>$SALODRITMID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRITMID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">訂購項目的資料</td>
</tr>
<tr>
<td align="left"><code>$ReCalculate</code></td>
<td align="left"><code>bool</code></td>
<td align="left">是否重新計算訂單資料內的總價</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>33.10 CreateItem</h2>
<pre><code class="language-php">public function CreateItem($ID, $R_Data)
</code></pre>
<p>建立訂購項目</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">訂購項目的資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>33.11 ProcessAmount(protected)</h2>
<pre><code class="language-php">protected function ProcessAmount($ItemArray, $DELPrice = 0)
</code></pre>
<p>加總訂單項目的總價，得到訂單的 <code>TotalPrice</code>、<code>SALPrice</code>、<code>SALTax</code> 等資料</p>
<pre><code class="language-php">$ItemArray = [  
   [ 'UnitPrice' =&gt; 100, 'QTY' =&gt; 2],  
   [ 'UnitPrice' =&gt; 80, 'QTY' =&gt; 3 ]  
];  
$Mod = new DBSMOD_SALODR($Link, $DB_TABLE);  
$Sum = $Mod-&gt;ProcessAmount($ItemArray, 100); //第二個參數為訂單的 `DELPrice`  
echo $Sum['TotalPrice']; //540  
echo $Sum['SALPrice']; //418  
echo $Sum['SALTax']; //22  
</code></pre>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ItemArray</code></td>
<td align="left"><code>array</code></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><code>$DELPrice</code></td>
<td align="left"><code>int</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<h2>33.12 GetInitStatusFlag(protected)</h2>
<pre><code class="language-php">protected function GetInitStatusFlag()
</code></pre>
<p>取得初始狀態旗標字串</p>
<p><strong>回傳</strong></p>
<p><code>string</code></p>
<h2>33.13 FireStatusEvent(protected)</h2>
<pre><code class="language-php">protected function FireStatusEvent($ID, $NewStatusFlag, $ORIStatusFlag, $SALODR_Data = array())
</code></pre>
<p>觸發訂單狀態變更的事件</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
<tr>
<td align="left"><code>$NewStatusFlag</code></td>
<td align="left"><code>string</code></td>
<td align="left">新狀態旗標字串</td>
</tr>
<tr>
<td align="left"><code>$ORIStatusFlag</code></td>
<td align="left"><code>string</code></td>
<td align="left">原狀態旗標字串</td>
</tr>
<tr>
<td align="left"><code>$SALODR_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">SALODR資料</td>
</tr>
</tbody>
</table>
<h2>33.14 SendStatusNotice(protected)</h2>
<pre><code class="language-php">protected function SendStatusNotice($ID, $EventName, $SALODR_Data = array())
</code></pre>
<p>發送狀態變更通知</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
<tr>
<td align="left"><code>$EventName</code></td>
<td align="left"><code>string</code></td>
<td align="left">事件名稱</td>
</tr>
<tr>
<td align="left"><code>$SALODR_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">SALODR 資料</td>
</tr>
</tbody>
</table>
<h2>33.15 CreateReturnFromSALODR</h2>
<pre><code class="language-php">public function CreateReturnFromSALODR($ID, $ItemArray = array())
</code></pre>
<p>從 SALODR 複製資料以建立新的一筆 SALReturnODR<br />
(只支援一筆訂單一筆退貨)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
<tr>
<td align="left"><code>$ItemArray</code></td>
<td align="left"><code>array</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<h2>33.16 CreatePHSSALFromSALODR(protected)</h2>
<pre><code class="language-php">protected function CreatePHSSALFromSALODR($ID, $PHSSALTYPID = PHSSALTYPID_SALES)
</code></pre>
<p>從 SALODR|SALReturnODR 複製資料以建立新的一筆 PHSSAL</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
<tr>
<td align="left"><code>$PHSSALTYPID</code></td>
<td align="left"><code>string</code></td>
<td align="left">銷貨單類別 ID，可能的值為正常銷貨 <code>PHSSALTYPID_SALES</code> 及銷貨退回 <code>PHSSALTYPID_SALES_RETURN</code></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 回傳包含新建立銷貨單的 PHSSALID 及 SERNO 的關聯陣列</p>
<h2>33.17 CreateINVFromSALODR(protected)</h2>
<pre><code class="language-php">protected function CreateINVFromSALODR($ID)
</code></pre>
<p>從 SALODR 複製資料以建立新的一筆 INVIFO</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 回傳包含新建立發票的 INVIFOID 及 SERNO 的關聯陣列</p>
<h2>33.18 OnWaitingDeal(protected)</h2>
<pre><code class="language-php">protected function OnWaitingDeal($ID, $SALODR_Data = array())
</code></pre>
<p>訂單狀態事件-等待交易成立：發送訂單待審核通知</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
<tr>
<td align="left"><code>$SALODR_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">SALODR資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>33.19 OnDeal(protected)</h2>
<pre><code class="language-php">protected function OnDeal($ID, $SALODR_Data = array())
</code></pre>
<p>訂單狀態事件-交易成立：新建關聯資料表</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
<tr>
<td align="left"><code>$SALODR_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">SALODR資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>33.20 OnWaitingPayment(protected)</h2>
<pre><code class="language-php">protected function OnWaitingPayment($ID, $SALODR_Data = array())
</code></pre>
<p>訂單狀態事件-待付款：發送待付款通知</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
<tr>
<td align="left"><code>$SALODR_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">SALODR資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>33.21 OnPayment(protected)</h2>
<pre><code class="language-php">protected function OnPayment($ID, $SALODR_Data = array())
</code></pre>
<p>訂單狀態事件-完成付款：發送已付款通知</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
<tr>
<td align="left"><code>$SALODR_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">SALODR資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>33.22 OnWaitingDelivery(protected)</h2>
<pre><code class="language-php">protected function OnWaitingDelivery($ID, $SALODR_Data = array())
</code></pre>
<p>訂單狀態事件-完成出貨：發送已出貨通知/扣除庫存/新建出貨單/更新關聯表</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
<tr>
<td align="left"><code>$SALODR_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">SALODR資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>33.23 OnDelivery(protected)</h2>
<pre><code class="language-php">protected function OnDelivery($ID, $SALODR_Data = array())
</code></pre>
<p>訂單狀態事件-完成出貨：新建銷貨單/新建發票/發送已出貨通知/更新關聯表</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
<tr>
<td align="left"><code>$SALODR_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">SALODR資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>33.24 OnWaitingReturn(protected)</h2>
<pre><code class="language-php">protected function OnWaitingReturn($ID, $SALODR_Data = array())
</code></pre>
<p>訂單狀態事件-待退貨：新建退回單/發送待退貨通知</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
<tr>
<td align="left"><code>$SALODR_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">SALODR資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>33.25 OnReturn(protected)</h2>
<pre><code class="language-php">protected function OnReturn($ID, $SALODR_Data = array())
</code></pre>
<p>訂單狀態事件-已退貨：新建銷貨退回單/更新發票/更新庫存/更新關聯資料表</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
<tr>
<td align="left"><code>$SALODR_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">SALODR資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>33.26 OnWaitingRefund(protected)</h2>
<pre><code class="language-php">protected function OnWaitingRefund($ID, $SALODR_Data = array())
</code></pre>
<p>(暫不實作) 訂單狀態事件-等待退款：發送等待退款通知</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
<tr>
<td align="left"><code>$SALODR_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">SALODR資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>33.27 OnRefund(protected)</h2>
<pre><code class="language-php">protected function OnRefund($ID, $SALODR_Data = array())
</code></pre>
<p>(暫不實作) 訂單狀態事件-已退款：更新退回訂單/更新退回訂單/更新銷貨退回單/發送已退款通知</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
<tr>
<td align="left"><code>$SALODR_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">SALODR資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>33.28 OnWaitingClose(protected)</h2>
<pre><code class="language-php">protected function OnWaitingClose($ID, $SALODR_Data = array())
</code></pre>
<p>訂單狀態事件-待結案：發送待結案通知</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
<tr>
<td align="left"><code>$SALODR_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">SALODR資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>33.29 OnClose(protected)</h2>
<pre><code class="language-php">protected function OnClose($ID, $SALODR_Data = array())
</code></pre>
<p>(暫不實作) 訂單狀態事件-已結案：發送已結案通知</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">SALODRID</td>
</tr>
<tr>
<td align="left"><code>$SALODR_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">SALODR資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h1>34. DBSMOD_Task extends DBSMOD</h1>
<h2>34.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$StatusFlagKeys</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>Task.StatusFlag</code> 任務每個旗標所象徵的狀態</td>
</tr>
<tr>
<td align="left"><code>$RequiredStatus</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>Task.StatusFlag</code> 初始即不為空值的旗標</td>
</tr>
<tr>
<td align="left"><code>$AutoCompleteStatus</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>Task.StatusFlag</code> 初始即為完成的旗標</td>
</tr>
<tr>
<td align="left"><code>$OnPaid</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> 任務狀態變更為已付款時觸發的事件</td>
</tr>
<tr>
<td align="left"><code>$OnHidden</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> 任務狀態變更為隱藏時觸發的事件</td>
</tr>
<tr>
<td align="left"><code>$OnFrozen</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> 任務狀態變更為凍結時觸發的事件</td>
</tr>
<tr>
<td align="left"><code>$OnQuotaFilled</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> 任務狀態變更為達標時觸發的事件</td>
</tr>
<tr>
<td align="left"><code>$OnReviewed</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> 任務狀態變更為已審核時觸發的事件</td>
</tr>
</tbody>
</table>
<h2>34.2 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>34.3 Select</h2>
<pre><code class="language-php">public function Select($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TaskID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>34.4 Create</h2>
<pre><code class="language-php">public function Create($R_Data)
</code></pre>
<p>新增資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">Task資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>34.5 Update</h2>
<pre><code class="language-php">public function Update($ID, $R_Data)
</code></pre>
<p>更新資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TaskID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">Task資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>34.6 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TaskID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>34.7 GetRunningState</h2>
<pre><code class="language-php">public function GetRunningState($StatusFlag, $ExpireDateTime)
</code></pre>
<p>取得任務狀態</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$StatusFlag</code></td>
<td align="left"><code>string</code></td>
<td align="left">任務狀態旗標字串，可能的值為 <code>Paid</code>, <code>Hidden</code>, <code>Frozen</code>, <code>QuotaFilled</code>, `Reviewed</td>
</tr>
<tr>
<td align="left"><code>$ExpireDateTime</code></td>
<td align="left"><code>string</code></td>
<td align="left">任務到期時間</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code> 任務狀態，可能的值為 <code>EXECUTING</code>, <code>CLOSED</code>, <code>COMPLETED</code>, <code>REVIEWED</code></p>
<h2>34.8 BindStatusEvent</h2>
<pre><code class="language-php">public function BindStatusEvent($Trigger, $Event)
</code></pre>
<p>綁定任務狀態變更時觸發的事件</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Trigger</code></td>
<td align="left"><code>string</code></td>
<td align="left">觸發事件的狀態旗標，可能的值為 <code>Paid</code>, <code>Hidden</code>, <code>Frozen</code>, <code>QuotaFilled</code>, <code>Reviewed</code></td>
</tr>
<tr>
<td align="left"><code>$Event</code></td>
<td align="left"><code>callable</code></td>
<td align="left">觸發的事件函式，必須有兩個參數，第一個為 TaskID，第二個為 TaskData</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>true</code></p>
<h2>34.9 GetInitStatusFlag(protected)</h2>
<pre><code class="language-php">protected function GetInitStatusFlag()
</code></pre>
<p>取得 Task 初始狀態旗標字串</p>
<p><strong>回傳</strong></p>
<p><code>string</code></p>
<h2>34.10 FireStatusEvent(protected)</h2>
<pre><code class="language-php">protected function FireStatusEvent($ID, $NewStatusFlag, $ORIStatusFlag, $TaskData = array())
</code></pre>
<p>觸發任務狀態變更的事件</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TaskID</td>
</tr>
<tr>
<td align="left"><code>$NewStatusFlag</code></td>
<td align="left"><code>string</code></td>
<td align="left">新狀態旗標字串</td>
</tr>
<tr>
<td align="left"><code>$ORIStatusFlag</code></td>
<td align="left"><code>string</code></td>
<td align="left">原狀態旗標字串</td>
</tr>
<tr>
<td align="left"><code>$TaskData</code></td>
<td align="left"><code>array</code></td>
<td align="left">Task資料</td>
</tr>
</tbody>
</table>
<h2>34.11 CheckExecutingToCompleted(protected)</h2>
<pre><code class="language-php">protected function CheckExecutingToCompleted($ID)
</code></pre>
<p>檢查執行中的任務的執行次數是否已達標</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TaskID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code>|<code>false</code> 若已達標，則回傳新的狀態旗標字串，否則回傳 <code>false</code></p>
<h2>34.12 CheckCompletedToReviewed(protected)</h2>
<pre><code class="language-php">protected function CheckCompletedToReviewed($ID)
</code></pre>
<p>檢查已達標任務的執行是否都已審核</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TaskID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code>|<code>false</code> 若已審核，則回傳新的狀態旗標字串，否則回傳 <code>false</code></p>
<h1>35. DBSMOD_TaskExecution extends DBSMOD</h1>
<h2>35.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$StatusFlagKeys</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>TaskExecution.StatusFlag</code> 任務每個旗標所象徵的狀態</td>
</tr>
<tr>
<td align="left"><code>$RequiredStatus</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>TaskExecution.StatusFlag</code> 初始即不為空值的旗標</td>
</tr>
<tr>
<td align="left"><code>$AutoCompleteStatus</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>TaskExecution.StatusFlag</code> 初始即為完成的旗標</td>
</tr>
<tr>
<td align="left"><code>$TaskMod</code></td>
<td align="left"><code>DBSMOD_Task</code></td>
<td align="left"><strong>(protected)</strong> 處理 Task 資料的模組</td>
</tr>
<tr>
<td align="left"><code>$OnExpired</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> 任務狀態變更為已逾期的事件</td>
</tr>
<tr>
<td align="left"><code>$OnReported</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> 任務狀態變更為已回報的事件</td>
</tr>
<tr>
<td align="left"><code>$OnReviewed</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> 任務狀態變更為已審核的事件</td>
</tr>
<tr>
<td align="left"><code>$OnPassed</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> 任務狀態變更為已通過審核的事件</td>
</tr>
<tr>
<td align="left"><code>$OnPaid</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> 任務狀態變更為已支付報酬的事件</td>
</tr>
<tr>
<td align="left"><code>$OnClosed</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> 任務狀態變更為已結案的事件</td>
</tr>
</tbody>
</table>
<h2>35.2 __construct</h2>
<pre><code class="language-php">public function __construct($Link, $DB_TABLE, $TaskMod)
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Link</code></td>
<td align="left"><code>\PDO</code></td>
<td align="left">PDO 連線物件</td>
</tr>
<tr>
<td align="left"><code>$DB_TABLE</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料表名稱</td>
</tr>
<tr>
<td align="left"><code>$TaskMod</code></td>
<td align="left"><code>DBSMOD_Task</code></td>
<td align="left">處理 Task 資料的模組</td>
</tr>
</tbody>
</table>
<h2>35.3 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>35.4 Select</h2>
<pre><code class="language-php">public function Select($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TaskExecutionID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>35.5 Create</h2>
<pre><code class="language-php">public function Create($R_Data)
</code></pre>
<p>新增資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">TaskExecution資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>35.6 Update</h2>
<pre><code class="language-php">public function Update($ID, $R_Data)
</code></pre>
<p>更新資料，若狀態變更為已逾期，則撤回參與人數</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TaskExecutionID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">TaskExecution資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>35.7 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TaskExecutionID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>35.8 BindStatusEvent</h2>
<pre><code class="language-php">public function BindStatusEvent($Trigger, $Event)
</code></pre>
<p>綁定任務狀態變更的事件</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Trigger</code></td>
<td align="left"><code>string</code></td>
<td align="left">事件觸發的旗標字串，可能的值為: Expired, Reported, Reviewed, Passed, Paid, Closed</td>
</tr>
<tr>
<td align="left"><code>$Event</code></td>
<td align="left"><code>callable</code></td>
<td align="left">事件函式，必須接受兩個參數: TaskExecutionID, TaskExecutionData</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>true</code></p>
<h2>35.9 GetInitStatusFlag(protected)</h2>
<pre><code class="language-php">protected function GetInitStatusFlag()
</code></pre>
<p>取得 TaskExecution 初始狀態旗標字串</p>
<p><strong>回傳</strong></p>
<p><code>string</code></p>
<h2>35.10 FireStatusEvent(protected)</h2>
<pre><code class="language-php">protected function FireStatusEvent($ID, $NewStatusFlag, $ORIStatusFlag, $TaskExecutionData = array())
</code></pre>
<p>觸發任務狀態變更的事件</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TaskExecutionID</td>
</tr>
<tr>
<td align="left"><code>$NewStatusFlag</code></td>
<td align="left"><code>string</code></td>
<td align="left">新狀態旗標字串</td>
</tr>
<tr>
<td align="left"><code>$ORIStatusFlag</code></td>
<td align="left"><code>string</code></td>
<td align="left">原狀態旗標字串</td>
</tr>
<tr>
<td align="left"><code>$TaskExecutionData</code></td>
<td align="left"><code>array</code></td>
<td align="left">TaskExecution資料</td>
</tr>
</tbody>
</table>
<h2>35.11 RevokeExecutionCount(protected)</h2>
<pre><code class="language-php">protected function RevokeExecutionCount($ID)
</code></pre>
<p>撤回執行計數與參與人數；若同一參與者在同一任務中有其他未逾期任務，則不撤回</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TaskExecutionID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>int</code> 當前執行計數</p>
<h1>36. DBSMOD_Textbook extends DBSMOD</h1>
<h2>36.1 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>36.2 Select</h2>
<pre><code class="language-php">public function Select($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆教科書資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TextbookID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>36.3 Create</h2>
<pre><code class="language-php">public function Create($R_Data)
</code></pre>
<p>新增教科書資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">Textbook 資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>36.4 Update</h2>
<pre><code class="language-php">public function Update($ID, $R_Data)
</code></pre>
<p>更新教科書資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TextbookID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">Textbook 資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>36.5 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除教科書資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TextbookID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>36.6 SelectTYP</h2>
<pre><code class="language-php">public function SelectTYP($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆 TextbookTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TextbookTYPID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>36.7 CreateTYP</h2>
<pre><code class="language-php">public function CreateTYP($R_Data)
</code></pre>
<p>新增資料 TextbookTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">TextbookTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>36.8 UpdateTYP</h2>
<pre><code class="language-php">public function UpdateTYP($ID, $R_Data)
</code></pre>
<p>更新資料 TextbookTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TextbookTYPID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">TextbookTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>36.9 DeleteTYP</h2>
<pre><code class="language-php">public function DeleteTYP($ID)
</code></pre>
<p>刪除資料 TextbookTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TextbookTYPID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>36.10 UpdateTYPIFOCNT(protected)</h2>
<pre><code class="language-php">protected function UpdateTYPIFOCNT($ID, $Count = 1)
</code></pre>
<p>更新教科書類別資料計數</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TextbookTYPID</td>
</tr>
<tr>
<td align="left"><code>$Count</code></td>
<td align="left"><code>integer</code></td>
<td align="left">計數待相加的數字</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>int</code>|<code>false</code></p>
<h2>36.11 SelectTOCItem</h2>
<pre><code class="language-php">public function SelectTOCItem($ID, $Field_Array = array())
</code></pre>
<p>取得教科書目錄項目</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TextbookTOCITMID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>36.12 CreateTOCItem</h2>
<pre><code class="language-php">public function CreateTOCItem($R_Data, $PreviousItemID = null)
</code></pre>
<p>建立教科書目錄項目，並更新同書本中其他章節的序號</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">教科書目錄項目的資料</td>
</tr>
<tr>
<td align="left"><code>$PreviousItemID</code></td>
<td align="left"><code>string</code></td>
<td align="left">排序在前一個的教科書目錄項目ID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>36.13 UpdateTOCItem</h2>
<pre><code class="language-php">public function UpdateTOCItem($ID, $R_Data)
</code></pre>
<p>更新教科書目錄項目，若更新的資料包含序號，同時更新同書本中其他章節的序號</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TextbookTOCITMID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">教科書目錄項目的資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>36.14 DeleteTOCItem</h2>
<pre><code class="language-php">public function DeleteTOCItem($ID)
</code></pre>
<p>刪除教科書目錄項目，並更新同書本中其他章節的序號</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">TextbookTOCITMID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h1>37. DBSMOD_User extends DBSMOD</h1>
<h2>37.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$VRFFlagKeys</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>User.VRFFlag</code> 旗標各字元對應的鍵，映射到 <code>UserAUT.AUTVRFSet</code> 的鍵。&lt;br&gt;陣列中第 <code>0</code> 位對應到旗標字串的最右側字元。</td>
</tr>
<tr>
<td align="left"><code>$RequiredVRF</code></td>
<td align="left"><code>array</code></td>
<td align="left">用戶登入前必須通過的驗證</td>
</tr>
<tr>
<td align="left"><code>$MODSalt</code></td>
<td align="left"><code>string</code></td>
<td align="left">模組內加密使用的鹽</td>
</tr>
</tbody>
</table>
<h2>37.2 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>37.3 Select</h2>
<pre><code class="language-php">public function Select($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>37.4 Create</h2>
<pre><code class="language-php">public function Create($R_Data)
</code></pre>
<p>新增資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">User資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>37.5 Update</h2>
<pre><code class="language-php">public function Update($ID, $R_Data)
</code></pre>
<p>更新資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">User資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>37.6 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 刪除資料成功則回傳 <code>true</code></p>
<h2>37.7 SelectTYP</h2>
<pre><code class="language-php">public function SelectTYP($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆 UserTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserTYPID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>37.8 CreateTYP</h2>
<pre><code class="language-php">public function CreateTYP($R_Data)
</code></pre>
<p>新增資料 UserTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">UserTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>37.9 UpdateTYP</h2>
<pre><code class="language-php">public function UpdateTYP($ID, $R_Data)
</code></pre>
<p>更新資料 UserTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserTYPID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">UserTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>37.10 DeleteTYP</h2>
<pre><code class="language-php">public function DeleteTYP($ID)
</code></pre>
<p>刪除資料 UserTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserTYPID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>37.11 SelectAUT</h2>
<pre><code class="language-php">public function SelectAUT($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆用戶驗證資料 (以 UserID 為索引)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>37.12 SelectCUS</h2>
<pre><code class="language-php">public function SelectCUS($UserID, $Field_Array = array())
</code></pre>
<p>查詢單筆用戶所屬廠商的關聯及廠商資料 (以 UserID 為索引)；每個用戶只能隸屬於一個廠商</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$UserID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的 RT_CUS_User 及 CUSIFO 資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>37.13 UpdateCUS</h2>
<pre><code class="language-php">public function UpdateCUS($UserID, $R_Data)
</code></pre>
<p>更新或新建用戶所屬廠商的關聯 (以 UserID 為索引)；每個用戶只能隸屬於一個廠商</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">RT_CUS_User 資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>37.14 ProcessPIN(protected)</h2>
<pre><code class="language-php">protected function ProcessPIN($PIN)
</code></pre>
<p>雜湊處理密碼及登入帳號</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$PIN</code></td>
<td align="left"><code>string</code></td>
<td align="left">待雜湊處理的字串</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code> 回傳雜湊後的字串</p>
<h2>37.15 ProcessAUTVRF(protected)</h2>
<pre><code class="language-php">protected function ProcessAUTVRF($VRFFlag, $ORISet = null)
</code></pre>
<p>從 <code>User.VRFFlag</code> 旗標字串產生 <code>UserAUT.AUTVRFSet</code> 格式的陣列</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$VRFFlag</code></td>
<td align="left"><code>string</code></td>
<td align="left"><code>User.VRFFlag</code> 的值</td>
</tr>
<tr>
<td align="left"><code>$ORISet</code></td>
<td align="left"><code>array</code></td>
<td align="left">修改前的 <code>UserAUT.AUTVRFSet</code> 解析成的關聯陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code> 回傳 <code>UserAUT.AUTVRFSet</code> 格式的關聯陣列</p>
<h2>37.16 Login</h2>
<pre><code class="language-php">public function Login($LoginName, $PIN1, $Field_Array = ['UserID', 'SERNO'], $UserTYP = null)
</code></pre>
<p>用戶以帳號密碼登入</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$LoginName</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶帳號</td>
</tr>
<tr>
<td align="left"><code>$PIN1</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶密碼</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">回傳時的用戶資料欄位，預設只包含 <code>UserID</code>, <code>SERNO</code></td>
</tr>
<tr>
<td align="left"><code>$UserTYP</code></td>
<td align="left"><code>string</code></td>
<td align="left">指定的用戶類別，如 <code>MBR</code>, <code>EPY</code></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 登入成功時回傳包含令牌 <code>ACSToken</code> 的用戶資料，登入失敗時回傳 <code>false</code></p>
<h2>37.17 SendNotice</h2>
<pre><code class="language-php">public function SendNotice($ID, $TPLDOCID, $ReplaceArray = array(), $SendMethod = NOTICE_EMAIL)
</code></pre>
<p>發送通知給用戶</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶的 <code>UserID</code></td>
</tr>
<tr>
<td align="left"><code>$TPLDOCID</code></td>
<td align="left"><code>string</code></td>
<td align="left">通知的範本文件 <code>REFDOCID</code></td>
</tr>
<tr>
<td align="left"><code>$ReplaceArray</code></td>
<td align="left"><code>array</code></td>
<td align="left">待替換字串的關聯陣列</td>
</tr>
<tr>
<td align="left"><code>$SendMethod</code></td>
<td align="left"><code>int</code></td>
<td align="left">發送途徑</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 若成功發送即回傳 <code>true</code>，反之則回傳 <code>false</code></p>
<h2>37.18 ActivateEMLVRF</h2>
<pre><code class="language-php">public function ActivateEMLVRF($ID, $TPLDOCID)
</code></pre>
<p>發送電子信箱驗證信。<br />
信件中的驗證連結會包含兩組加密金鑰。</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">收信用戶的 UserID</td>
</tr>
<tr>
<td align="left"><code>$TPLDOCID</code></td>
<td align="left"><code>string</code></td>
<td align="left">電子信箱驗證信的文件範本 REFDOCID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 發送成功即回傳 <code>true</code></p>
<h2>37.19 ChangeAUTVRF(protected)</h2>
<pre><code class="language-php">protected function ChangeAUTVRF($UserID, $AUTKey, $State)
</code></pre>
<p>改變用戶驗證狀態</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$UserID</code></td>
<td align="left"><code>string</code></td>
<td align="left">待修改的用戶 UserID</td>
</tr>
<tr>
<td align="left"><code>$AUTKey</code></td>
<td align="left"><code>string</code></td>
<td align="left">待修改的驗證項目，必須是本物件屬性 <code>$VRFFlagKeys</code> 中的其中一個元素</td>
</tr>
<tr>
<td align="left"><code>$State</code></td>
<td align="left"><code>string</code></td>
<td align="left">驗證狀態的新旗標字元:&lt;br&gt;- <code>-</code>: Null&lt;br&gt;- <code>F</code>: Failed&lt;br&gt;- <code>I</code>: InProcessing&lt;br&gt;- <code>S</code>: Success</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 若成功改變用戶驗證狀態則回傳 <code>true</code></p>
<h2>37.20 ProcessEMLVRF</h2>
<pre><code class="language-php">public function ProcessEMLVRF($Key1, $Key2)
</code></pre>
<p>透過解密兩組金鑰驗證用戶的電子信箱</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Key1</code></td>
<td align="left"><code>string</code></td>
<td align="left">第一組加密字串，對應到連結參數 <code>str1</code></td>
</tr>
<tr>
<td align="left"><code>$Key2</code></td>
<td align="left"><code>string</code></td>
<td align="left">第二組加密字串，對應到連結參數 <code>str2</code></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 通過驗證即回傳 <code>true</code></p>
<h2>37.21 ProcessEMLVRFByUserID</h2>
<pre><code class="language-php">public function ProcessEMLVRFByUserID($UserID)
</code></pre>
<p>直接通過用戶的電子信箱驗證</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$UserID</code></td>
<td align="left"><code>string</code></td>
<td align="left">待通過電子信箱驗證的用戶 UserID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 通過驗證即回傳 <code>true</code></p>
<h2>37.22 ResetPIN</h2>
<pre><code class="language-php">public function ResetPIN($Recipient, $TPLDOCID, $SendMethod = NOTICE_EMAIL)
</code></pre>
<p>重置指定用戶的密碼為長度 8 位的字串，格式如 <code>/^[A-Z][a-z][0-9]{6}$/</code>，並發送通知給用戶</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Recipient</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶的以下資訊中的任一個: <code>User.LoginName</code>, <code>User.EML1</code>, <code>User.MobileTEL1</code></td>
</tr>
<tr>
<td align="left"><code>$TPLDOCID</code></td>
<td align="left"><code>string</code></td>
<td align="left">重置密碼通知的文件範本 REFDOCID</td>
</tr>
<tr>
<td align="left"><code>$SendMethod</code></td>
<td align="left"><code>int</code></td>
<td align="left">通知發送途徑</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 發送成功即回傳 <code>true</code></p>
<h2>37.23 ActivateOTP</h2>
<pre><code class="language-php">public function ActivateOTP($UserID, $TPLDOCID, $SendMethod = NOTICE_EMAIL, $Scope = array())
</code></pre>
<p>產生用戶 OTP，並發送給用戶</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$UserID</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶 UserID</td>
</tr>
<tr>
<td align="left"><code>$TPLDOCID</code></td>
<td align="left"><code>string</code></td>
<td align="left">OTP 通知的文件範本 REFDOCID</td>
</tr>
<tr>
<td align="left"><code>$SendMethod</code></td>
<td align="left"><code>int</code></td>
<td align="left">通知發送途徑</td>
</tr>
<tr>
<td align="left"><code>$Scope</code></td>
<td align="left"><code>array</code></td>
<td align="left">OTP 作用範圍陣列，陣列中字串格式為 <code>{method}:{api}</code> eg. <code>array(&quot;get:user-info&quot;, &quot;put:user-info&quot;)</code></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 發送成功即回傳 <code>true</code></p>
<h2>37.24 ProcessOTP</h2>
<pre><code class="language-php">public function ProcessOTP($Token, $WriteOffFlag = true)
</code></pre>
<p>驗證 OTP 是否正確</p>
<pre><code>$Token = $_POST['token'];  
$Mod = new DBSMOD_User($this-&gt;DBSLink, $this-&gt;DBS);  
$Result = $Mod-&gt;ProcessOTP($Token);  
echo $Result-&gt;UserIFOID;        //0r47ckwc6jy60rf1  
echo $Result-&gt;UserID;           //0r47ckwc6jy60rf1  
echo $Result-&gt;UserAliasName;    //John Doe  
echo $Result-&gt;UserTYP;          //EPY  
echo $Result-&gt;SessionID;        //  
echo $Result-&gt;Scope;            //[&quot;get:user-info&quot;, &quot;put:user-info&quot;]  
echo $Result-&gt;ExpireDateTime;   //2022-01-01 00:00:00  
echo $Result-&gt;Token;            //M7YdNTZhxPtQ8K4woqI9L0d...  
</code></pre>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Token</code></td>
<td align="left"><code>string</code></td>
<td align="left">OTP Token</td>
</tr>
<tr>
<td align="left"><code>$WriteOffFlag</code></td>
<td align="left"><code>bool</code></td>
<td align="left">是否註銷 OTP，預設為 <code>true</code></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>ACSTokenEntity|<code>false</code> 通過驗證時回傳令牌 <code>ACSToken</code> 的物件，失敗時回傳 <code>false</code></p>
<h2>37.26 UpdateTYPIFOCNT(protected)</h2>
<pre><code class="language-php">protected function UpdateTYPIFOCNT($ID, $Count = 1)
</code></pre>
<p>更新資料計數</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserTYPID</td>
</tr>
<tr>
<td align="left"><code>$Count</code></td>
<td align="left"><code>integer</code></td>
<td align="left">計數待相加的數字</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>int</code>|<code>bool</code></p>
<h1>38. DBSMOD_UserGRP extends DBSMOD</h1>
<h2>38.1 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>38.2 Select</h2>
<pre><code class="language-php">public function Select($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserGRPID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>38.3 Create</h2>
<pre><code class="language-php">public function Create($R_Data)
</code></pre>
<p>新增資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">UserGRP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>38.4 Update</h2>
<pre><code class="language-php">public function Update($ID, $R_Data)
</code></pre>
<p>更新資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserGRPID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">UserGRP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>38.5 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserGRPID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 刪除資料成功則回傳 <code>true</code></p>
<h2>38.6 SelectRole</h2>
<pre><code class="language-php">public function SelectRole($ID, $Field_Array = array())
</code></pre>
<p>取得角色</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">RoleID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>38.7 CreateRole</h2>
<pre><code class="language-php">public function CreateRole($R_Data)
</code></pre>
<p>建立角色</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">角色的資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>38.8 UpdateRole</h2>
<pre><code class="language-php">public function UpdateRole($ID, $R_Data)
</code></pre>
<p>更新角色</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">RoleID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">角色的資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>38.9 DeleteRole</h2>
<pre><code class="language-php">public function DeleteRole($ID)
</code></pre>
<p>刪除角色</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">RoleID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>38.10 AppendUser</h2>
<pre><code class="language-php">public function AppendUser($UserGRPID, $UserID, $RoleID = '', $GNLNote = '')
</code></pre>
<p>新增用戶群組與用戶關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$UserGRPID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserGRPID</td>
</tr>
<tr>
<td align="left"><code>$UserID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserID</td>
</tr>
<tr>
<td align="left"><code>$RoleID</code></td>
<td align="left"><code>string</code></td>
<td align="left">RoleID</td>
</tr>
<tr>
<td align="left"><code>$GNLNote</code></td>
<td align="left"><code>string</code></td>
<td align="left">GNLNote</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>38.11 RemoveUser</h2>
<pre><code class="language-php">public function RemoveUser($UserGRPID, $UserID)
</code></pre>
<p>移除用戶群組與用戶關聯</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$UserGRPID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserGRPID</td>
</tr>
<tr>
<td align="left"><code>$UserID</code></td>
<td align="left"><code>string</code></td>
<td align="left">UserID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h1>39. DBSMOD_UserToken extends DBSMOD</h1>
<h2>39.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ExpireTime</code></td>
<td align="left"><code>int</code></td>
<td align="left">一般令牌的效期 (秒)</td>
</tr>
<tr>
<td align="left"><code>$TMPExpireTime</code></td>
<td align="left"><code>int</code></td>
<td align="left">暫時令牌的效期 (秒)</td>
</tr>
</tbody>
</table>
<h2>39.2 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>39.3 ClearExpiredTokenOnTable(protected)</h2>
<pre><code class="language-php">protected function ClearExpiredTokenOnTable($DBSTable)
</code></pre>
<p>清除過期的令牌</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DBSTable</code></td>
<td align="left"><code>string</code></td>
<td align="left">清除的資料表名稱</td>
</tr>
</tbody>
</table>
<h2>39.4 DeleteByTokenOnTable(protected)</h2>
<pre><code class="language-php">protected function DeleteByTokenOnTable($DBSTable, $ACSToken)
</code></pre>
<p>刪除指定令牌</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DBSTable</code></td>
<td align="left"><code>string</code></td>
<td align="left">令牌儲存的資料表名稱</td>
</tr>
<tr>
<td align="left"><code>$ACSToken</code></td>
<td align="left"><code>string</code></td>
<td align="left">令牌</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>true</code></p>
<h2>39.5 DeleteByUserOnTable(protected)</h2>
<pre><code class="language-php">protected function DeleteByUserOnTable($DBSTable, $UserID, $Condition = '')
</code></pre>
<p>刪除指定用戶的令牌，可透過 $Condition 參數指定刪除條件</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DBSTable</code></td>
<td align="left"><code>string</code></td>
<td align="left">令牌儲存的資料表名稱</td>
</tr>
<tr>
<td align="left"><code>$UserID</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶 UID</td>
</tr>
<tr>
<td align="left"><code>$Condition</code></td>
<td align="left"><code>string</code></td>
<td align="left">刪除條件：若為 Apple</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>true</code></p>
<h2>39.6 CreateTokenOnTable(protected)</h2>
<pre><code class="language-php">protected function CreateTokenOnTable($DBSTable, $UserID, $UserTYP, $Scopes)
</code></pre>
<p>產生令牌，並儲存到指定的資料表，回傳令牌物件<br />
此方法不開放外部呼叫，請使用 DBSMOD_UserToken::CreateToken() 或 DBSMOD_UserToken::CreateTMPToken() 來產生令牌</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DBSTable</code></td>
<td align="left"><code>string</code></td>
<td align="left">儲存令牌的資料表名稱</td>
</tr>
<tr>
<td align="left"><code>$UserID</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶UID</td>
</tr>
<tr>
<td align="left"><code>$UserTYP</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶類型，可能的值為 MBR</td>
</tr>
<tr>
<td align="left"><code>$Scopes</code></td>
<td align="left"><code>array</code></td>
<td align="left">列舉權限範圍的數值陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>ACSTokenEntity|<code>false</code> 回傳 ACSToken 物件，若失敗則回傳 <code>false</code></p>
<h2>39.7 CheckTokenOnTable(protected)</h2>
<pre><code class="language-php">protected function CheckTokenOnTable($DBSTable, $ACSToken, $UserTYP = '', $CheckSource = false)
</code></pre>
<p>檢查令牌是否有效<br />
此方法不開放外部呼叫，請使用 DBSMOD_UserToken::CheckToken() 或 DBSMOD_UserToken::CheckTMPToken() 來檢查令牌</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DBSTable</code></td>
<td align="left"><code>string</code></td>
<td align="left">儲存令牌的資料表名稱</td>
</tr>
<tr>
<td align="left"><code>$ACSToken</code></td>
<td align="left"><code>string</code></td>
<td align="left">待驗證的令牌</td>
</tr>
<tr>
<td align="left"><code>$UserTYP</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶類型，可能的值為 MBR</td>
</tr>
<tr>
<td align="left"><code>$CheckSource</code></td>
<td align="left"><code>bool</code></td>
<td align="left">是否檢查來源，預設為 false</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>ACSTokenEntity|<code>false</code> 回傳 ACSToken 物件，若失敗則回傳 <code>false</code></p>
<h2>39.8 CreateToken</h2>
<pre><code class="language-php">public function CreateToken($UserID, $UserTYP = '', $Scopes = array())
</code></pre>
<p>產生令牌並儲存於 UserToken，回傳令牌物件</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$UserID</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶UID</td>
</tr>
<tr>
<td align="left"><code>$UserTYP</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶類型，可能的值為 MBR</td>
</tr>
<tr>
<td align="left"><code>$Scopes</code></td>
<td align="left"><code>array</code></td>
<td align="left">列舉權限範圍的數值陣列，預設為空陣列，表示不限制</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>ACSTokenEntity|<code>false</code> 回傳 ACSToken 物件，若失敗則回傳 <code>false</code></p>
<h2>39.9 CreateTMPToken</h2>
<pre><code class="language-php">public function CreateTMPToken($UserID, $UserTYP = '', $Scopes = array())
</code></pre>
<p>產生令牌並儲存於 TMPToken，回傳令牌物件</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$UserID</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶UID</td>
</tr>
<tr>
<td align="left"><code>$UserTYP</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶類型，可能的值為 MBR</td>
</tr>
<tr>
<td align="left"><code>$Scopes</code></td>
<td align="left"><code>array</code></td>
<td align="left">列舉權限範圍的數值陣列，預設為空陣列，表示不限制</td>
</tr>
</tbody>
</table>
<h2>39.10 DeleteToken</h2>
<pre><code class="language-php">public function DeleteToken($ACSToken)
</code></pre>
<p>刪除指定令牌 (UserToken)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ACSToken</code></td>
<td align="left"><code>string</code></td>
<td align="left">令牌</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>true</code></p>
<h2>39.11 DeleteTMPToken</h2>
<pre><code class="language-php">public function DeleteTMPToken($ACSToken)
</code></pre>
<p>刪除指定令牌 (TMPToken)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ACSToken</code></td>
<td align="left"><code>string</code></td>
<td align="left">令牌</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>true</code></p>
<h2>39.12 DeleteTokenByUser</h2>
<pre><code class="language-php">public function DeleteTokenByUser($UserID, $Condition = '')
</code></pre>
<p>刪除指定用戶的令牌，可透過 $Condition 參數指定刪除條件 (UserToken)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$UserID</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶 UID</td>
</tr>
<tr>
<td align="left"><code>$Condition</code></td>
<td align="left"><code>string</code></td>
<td align="left">刪除條件：若為 Apple</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>true</code></p>
<h2>39.13 DeleteTMPTokenByUser</h2>
<pre><code class="language-php">public function DeleteTMPTokenByUser($UserID, $Condition = '')
</code></pre>
<p>刪除指定用戶的令牌，可透過 $Condition 參數指定刪除條件 (TMPToken)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$UserID</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶 UID</td>
</tr>
<tr>
<td align="left"><code>$Condition</code></td>
<td align="left"><code>string</code></td>
<td align="left">刪除條件：若為 Apple</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>true</code></p>
<h2>39.14 CheckToken</h2>
<pre><code class="language-php">public function CheckToken($ACSToken, $UserTYP = '', $CheckSource = false)
</code></pre>
<p>檢查令牌是否有效 (UserToken)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ACSToken</code></td>
<td align="left"><code>string</code></td>
<td align="left">待驗證的令牌</td>
</tr>
<tr>
<td align="left"><code>$UserTYP</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶類型，可能的值為 MBR</td>
</tr>
<tr>
<td align="left"><code>$CheckSource</code></td>
<td align="left"><code>bool</code></td>
<td align="left">是否檢查來源，預設為 false</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>ACSTokenEntity|<code>false</code> 回傳 ACSToken 物件，若失敗則回傳 <code>false</code></p>
<h2>39.15 CheckTMPToken</h2>
<pre><code class="language-php">public function CheckTMPToken($ACSToken, $UserTYP = '', $CheckSource = false)
</code></pre>
<p>檢查令牌是否有效 (TMPToken)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ACSToken</code></td>
<td align="left"><code>string</code></td>
<td align="left">待驗證的令牌</td>
</tr>
<tr>
<td align="left"><code>$UserTYP</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶類型，可能的值為 MBR</td>
</tr>
<tr>
<td align="left"><code>$CheckSource</code></td>
<td align="left"><code>bool</code></td>
<td align="left">是否檢查來源，預設為 false</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>ACSTokenEntity|<code>false</code> 回傳 ACSToken 物件，若失敗則回傳 <code>false</code></p>
<h2>39.16 Hash(protected)</h2>
<pre><code class="language-php">protected function Hash($String)
</code></pre>
<p>雜湊字串</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$String</code></td>
<td align="left"><code>string</code></td>
<td align="left">待雜湊的字串</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code> 回傳雜湊後的字串</p>
<h2>39.17 GetRandomToken(protected)</h2>
<pre><code class="language-php">protected function GetRandomToken()
</code></pre>
<p>產生 190~255 位的 62 進位亂數</p>
<p><strong>回傳</strong></p>
<p><code>string</code> 回傳亂數</p>
<h2>39.18 GetUserSource</h2>
<pre><code class="language-php">public function GetUserSource()
</code></pre>
<p>取得使用者來源資訊</p>
<pre><code class="language-php">$Mod = new DBSMOD_UserToken($this-&gt;DBSLink, $this-&gt;DBS);  
$UserSource = $Mod-&gt;GetUserSource();  
print_r($UserSource);  
//Array(  
//    [user_ip] =&gt; '111.11.111.11'  
//    [user_agent] =&gt; 'PC'  
//)  
</code></pre>
<p><strong>回傳</strong></p>
<p><code>array</code> 使用者來源資訊</p>
<h1>40. DBSMOD_ViewSchema extends DBSMOD</h1>
<h2>40.1 SetTables(protected)</h2>
<pre><code class="language-php">protected function SetTables()
</code></pre>
<p>設定預設資料表參數 (實作抽象方法)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>40.2 Select</h2>
<pre><code class="language-php">public function Select($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">ViewSchemaID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>40.3 Create</h2>
<pre><code class="language-php">public function Create($R_Data)
</code></pre>
<p>新增資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">ViewSchema資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>40.4 Update</h2>
<pre><code class="language-php">public function Update($ID, $R_Data)
</code></pre>
<p>更新資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">ViewSchemaID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">ViewSchema資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>40.5 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">ViewSchemaID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>40.6 SelectTYP</h2>
<pre><code class="language-php">public function SelectTYP($ID, $Field_Array = array())
</code></pre>
<p>查詢單筆 ViewSchemaTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">ViewSchemaTYPID</td>
</tr>
<tr>
<td align="left"><code>$Field_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>40.7 CreateTYP</h2>
<pre><code class="language-php">public function CreateTYP($R_Data)
</code></pre>
<p>新增資料 ViewSchemaTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">ViewSchemaTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>40.8 UpdateTYP</h2>
<pre><code class="language-php">public function UpdateTYP($ID, $R_Data)
</code></pre>
<p>更新資料 ViewSchemaTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">ViewSchemaTYPID</td>
</tr>
<tr>
<td align="left"><code>$R_Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">ViewSchemaTYP資料表欄位名稱與資料的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>40.9 DeleteTYP</h2>
<pre><code class="language-php">public function DeleteTYP($ID)
</code></pre>
<p>刪除資料 ViewSchemaTYP</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">ViewSchemaTYPID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>40.10 UpdateTYPIFOCNT(protected)</h2>
<pre><code class="language-php">protected function UpdateTYPIFOCNT($ID, $Count = 1)
</code></pre>
<p>更新資料計數</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">ViewSchemaTYPID</td>
</tr>
<tr>
<td align="left"><code>$Count</code></td>
<td align="left"><code>integer</code></td>
<td align="left">計數待相加的數字</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>int</code>|<code>bool</code></p>
<h2>40.11 MergeCommonSchema</h2>
<pre><code class="language-php">public function MergeCommonSchema($Content)
</code></pre>
<p>合併頁面內容的 FUI Schema 與包含頁首/頁尾的共通 FUI Schema，回傳完整頁面的 FUI Schema</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Content</code></td>
<td align="left">`array</td>
<td align="left">string`</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h1>41. ACSTokenEntity</h1>
<h2>41.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Token</code></td>
<td align="left"><code>string</code></td>
<td align="left">令牌</td>
</tr>
<tr>
<td align="left"><code>$UserTYP</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶類型，如：MBR、EPY</td>
</tr>
<tr>
<td align="left"><code>$UserID</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶 UID，對應 User.UserID</td>
</tr>
<tr>
<td align="left"><code>$UserIFOID</code></td>
<td align="left"><code>string</code></td>
<td align="left">同 ACSToken::UserID，用戶 UID，對應 User.UserID</td>
</tr>
<tr>
<td align="left"><code>$UserCode</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶 UID 代碼雜湊</td>
</tr>
<tr>
<td align="left"><code>$UserAliasName</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶名稱，對應 User.FullName</td>
</tr>
<tr>
<td align="left"><code>$FullName</code></td>
<td align="left"><code>string</code></td>
<td align="left">同 ACSToken::UserAliasName，用戶名稱，對應 User.FullName</td>
</tr>
<tr>
<td align="left"><code>$ExpireDateTime</code></td>
<td align="left"><code>string</code></td>
<td align="left">令牌到期時間 (YYYY-MM-DD HH:II:SS)</td>
</tr>
<tr>
<td align="left"><code>$ExpireTimestamp</code></td>
<td align="left"><code>int</code></td>
<td align="left">令牌到期時間戳記</td>
</tr>
<tr>
<td align="left"><code>$SessionID</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶 SessionID</td>
</tr>
<tr>
<td align="left"><code>$Scope</code></td>
<td align="left"><code>string</code></td>
<td align="left">令牌權限範圍的 JSON 字串，如 '[&quot;get:member-real-name&quot;,&quot;put:member-real-name&quot;]'</td>
</tr>
</tbody>
</table>
<h2>41.2 __construct</h2>
<pre><code class="language-php">public function __construct($ACSToken, $UserTYP, $UserID, $UserCode, $UserAliasName, $ExpireTimestamp, $SessionID, $Scope)
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ACSToken</code></td>
<td align="left"><code>string</code></td>
<td align="left">令牌</td>
</tr>
<tr>
<td align="left"><code>$UserTYP</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶類型，如：MBR、EPY</td>
</tr>
<tr>
<td align="left"><code>$UserID</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶 UID，對應 User.UserID</td>
</tr>
<tr>
<td align="left"><code>$UserCode</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶 UID 代碼雜湊</td>
</tr>
<tr>
<td align="left"><code>$UserAliasName</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶名稱，對應 User.FullName</td>
</tr>
<tr>
<td align="left"><code>$ExpireTimestamp</code></td>
<td align="left"><code>int</code></td>
<td align="left">令牌到期時間戳記</td>
</tr>
<tr>
<td align="left"><code>$SessionID</code></td>
<td align="left"><code>string</code></td>
<td align="left">用戶 SessionID</td>
</tr>
<tr>
<td align="left"><code>$Scope</code></td>
<td align="left"><code>string</code></td>
<td align="left">令牌權限範圍的 JSON 字串，如 '[&quot;get:member-real-name&quot;,&quot;put:member-real-name&quot;]'</td>
</tr>
</tbody>
</table>
<h2>41.3 FromArray(static)</h2>
<pre><code class="language-php">static public function FromArray($Array)
</code></pre>
<p>從關聯陣列建構 ACSToken 物件的靜態方法</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">關聯陣列，鍵包括：ACSToken、UserTYP、UserID、UserCode、UserAliasName、ExpireTimestamp、SessionID、Scope</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>ACSTokenEntity</p>
<h2>41.4 ToArray</h2>
<pre><code class="language-php">public function ToArray()
</code></pre>
<p>輸出物件屬性為關聯陣列</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h1>42. Archive</h1>
<h2>42.1 __construct</h2>
<pre><code class="language-php">public function __construct($Path)
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Path</code></td>
<td align="left"><code>string</code></td>
<td align="left">壓縮檔案絕對路徑</td>
</tr>
</tbody>
</table>
<h2>42.2 GetFileInfo</h2>
<pre><code class="language-php">public function GetFileInfo($CreatorID, $CreatorName)
</code></pre>
<p>回傳以 File 資料表欄位名稱為鍵的關聯陣列，包括 Title, FileName, StoreDIRPath, FileSize, ContentTYP, CreatorID, CreatorName 等<br />
其中，Title 與 FileName 內容相同，為檔案名稱(含副檔名)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$CreatorID</code></td>
<td align="left"><code>string</code></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><code>$CreatorName</code></td>
<td align="left"><code>string</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code> 以 File 資料表欄位名稱為鍵的關聯陣列，包括 Title, FileName, StoreDIRPath, FileSize, ContentTYP, CreatorID, CreatorName 等</p>
<h1>43. DBSTableEntity</h1>
<h2>43.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DBSLink</code></td>
<td align="left"><code>\PDO</code></td>
<td align="left">PDO 物件</td>
</tr>
<tr>
<td align="left"><code>$DBS</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料庫名稱</td>
</tr>
<tr>
<td align="left"><code>$Name</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料表名稱</td>
</tr>
<tr>
<td align="left"><code>$PK</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料表主鍵的欄位名稱</td>
</tr>
<tr>
<td align="left"><code>$Fields</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> 資料表欄位名稱的數值陣列</td>
</tr>
<tr>
<td align="left"><code>$JSONPath</code></td>
<td align="left"><code>string</code></td>
<td align="left">存放資料表結構快取JSON的資料夾路徑</td>
</tr>
</tbody>
</table>
<h2>43.2 __construct</h2>
<pre><code class="language-php">public function __construct($Name, $DBSLink, $DBS)
</code></pre>
<p>類別建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Name</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料表名稱</td>
</tr>
<tr>
<td align="left"><code>$DBSLink</code></td>
<td align="left"><code>\PDO</code></td>
<td align="left">PDO 物件</td>
</tr>
<tr>
<td align="left"><code>$DBS</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料庫名稱</td>
</tr>
</tbody>
</table>
<h2>43.3 SetFields</h2>
<pre><code class="language-php">public function SetFields()
</code></pre>
<p>寫入屬性 Fields (資料表欄位名稱的數值陣列)</p>
<h2>43.4 GetFields</h2>
<pre><code class="language-php">public function GetFields()
</code></pre>
<p>讀取屬性 Fields (資料表欄位名稱的數值陣列)</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h2>43.5 ValidateFields</h2>
<pre><code class="language-php">public function ValidateFields(array $Fields)
</code></pre>
<p>驗證欄位名稱是否被包含於物件中的屬性 Fields</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Fields</code></td>
<td align="left"><code>array</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h1>44. JWTEntity</h1>
<h2>44.1 ToString</h2>
<pre><code class="language-php">public function ToString($PrivateKeyUri)
</code></pre>
<p>將 JWTEntity 物件轉換為 JWT 字串</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$PrivateKeyUri</code></td>
<td align="left"><code>string</code></td>
<td align="left">私鑰檔案路徑</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code> JWT 字串</p>
<h2>44.2 GetJTI</h2>
<pre><code class="language-php">public function GetJTI()
</code></pre>
<p>Get the value of JTI</p>
<h2>44.3 SetJTI</h2>
<pre><code class="language-php">public function SetJTI($JTI)
</code></pre>
<p>Set the value of JTI</p>
<p><strong>回傳</strong></p>
<p>self</p>
<h2>44.4 GetSUB</h2>
<pre><code class="language-php">public function GetSUB()
</code></pre>
<p>Get the value of SUB</p>
<h2>44.5 SetSUB</h2>
<pre><code class="language-php">public function SetSUB($SUB)
</code></pre>
<p>Set the value of SUB</p>
<p><strong>回傳</strong></p>
<p>self</p>
<h2>44.6 GetISS</h2>
<pre><code class="language-php">public function GetISS()
</code></pre>
<p>Get the value of ISS</p>
<h2>44.7 SetISS</h2>
<pre><code class="language-php">public function SetISS($ISS)
</code></pre>
<p>Set the value of ISS</p>
<p><strong>回傳</strong></p>
<p>self</p>
<h2>44.8 GetAUD</h2>
<pre><code class="language-php">public function GetAUD()
</code></pre>
<p>Get the value of AUD</p>
<h2>44.9 SetAUD</h2>
<pre><code class="language-php">public function SetAUD($AUD)
</code></pre>
<p>Set the value of AUD</p>
<p><strong>回傳</strong></p>
<p>self</p>
<h2>44.10 GetEXP</h2>
<pre><code class="language-php">public function GetEXP()
</code></pre>
<p>Get the value of EXP</p>
<h2>44.11 SetEXP</h2>
<pre><code class="language-php">public function SetEXP($EXP)
</code></pre>
<p>Set the value of EXP</p>
<p><strong>回傳</strong></p>
<p>self</p>
<h2>44.12 GetIAT</h2>
<pre><code class="language-php">public function GetIAT()
</code></pre>
<p>Get the value of IAT</p>
<h2>44.13 SetIAT</h2>
<pre><code class="language-php">public function SetIAT($IAT)
</code></pre>
<p>Set the value of IAT</p>
<p><strong>回傳</strong></p>
<p>self</p>
<h2>44.14 GetNBF</h2>
<pre><code class="language-php">public function GetNBF()
</code></pre>
<p>Get the value of NBF</p>
<h2>44.15 SetNBF</h2>
<pre><code class="language-php">public function SetNBF($NBF)
</code></pre>
<p>Set the value of NBF</p>
<p><strong>回傳</strong></p>
<p>self</p>
<h2>44.16 GetScopes</h2>
<pre><code class="language-php">public function GetScopes()
</code></pre>
<p>Get the value of Scopes</p>
<h2>44.17 SetScopes</h2>
<pre><code class="language-php">public function SetScopes($Scopes)
</code></pre>
<p>Set the value of Scopes</p>
<p><strong>回傳</strong></p>
<p>self</p>
<h1>45. MailEntity</h1>
<h2>45.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$From</code></td>
<td align="left"><code>string</code></td>
<td align="left">寄件者</td>
</tr>
<tr>
<td align="left"><code>$FromName</code></td>
<td align="left"><code>string</code></td>
<td align="left">寄件者名稱</td>
</tr>
<tr>
<td align="left"><code>$To</code></td>
<td align="left"><code>array</code></td>
<td align="left">收件者郵件位址的數值陣列</td>
</tr>
<tr>
<td align="left"><code>$ToName</code></td>
<td align="left"><code>array</code></td>
<td align="left">收件者名稱的數值陣列</td>
</tr>
<tr>
<td align="left"><code>$Bcc</code></td>
<td align="left"><code>string</code></td>
<td align="left">密件副本</td>
</tr>
<tr>
<td align="left"><code>$BccName</code></td>
<td align="left"><code>string</code></td>
<td align="left">密件副本名稱</td>
</tr>
<tr>
<td align="left"><code>$Subject</code></td>
<td align="left"><code>string</code></td>
<td align="left">主旨</td>
</tr>
<tr>
<td align="left"><code>$Detail</code></td>
<td align="left"><code>string</code></td>
<td align="left">內容</td>
</tr>
<tr>
<td align="left"><code>$FileDIR</code></td>
<td align="left"><code>string</code></td>
<td align="left">附件</td>
</tr>
</tbody>
</table>
<h2>45.2 __construct</h2>
<pre><code class="language-php">public function __construct($From, $FromName, $To, $ToName, $Bcc, $BccName, $Subject, $Detail, $FileDIR)
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$From</code></td>
<td align="left"><code>string</code></td>
<td align="left">寄件者</td>
</tr>
<tr>
<td align="left"><code>$FromName</code></td>
<td align="left"><code>string</code></td>
<td align="left">寄件者名稱</td>
</tr>
<tr>
<td align="left"><code>$To</code></td>
<td align="left"><code>string</code></td>
<td align="left">收件者</td>
</tr>
<tr>
<td align="left"><code>$ToName</code></td>
<td align="left"><code>string</code></td>
<td align="left">收件者名稱</td>
</tr>
<tr>
<td align="left"><code>$Bcc</code></td>
<td align="left"><code>string</code></td>
<td align="left">密件副本</td>
</tr>
<tr>
<td align="left"><code>$BccName</code></td>
<td align="left"><code>string</code></td>
<td align="left">密件副本名稱</td>
</tr>
<tr>
<td align="left"><code>$Subject</code></td>
<td align="left"><code>string</code></td>
<td align="left">主旨</td>
</tr>
<tr>
<td align="left"><code>$Detail</code></td>
<td align="left"><code>string</code></td>
<td align="left">內容</td>
</tr>
</tbody>
</table>
<h2>45.3 FromArray(static)</h2>
<pre><code class="language-php">static public function FromArray($Array)
</code></pre>
<p>從陣列建立實體</p>
<p><strong>回傳</strong></p>
<p>MailEntity</p>
<h2>45.4 ToArray</h2>
<pre><code class="language-php">public function ToArray()
</code></pre>
<p>輸出為陣列</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h1>46. SiteSettingsEntity</h1>
<h2>46.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$SiteName</code></td>
<td align="left"><code>string</code></td>
<td align="left">網站名稱</td>
</tr>
<tr>
<td align="left"><code>$LogoImageUrl</code></td>
<td align="left"><code>string[]</code></td>
<td align="left">網站 Logo 圖片網址</td>
</tr>
<tr>
<td align="left"><code>$ServiceTel1</code></td>
<td align="left"><code>string</code></td>
<td align="left">服務電話 1</td>
</tr>
<tr>
<td align="left"><code>$ServiceTel2</code></td>
<td align="left"><code>string</code></td>
<td align="left">服務電話 2</td>
</tr>
<tr>
<td align="left"><code>$ServiceFax1</code></td>
<td align="left"><code>string</code></td>
<td align="left">服務傳真 1</td>
</tr>
<tr>
<td align="left"><code>$ServiceAddress</code></td>
<td align="left"><code>string</code></td>
<td align="left">服務地址</td>
</tr>
<tr>
<td align="left"><code>$ServiceEmail</code></td>
<td align="left"><code>string</code></td>
<td align="left">服務電子郵件</td>
</tr>
<tr>
<td align="left"><code>$ServiceHours</code></td>
<td align="left"><code>string</code></td>
<td align="left">服務時間說明</td>
</tr>
<tr>
<td align="left"><code>$OwnerName</code></td>
<td align="left"><code>string</code></td>
<td align="left">網站擁有者名稱，將顯示於頁尾的版權聲明</td>
</tr>
<tr>
<td align="left"><code>$LinkLine</code></td>
<td align="left"><code>string</code></td>
<td align="left">LINE 官方帳號連結</td>
</tr>
<tr>
<td align="left"><code>$LinkFacebook</code></td>
<td align="left"><code>string</code></td>
<td align="left">Facebook 粉絲專頁連結</td>
</tr>
<tr>
<td align="left"><code>$LinkYouTube</code></td>
<td align="left"><code>string</code></td>
<td align="left">YouTube 頻道連結</td>
</tr>
<tr>
<td align="left"><code>$LinkLinkedIn</code></td>
<td align="left"><code>string</code></td>
<td align="left">LinkedIn 個人頁面連結</td>
</tr>
<tr>
<td align="left"><code>$LinkInstagram</code></td>
<td align="left"><code>string</code></td>
<td align="left">Instagram 個人頁面連結</td>
</tr>
<tr>
<td align="left"><code>$LinkTwitter</code></td>
<td align="left"><code>string</code></td>
<td align="left">Twitter 個人頁面連結</td>
</tr>
</tbody>
</table>
<h2>46.2 __construct</h2>
<pre><code class="language-php">public function __construct($SiteName = '', $LogoImageUrl = [], $ServiceTel1 = '', $ServiceTel2 = '', $ServiceFax1 = '', $ServiceAddress = '', $ServiceEmail = '', $ServiceHours = '', $OwnerName = '', $LinkLine = '', $LinkFacebook = '', $LinkYouTube = '', $LinkLinkedIn = '', $LinkInstagram = '', $LinkTwitter = '')
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$SiteName</code></td>
<td align="left"><code>string</code></td>
<td align="left">網站名稱</td>
</tr>
<tr>
<td align="left"><code>$LogoImageUrl</code></td>
<td align="left"><code>string[]</code></td>
<td align="left">網站 Logo 圖片網址</td>
</tr>
<tr>
<td align="left"><code>$ServiceTel1</code></td>
<td align="left"><code>string</code></td>
<td align="left">服務電話 1</td>
</tr>
<tr>
<td align="left"><code>$ServiceTel2</code></td>
<td align="left"><code>string</code></td>
<td align="left">服務電話 2</td>
</tr>
<tr>
<td align="left"><code>$ServiceFax1</code></td>
<td align="left"><code>string</code></td>
<td align="left">服務傳真 1</td>
</tr>
<tr>
<td align="left"><code>$ServiceAddress</code></td>
<td align="left"><code>string</code></td>
<td align="left">服務地址</td>
</tr>
<tr>
<td align="left"><code>$ServiceEmail</code></td>
<td align="left"><code>string</code></td>
<td align="left">服務電子郵件</td>
</tr>
<tr>
<td align="left"><code>$ServiceHours</code></td>
<td align="left"><code>string</code></td>
<td align="left">服務時間說明</td>
</tr>
<tr>
<td align="left"><code>$OwnerName</code></td>
<td align="left"><code>string</code></td>
<td align="left">網站擁有者名稱，將顯示於頁尾的版權聲明</td>
</tr>
<tr>
<td align="left"><code>$LinkLine</code></td>
<td align="left"><code>string</code></td>
<td align="left">LINE 官方帳號連結</td>
</tr>
<tr>
<td align="left"><code>$LinkFacebook</code></td>
<td align="left"><code>string</code></td>
<td align="left">Facebook 粉絲專頁連結</td>
</tr>
<tr>
<td align="left"><code>$LinkYouTube</code></td>
<td align="left"><code>string</code></td>
<td align="left">YouTube 頻道連結</td>
</tr>
<tr>
<td align="left"><code>$LinkLinkedIn</code></td>
<td align="left"><code>string</code></td>
<td align="left">LinkedIn 個人頁面連結</td>
</tr>
<tr>
<td align="left"><code>$LinkInstagram</code></td>
<td align="left"><code>string</code></td>
<td align="left">Instagram 個人頁面連結</td>
</tr>
<tr>
<td align="left"><code>$LinkTwitter</code></td>
<td align="left"><code>string</code></td>
<td align="left">Twitter 個人頁面連結</td>
</tr>
</tbody>
</table>
<h2>46.3 FromArray(static)</h2>
<pre><code class="language-php">static public function FromArray($Array)
</code></pre>
<p>從關聯陣列建立 SiteSettingsEntity，可用的鍵如下 (首字母大小寫皆相容): <code>SiteName</code>, <code>LogoImageUrl</code>, <code>ServiceTel1</code>, <code>ServiceTel2</code>, <code>ServiceFax1</code>, <code>ServiceAddress</code>, <code>ServiceEmail</code>, <code>ServiceHours</code>, <code>OwnerName</code>, <code>LinkLine</code>, <code>LinkFacebook</code>, <code>LinkYouTube</code>, <code>LinkLinkedIn</code>, <code>LinkInstagram</code>, <code>LinkTwitter</code></p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">關聯陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>SiteSettingsEntity</p>
<h2>46.4 ToArray</h2>
<pre><code class="language-php">public function ToArray($Capitalize = false)
</code></pre>
<p>將 SiteSettingsEntity 轉換為關聯陣列</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Capitalize</code></td>
<td align="left"><code>bool</code></td>
<td align="left">是否將鍵名首字母大寫</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h1>47. SMSEntity</h1>
<h2>47.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$To</code></td>
<td align="left"><code>string</code></td>
<td align="left">收件者手機號碼的數值陣列</td>
</tr>
<tr>
<td align="left"><code>$Detail</code></td>
<td align="left"><code>string</code></td>
<td align="left">簡訊內容</td>
</tr>
</tbody>
</table>
<h2>47.2 __construct</h2>
<pre><code class="language-php">public function __construct($To, $Detail = '') {
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$To</code></td>
<td align="left"><code>string</code></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><code>$Detail</code></td>
<td align="left"><code>string</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<h2>47.3 FromArray(static)</h2>
<pre><code class="language-php">static public function FromArray($Array) {
</code></pre>
<p>從數值陣列建立 SMSEntity 實例</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Array</code></td>
<td align="left"><code>array</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>SMSEntity</p>
<h2>47.4 ToArray</h2>
<pre><code class="language-php">public function ToArray() {
</code></pre>
<p>輸出為關聯陣列</p>
<p><strong>回傳</strong></p>
<p><code>array</code></p>
<h1>48. Spreadsheet</h1>
<h2>48.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Path</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案絕對路徑</td>
</tr>
<tr>
<td align="left"><code>$Extension</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案副檔名</td>
</tr>
</tbody>
</table>
<h2>48.2 __construct</h2>
<pre><code class="language-php">public function __construct($Path)
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Path</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案絕對路徑</td>
</tr>
</tbody>
</table>
<h2>48.3 Move</h2>
<pre><code class="language-php">public function Move($DestinationDIR)
</code></pre>
<p>移動本物件的檔案到指定的資料夾：在指定資料夾下建立當下日期的資料夾，然後移動並重新命名檔案到該資料夾</p>
<pre><code class="language-php">$SheetFile = '/var/www/misa_manage/site/private-data/tmp/20220725/0rgsxfrxqoy01pxz.xlsx';  
$Sheet = new Spreadsheet($SheetFile);  
$Sheet-&gt;Move('/var/www/misa_manage/site/private-data/file');  
echo $Sheet-&gt;Path;  
// /var/www/misa_manage/site/private-data/file/20220930/0sihndso1vyd6gyw.xlsx  
</code></pre>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DestinationDIR</code></td>
<td align="left"><code>string</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>true</code></p>
<h2>48.4 GetFileInfo</h2>
<pre><code class="language-php">public function GetFileInfo($CreatorID, $CreatorName)
</code></pre>
<p>回傳以 File 資料表欄位名稱為鍵的關聯陣列，包括 Title, FileName, StoreDIRPath, FileSize, ContentTYP, CreatorID, CreatorName 等<br />
其中，Title 與 FileName 內容相同，為檔案名稱(含副檔名)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$CreatorID</code></td>
<td align="left"><code>string</code></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><code>$CreatorName</code></td>
<td align="left"><code>string</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code> 以 File 資料表欄位名稱為鍵的關聯陣列，包括 Title, FileName, StoreDIRPath, FileSize, ContentTYP, CreatorID, CreatorName 等</p>
<h1>49. UploadFileInfo extends \SplFileInfo</h1>
<h2>49.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Error</code></td>
<td align="left"><code>\Exception</code></td>
<td align="left">執行中的錯誤</td>
</tr>
<tr>
<td align="left"><code>$UploadFilename</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>(protected)</strong> 檔案上傳時的原始檔案名稱</td>
</tr>
<tr>
<td align="left"><code>$UploadType</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>(protected)</strong> 檔案上傳時的原始檔案類型 (MIME)</td>
</tr>
<tr>
<td align="left"><code>$UploadExtension</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>(protected)</strong> 檔案上傳時的原始副檔名 (不包含 <code>.</code>)</td>
</tr>
</tbody>
</table>
<h2>49.2 FromPost(static)</h2>
<pre><code class="language-php">static public function FromPost($Keys, $Index = null)
</code></pre>
<p>從 $_FILES 中取得檔案資訊，建構 UploadFileInfo 實例</p>
<pre><code class="language-php">//當用戶以 POST 方式上傳填入 input[name=_UploadFiles[0][_FileBinary]][type=file][multiple] 的 &quot;uploading_file.zip&quot;，  
//伺服器端可用下的方式取得上傳的檔案資訊  
$File = UploadFileInfo::FromPost(['_UploadFiles', '0', '_FileBinary'], 0);  
echo $File-&gt;getUploadFilename(); // uploading_file.zip  
echo $File-&gt;getUploadType(); // application/zip  
echo $File-&gt;getUploadExtension(); // zip  
</code></pre>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Keys</code></td>
<td align="left"><code>array</code></td>
<td align="left"><code>$_FILES</code> 中的每一層鍵的數值陣列 (除了 <code>$_FILES</code> 固有的鍵以外)</td>
</tr>
<tr>
<td align="left"><code>$Index</code></td>
<td align="left"><code>int</code></td>
<td align="left"><code>$_FILES</code> 最後一層的檔案索引，當 HTML 表單中的 <code>input[type=file]</code> 容許多個檔案時使用</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>UploadFileInfo</p>
<h2>49.3 getUploadFilename</h2>
<pre><code class="language-php">public function getUploadFilename()
</code></pre>
<p>取得檔案上傳時的原始檔案名稱</p>
<p><strong>回傳</strong></p>
<p><code>string</code></p>
<h2>49.4 setUploadFilename</h2>
<pre><code class="language-php">public function setUploadFilename($Filename)
</code></pre>
<p>設定檔案上傳時的原始檔案名稱</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Filename</code></td>
<td align="left"><code>string</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<h2>49.5 getUploadType</h2>
<pre><code class="language-php">public function getUploadType()
</code></pre>
<p>取得檔案上傳時的原始檔案類型 (MIME)</p>
<p><strong>回傳</strong></p>
<p><code>string</code>|<code>false</code></p>
<h2>49.6 setUploadType</h2>
<pre><code class="language-php">public function setUploadType($Type)
</code></pre>
<p>設定檔案上傳時的原始檔案類型 (MIME)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Type</code></td>
<td align="left"><code>string</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<h2>49.7 getUploadExtension</h2>
<pre><code class="language-php">public function getUploadExtension()
</code></pre>
<p>取得檔案上傳時的原始副檔名 (不包含 <code>.</code>)</p>
<p><strong>回傳</strong></p>
<p><code>string</code>|<code>false</code></p>
<h2>49.8 setUploadExtension</h2>
<pre><code class="language-php">public function setUploadExtension($Extension)
</code></pre>
<p>設定檔案上傳時的原始副檔名</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Extension</code></td>
<td align="left"><code>string</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<h2>49.9 rename</h2>
<pre><code class="language-php">public function rename($RootDIR, $Name = '', $DIR = '')
</code></pre>
<p>重新命名檔案並移動到 <code>$RootDIR/$DIR</code> 資料夾，並回傳新的檔案資訊物件 (\SplFileInfo)</p>
<p><strong>回傳</strong></p>
<p>\SplFileInfo</p>
<h2>49.10 remove</h2>
<pre><code class="language-php">public function remove()
</code></pre>
<p>移除檔案</p>
<h1>50. Crypt {</h1>
<h2>50.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$PassPhrase</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>(protected)</strong> 加密/解密時使用的密碼片語</td>
</tr>
<tr>
<td align="left"><code>$CipherMethod</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>(protected)</strong> 加密/解密時使用的演算法名稱，預設為 AES-128-ECB&lt;br&gt;可用的演算法名稱請參考：<a href="http://php.net/manual/en/function.openssl-get-cipher-methods.php">http://php.net/manual/en/function.openssl-get-cipher-methods.php</a></td>
</tr>
<tr>
<td align="left"><code>$Key</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>(protected)</strong> 雜湊後的密碼片語</td>
</tr>
<tr>
<td align="left"><code>$KeyBits</code></td>
<td align="left"><code>int</code></td>
<td align="left"><strong>(protected)</strong> 密碼片語雜湊的長度</td>
</tr>
</tbody>
</table>
<h2>50.2 __construct</h2>
<pre><code class="language-php">public function __construct($PassPhrase = '', $KeyBits = 128) {
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$PassPhrase</code></td>
<td align="left"><code>string</code></td>
<td align="left">密碼片語，預設為空字串</td>
</tr>
<tr>
<td align="left"><code>$KeyBits</code></td>
<td align="left"><code>int</code></td>
<td align="left">密碼片語雜湊的長度，預設為 128</td>
</tr>
</tbody>
</table>
<h2>50.3 Encrypt</h2>
<pre><code class="language-php">public function Encrypt($Content) {
</code></pre>
<p>加密</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Content</code></td>
<td align="left"><code>mixed</code></td>
<td align="left">要加密的內容</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code></p>
<h2>50.4 Decrypt</h2>
<pre><code class="language-php">public function Decrypt($Content) {
</code></pre>
<p>解密</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Content</code></td>
<td align="left"><code>mixed</code></td>
<td align="left">要解密的內容</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code>|<code>false</code></p>
<h2>50.5 SetCipherMethod</h2>
<pre><code class="language-php">public function SetCipherMethod($CipherMethod) {
</code></pre>
<p>設定加密演算法名稱</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$CipherMethod</code></td>
<td align="left"><code>string</code></td>
<td align="left">加密演算法名稱</td>
</tr>
</tbody>
</table>
<h2>50.6 GetCipherMethod</h2>
<pre><code class="language-php">public function GetCipherMethod() {
</code></pre>
<p>取得加密演算法名稱</p>
<p><strong>回傳</strong></p>
<p><code>string</code></p>
<h2>50.7 SetPassPhrase</h2>
<pre><code class="language-php">public function SetPassPhrase($PassPhrase) {
</code></pre>
<p>設定密碼片語</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$PassPhrase</code></td>
<td align="left"><code>string</code></td>
<td align="left">密碼片語</td>
</tr>
</tbody>
</table>
<h2>50.8 GetPassPhrase</h2>
<pre><code class="language-php">public function GetPassPhrase() {
</code></pre>
<p>取得密碼片語</p>
<p><strong>回傳</strong></p>
<p><code>string</code></p>
<h1>51. DBSAction</h1>
<h2>51.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DBSLink</code></td>
<td align="left"><code>PDO</code></td>
<td align="left">資料庫連線物件 PDO</td>
</tr>
<tr>
<td align="left"><code>$DBS</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料庫名稱</td>
</tr>
<tr>
<td align="left"><code>$DBSTable</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料表名稱</td>
</tr>
<tr>
<td align="left"><code>$Fields</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢的資料表欄位名稱</td>
</tr>
<tr>
<td align="left"><code>$FieldValuePairs</code></td>
<td align="left"><code>array</code></td>
<td align="left">待寫入的資料關聯陣列，鍵為資料表欄位名稱，值為欄位值，如 <code>['SERNO' =&gt; '123']</code></td>
</tr>
<tr>
<td align="left"><code>$ValueParams</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> 在 <code>$FieldValuePairs</code> 陣列的值的變數與值的關聯陣列</td>
</tr>
<tr>
<td align="left"><code>$RowCount</code></td>
<td align="left"><code>int</code></td>
<td align="left">上次執行的 SQL 語法影響的列數</td>
</tr>
<tr>
<td align="left"><code>$OrderBys</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢資料的排序依據的數值陣列，如 <code>['CreateDateTime desc']</code></td>
</tr>
<tr>
<td align="left"><code>$ConjWhere</code></td>
<td align="left"><code>array</code></td>
<td align="left">以 and 連接的查詢條件 (WHERE) 字串，如 <code>[&quot;(SERNO = '123')&quot;]</code></td>
</tr>
<tr>
<td align="left"><code>$DisjWhere</code></td>
<td align="left"><code>array</code></td>
<td align="left">以 or 連接的查詢條件 (WHERE) 字串，如 <code>[&quot;(SERNO = '123')&quot;]</code></td>
</tr>
<tr>
<td align="left"><code>$IsCache</code></td>
<td align="left"><code>bool</code></td>
<td align="left">資料來源是否為快取</td>
</tr>
<tr>
<td align="left"><code>$WhereParams</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> 條件式 (<code>$ConjWhere</code>, <code>$DisjWhere</code>) 的參數陣列，如 <code>['PMOID' =&gt; '123']</code></td>
</tr>
<tr>
<td align="left"><code>$JoinOns</code></td>
<td align="left"><code>array</code></td>
<td align="left">連接其他資料表的查詢條件 (JOIN) 字串，如 <code>[&quot;join UserAUT on UserAUT.UserID = User.UserID&quot;]</code></td>
</tr>
<tr>
<td align="left"><code>$JoinTables</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> 連接的資料表，如 <code>['UserAUT']</code></td>
</tr>
<tr>
<td align="left"><code>$GroupBys</code></td>
<td align="left"><code>array</code></td>
<td align="left">資料分組的依據欄位名稱，如 <code>['SERNO']</code></td>
</tr>
<tr>
<td align="left"><code>$ConjHaving</code></td>
<td align="left"><code>array</code></td>
<td align="left">以 and 連接的資料分組篩選條件 (HAVING) 字串，如 <code>[&quot;(sum(TotalPrice) &gt; '1000')&quot;]</code></td>
</tr>
<tr>
<td align="left"><code>$DisjHaving</code></td>
<td align="left"><code>array</code></td>
<td align="left">以 or 連接的資料分組篩選條件 (HAVING) 字串，如 <code>[&quot;(sum(TotalPrice) &gt; '1000')&quot;]</code></td>
</tr>
<tr>
<td align="left"><code>$LimitString</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料查詢的筆數限制及偏移量，如 <code>limit 10, 0</code></td>
</tr>
<tr>
<td align="left"><code>$CommandString</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>(protected)</strong> 自定義的 SQL 指令，當 <code>RenderSQL('_COMMAND')</code> 時，會優先使用此指令</td>
</tr>
<tr>
<td align="left"><code>$Error</code></td>
<td align="left"><code>\Exception</code></td>
<td align="left">紀錄物件方法執行中拋出的錯誤</td>
</tr>
<tr>
<td align="left"><code>$ErrorInfo</code></td>
<td align="left"><code>string</code></td>
<td align="left">紀錄物件方法執行中拋出的錯誤訊息</td>
</tr>
<tr>
<td align="left"><code>$State</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>(protected)</strong> 組合 SQL 指令的模式，如 _SELECT, _INSERT, _UPDATE, _DELETE, _COMMAND</td>
</tr>
<tr>
<td align="left"><code>$SQLString</code></td>
<td align="left"><code>string</code></td>
<td align="left">組合後的 SQL 指令</td>
</tr>
<tr>
<td align="left"><code>$SQLStatement</code></td>
<td align="left"><code>PDOStatement</code></td>
<td align="left">SQLStatement</td>
</tr>
</tbody>
</table>
<h2>51.2 __construct</h2>
<pre><code class="language-php">public function __construct($DBSLink, $DBS, $DBSTable)
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DBSLink</code></td>
<td align="left"><code>PDO</code></td>
<td align="left">資料庫連線物件 PDO</td>
</tr>
<tr>
<td align="left"><code>$DBS</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料庫名稱</td>
</tr>
<tr>
<td align="left"><code>$DBSTable</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料表名稱</td>
</tr>
</tbody>
</table>
<h2>51.3 AddSelect</h2>
<pre><code class="language-php">public function AddSelect($SelectField)
</code></pre>
<p>新增 SELECT 欄位<br />
當參數為關聯陣列 <code>[$Key =&gt; $Val]</code> 時，會將 <code>$Val</code> 視為欄位名稱，<code>$Key</code> 視為欄位別名</p>
<pre><code class="language-php">$DBSAction-&gt;AddSelect('UserID');  
$DBSAction-&gt;AddSelect(['SERNO','FullName']);  
</code></pre>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$SelectField</code></td>
<td align="left">`string</td>
<td align="left">array`</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 回傳物件目前的查詢欄位數值陣列</p>
<h2>51.4 AddPreSelect</h2>
<pre><code class="language-php">public function AddPreSelect($SelectField, $Parameters = [])
</code></pre>
<p>新增 SELECT 欄位 (包含變數)<br />
當參數為關聯陣列 <code>[$Key =&gt; $Val]</code> 時，會將 <code>$Val</code> 視為欄位名稱，<code>$Key</code> 視為欄位別名</p>
<pre><code class="language-php">$DBSAction-&gt;AddPreSelect(':id', ['id' =&gt; 'UserID']);  
$DBSAction-&gt;AddPreSelect(['SERNO',':name'], ['name' =&gt; 'FullName']);  
</code></pre>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$SelectField</code></td>
<td align="left">`string</td>
<td align="left">array`</td>
</tr>
<tr>
<td align="left"><code>$Parameters</code></td>
<td align="left"><code>array</code></td>
<td align="left">變數與值的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 回傳物件目前的查詢欄位數值陣列</p>
<h2>51.5 AddUpdate</h2>
<pre><code class="language-php">public function AddUpdate($UpdateField, $UpdateValue = '', $Quote = true)
</code></pre>
<p>新增 UPDATE 的欄位與值</p>
<pre><code class="language-php">$DBSAction-&gt;AddUpdate('LoginName', 'EPY001');  
$DBSAction-&gt;AddUpdate(['SERNO' =&gt; 'EPY001', 'FullName' =&gt; 'John Doe']);  
$DBSAction-&gt;AddUpdate('ModifyCNT', 'ModifyCNT + 1', false);  
</code></pre>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$UpdateField</code></td>
<td align="left">`string</td>
<td align="left">array`</td>
</tr>
<tr>
<td align="left"><code>$UpdateValue</code></td>
<td align="left"><code>string</code></td>
<td align="left">非必填，欄位的值，預設為空字串；若 $UpdateField 為 array 則此參數無效</td>
</tr>
<tr>
<td align="left"><code>$Quote</code></td>
<td align="left"><code>bool</code></td>
<td align="left">非必填，值是否加上引號，預設為 true</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 回傳欄位與值的關聯陣列</p>
<h2>51.6 AddPreUpdate</h2>
<pre><code class="language-php">public function AddPreUpdate($UpdateField, $UpdateValue = '', $Parameters = [])
</code></pre>
<p>新增 UPDATE 的欄位與值 (包含變數)</p>
<pre><code class="language-php">$DBSAction-&gt;AddPreUpdate('FullName', ':name', ['name' =&gt; 'John Doe']);  
$DBSAction-&gt;AddPreUpdate(['SERNO' =&gt; ':no', 'FullName' =&gt; ':name'], ['no' =&gt; 'EPY001', 'name' =&gt; 'John Doe']);  
</code></pre>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$UpdateField</code></td>
<td align="left">`string</td>
<td align="left">array`</td>
</tr>
<tr>
<td align="left"><code>$UpdateValue</code></td>
<td align="left">`string</td>
<td align="left">array`</td>
</tr>
<tr>
<td align="left"><code>$Parameters</code></td>
<td align="left"><code>array</code></td>
<td align="left">非必填，變數與值的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 回傳欄位與值的關聯陣列</p>
<h2>51.7 AddInsert</h2>
<pre><code class="language-php">public function AddInsert($InsertField, $InsertValue = '', $Quote = true)
</code></pre>
<p>新增 INSERT 的欄位與值</p>
<pre><code class="language-php">$DBSAction-&gt;AddInsert('LoginName', 'EPY001');  
$DBSAction-&gt;AddInsert(['SERNO' =&gt; 'EPY001', 'FullName' =&gt; 'John Doe']);  
</code></pre>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$InsertField</code></td>
<td align="left">`string</td>
<td align="left">array`</td>
</tr>
<tr>
<td align="left"><code>$InsertValue</code></td>
<td align="left"><code>string</code></td>
<td align="left">非必填，欄位的值，預設為空字串；當 $InsertField 為 array 時，此參數無效</td>
</tr>
<tr>
<td align="left"><code>$Quote</code></td>
<td align="left"><code>bool</code></td>
<td align="left">非必填，值是否加上引號，預設為 true</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 回傳欄位名稱與值的關聯陣列</p>
<h2>51.8 AddPreInsert</h2>
<pre><code class="language-php">public function AddPreInsert($InsertField, $InsertValue = '', $Parameters = [])
</code></pre>
<p>新增 INSERT 的欄位與值 (包含變數)</p>
<pre><code class="language-php">$DBSAction-&gt;AddPreInsert('FullName', ':name', ['name' =&gt; 'John Doe']);  
$DBSAction-&gt;AddPreInsert(['SERNO' =&gt; ':no', 'FullName' =&gt; ':name'], ['no' =&gt; 'EPY001', 'name' =&gt; 'John Doe']);  
</code></pre>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$InsertField</code></td>
<td align="left">`string</td>
<td align="left">array`</td>
</tr>
<tr>
<td align="left"><code>$InsertValue</code></td>
<td align="left">`string</td>
<td align="left">array`</td>
</tr>
<tr>
<td align="left"><code>$Parameters</code></td>
<td align="left"><code>array</code></td>
<td align="left">非必填，變數與值的映射</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 回傳欄位名稱與值的關聯陣列</p>
<h2>51.9 AddCommand</h2>
<pre><code class="language-php">public function AddCommand($CommandString)
</code></pre>
<p>直接寫入 SQL 指令</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$CommandString</code></td>
<td align="left"><code>string</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<h2>51.10 AddOrder</h2>
<pre><code class="language-php">public function AddOrder($OrderString, $Sort = &quot;asc&quot;)
</code></pre>
<p>新增排序依據 (ORDER BY)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$OrderString</code></td>
<td align="left"><code>string</code></td>
<td align="left">排序依據欄位</td>
</tr>
<tr>
<td align="left"><code>$Sort</code></td>
<td align="left"><code>string</code></td>
<td align="left">排序方式 ASC</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 回傳物件排序依據的陣列</p>
<h2>51.11 AddCondition</h2>
<pre><code class="language-php">public function AddCondition($Condition, $LogicOperator = &quot;&quot;)
</code></pre>
<p>新增查詢條件 (WHERE)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Condition</code></td>
<td align="left"><code>string</code></td>
<td align="left">條件式</td>
</tr>
<tr>
<td align="left"><code>$LogicOperator</code></td>
<td align="left"><code>string</code></td>
<td align="left">邏輯運算子 AND</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>51.12 AddPreCondition</h2>
<pre><code class="language-php">public function AddPreCondition($Condition, $Parameters = [], $LogicOperator = &quot;&quot;)
</code></pre>
<p>新增包含變數的查詢條件 (WHERE)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Condition</code></td>
<td align="left"><code>string</code></td>
<td align="left">條件式，包含變數如 <code>UserID = :ID</code></td>
</tr>
<tr>
<td align="left"><code>$Parameters</code></td>
<td align="left"><code>array</code></td>
<td align="left">變數與值的關聯陣列，如 ['ID' =&gt; '123']</td>
</tr>
<tr>
<td align="left"><code>$LogicOperator</code></td>
<td align="left"><code>string</code></td>
<td align="left">邏輯運算子 AND</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>51.13 AddJoinOn</h2>
<pre><code class="language-php">public function AddJoinOn($JoinTable, $OnCondition)
</code></pre>
<p>新增連接查詢條件 (JOIN ON)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$JoinTable</code></td>
<td align="left"><code>string</code></td>
<td align="left">連接的資料表名稱</td>
</tr>
<tr>
<td align="left"><code>$OnCondition</code></td>
<td align="left"><code>string</code></td>
<td align="left">連接條件式</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 回傳物件連接查詢條件的陣列</p>
<h2>51.14 AddGroupBy</h2>
<pre><code class="language-php">public function AddGroupBy($GroupByField)
</code></pre>
<p>新增資料分組查詢條件 (GROUP BY)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$GroupByField</code></td>
<td align="left"><code>string</code></td>
<td align="left">欄位名稱</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 回傳物件的 GROUP BY 陣列</p>
<h2>51.15 AddHaving</h2>
<pre><code class="language-php">public function AddHaving($Having, $LogicOperator = &quot;&quot;)
</code></pre>
<p>新增資料分組的篩選條件 (HAVING)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Having</code></td>
<td align="left"><code>string</code></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><code>$LogicOperator</code></td>
<td align="left"><code>string</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code></p>
<h2>51.16 AddLimit</h2>
<pre><code class="language-php">public function AddLimit($StartRecord = 0, $Records = 0)
</code></pre>
<p>新增查詢筆數限制及偏移量 (LIMIT, OFFSET)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$StartRecord</code></td>
<td align="left"><code>int</code></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><code>$Records</code></td>
<td align="left"><code>int</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>51.17 ClearSQL</h2>
<pre><code class="language-php">public function ClearSQL()
</code></pre>
<p>清空查詢條件、SQL語句、錯誤訊息</p>
<h2>51.18 MergeCondition(protected)</h2>
<pre><code class="language-php">protected function MergeCondition()
</code></pre>
<p>合併物件的 ConjWhere, DisjWhere 屬性為 <code>where...</code> 字串</p>
<p><strong>回傳</strong></p>
<p><code>string</code></p>
<h2>51.19 MergeHaving(protected)</h2>
<pre><code class="language-php">protected function MergeHaving()
</code></pre>
<p>合併物件的 ConjHaving, DisjHaving 屬性為 <code>having...</code> 字串</p>
<p><strong>回傳</strong></p>
<p><code>string</code></p>
<h2>51.20 RenderSQL</h2>
<pre><code class="language-php">public function RenderSQL($State)
</code></pre>
<p>組合 SQL 語句</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$State</code></td>
<td align="left"><code>string</code></td>
<td align="left">_SELECT</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code>|<code>false</code> 回傳 SQL 語句</p>
<h2>51.21 ExecuteCommand</h2>
<pre><code class="language-php">public function ExecuteCommand($SQLString, $CharSet = '', $UseCache = false)
</code></pre>
<p>執行 SQL 指令 (不參考物件的屬性，直接執行參數的 SQL 指令)<br />
SQL 指令不是 SELECT/SHOW 時，回傳成功與否的布林值</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$SQLString</code></td>
<td align="left"><code>string</code></td>
<td align="left">SQL 指令</td>
</tr>
<tr>
<td align="left"><code>$CharSet</code></td>
<td align="left"><code>string</code></td>
<td align="left">字元編碼，預設為空字串，也可指定為 UTF8</td>
</tr>
<tr>
<td align="left"><code>$UseCache</code></td>
<td align="left"><code>bool</code></td>
<td align="left">是否使用快取，預設為 false</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>mixed SQL 指令為 SELECT/SHOW 時，回傳查詢結果的陣列 (PDOStatement::fetchAll)，若無查詢結果，回傳 <code>false</code>；</p>
<h2>51.22 ExecuteSQL</h2>
<pre><code class="language-php">public function ExecuteSQL($UseCache = false, $CharSet = '')
</code></pre>
<p>執行 SQL 指令 (參考物件的屬性 $SQLString)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$UseCache</code></td>
<td align="left"><code>bool</code></td>
<td align="left">是否使用快取，預設為 false</td>
</tr>
<tr>
<td align="left"><code>$CharSet</code></td>
<td align="left"><code>string</code></td>
<td align="left">字元編碼，預設為空字串，也可指定為 UTF8</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>mixed 若 SQL 指令為 SELECT/SHOW，則回傳查詢結果的陣列 (PDOStatement::fetchAll)，否則回傳布林值</p>
<h2>51.23 Count</h2>
<pre><code class="language-php">public function Count($Debug = false)
</code></pre>
<p>Count</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Debug</code></td>
<td align="left"><code>bool</code></td>
<td align="left">是否只顯示 SQL 指令的組合結果而不執行，預設為 false</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>mixed 若 $Debug 為 <code>true</code>，則回傳 SQL 指令的字串；若執行失敗，則回傳 <code>false</code>；若執行成功，則回傳符合查詢條件的記錄數</p>
<h2>51.24 RowCount</h2>
<pre><code class="language-php">public function RowCount()
</code></pre>
<p>在執行過 ExecuteCommand, ExecuteSQL 之後呼叫此方法，取得 SQL 指令的執行影響列數</p>
<p><strong>回傳</strong></p>
<p><code>int</code>|<code>false</code> 執行成功回傳影響列數，執行失敗回傳 <code>false</code></p>
<h2>51.25 ShowDatabases</h2>
<pre><code class="language-php">public function ShowDatabases()
</code></pre>
<p>取得資料庫名稱的數值陣列</p>
<p><strong>回傳</strong></p>
<p><code>array</code> 資料庫名稱的數值陣列</p>
<h2>51.26 ShowTables</h2>
<pre><code class="language-php">public function ShowTables()
</code></pre>
<p>取得資料表名稱的數值陣列</p>
<p><strong>回傳</strong></p>
<p><code>array</code> 資料表名稱的數值陣列</p>
<h2>51.27 ShowColumns</h2>
<pre><code class="language-php">public function ShowColumns($DBSTable = null)
</code></pre>
<p>ShowColumns</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DBSTable</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料表名稱</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code> 資料表欄位名稱的數值陣列</p>
<h2>51.28 ShowPrimaryKey</h2>
<pre><code class="language-php">public function ShowPrimaryKey($DBSTable = null)
</code></pre>
<p>取得資料表指定欄位的資訊</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DBSTable</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料表名稱</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code> 資料表欄位名稱的數值陣列</p>
<h2>51.29 DBSSearch</h2>
<pre><code class="language-php">public function DBSSearch($R_Search_Array, $SchemaSearch_Array, $NotFlag = false)
</code></pre>
<p>解析 MISA.UI 用戶端回傳的搜尋條件，並將其轉換成 SQL 指令的條件</p>
<pre><code class="language-php">$SearchArray = [['equal' =&gt; ['_Name' =&gt; 'John']]];  
$SchemaSearchArray = ['_Name' =&gt; 'User.NickName'];  
$DBSAct = new DBSAct($Link, $DBS, 'User');  
$DBSAct-&gt;AddSelect('UserID');  
$DBSAct-&gt;AddSelect('NickName as _Name');  
$DBSAct-&gt;DBSSearch($SearchArray, $SchemaSearchArray);  
$DBSAct-&gt;RenderSQL('_SELECT');  
$Users = $DBSAct-&gt;ExecuteSQL();  
</code></pre>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$R_Search_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">搜尋條件的陣列</td>
</tr>
<tr>
<td align="left"><code>$SchemaSearch_Array</code></td>
<td align="left"><code>array</code></td>
<td align="left">搜尋條件的資料表欄位名稱與 Schema 欄位的映射陣列</td>
</tr>
<tr>
<td align="left"><code>$NotFlag</code></td>
<td align="left"><code>bool</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<h2>51.30 ReadCache</h2>
<pre><code class="language-php">public function ReadCache()
</code></pre>
<p>從 Redis 讀取快取資料</p>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 回傳查詢結果的陣列，若無查詢結果，回傳 <code>false</code></p>
<h2>51.31 WriteCache</h2>
<pre><code class="language-php">public function WriteCache($QueryResult)
</code></pre>
<p>將查詢結果寫入 Redis 快取</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$QueryResult</code></td>
<td align="left"><code>array</code></td>
<td align="left">查詢結果的陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 回傳是否寫入成功</p>
<h2>51.32 RemoveCache</h2>
<pre><code class="language-php">public function RemoveCache($Table)
</code></pre>
<p>從 Redis 移除快取資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Table</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料表名稱</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 回傳是否移除成功</p>
<h2>51.33 GetQueryTables(protected)</h2>
<pre><code class="language-php">protected function GetQueryTables()
</code></pre>
<p>取得當前查詢語句關聯的資料表數值陣列，如 <code>['User', 'UserAUT']</code></p>
<p><strong>回傳</strong></p>
<p><code>array</code> 資料表名稱的數值陣列</p>
<h2>51.34 ThrowError(protected)</h2>
<pre><code class="language-php">protected function ThrowError($Error, $ToThrow = true)
</code></pre>
<p>紀錄執行中的錯誤</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Error</code></td>
<td align="left">`string</td>
<td align="left">\Exception`</td>
</tr>
<tr>
<td align="left"><code>$ToThrow</code></td>
<td align="left"><code>bool</code></td>
<td align="left">紀錄結束後是否拋錯</td>
</tr>
</tbody>
</table>
<h1>52. DBSConsistency</h1>
<h2>52.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Map</code></td>
<td align="left"><code>array</code></td>
<td align="left">資料庫相互依存的關聯，在執行 DBSMOD::DBSDelete 時，會參考本陣列的資料，來決定要同步刪除或清除的資料表。</td>
</tr>
</tbody>
</table>
<h1>53. EZReceipt</h1>
<h2>53.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$isTest</code></td>
<td align="left"><code>bool</code></td>
<td align="left"><strong>(private)</strong> 是否測試版</td>
</tr>
<tr>
<td align="left"><code>$appName</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>(private)</strong> 主位址前</td>
</tr>
<tr>
<td align="left"><code>$appKey</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>(private)</strong> 程式金鑰</td>
</tr>
<tr>
<td align="left"><code>$accName</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>(private)</strong> 店家帳號</td>
</tr>
<tr>
<td align="left"><code>$accPws</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>(private)</strong> 店家密碼</td>
</tr>
<tr>
<td align="left"><code>$stID</code></td>
<td align="left"><code>string</code></td>
<td align="left">店家代號</td>
</tr>
</tbody>
</table>
<h2>53.2 __construct</h2>
<pre><code class="language-php">public function __construct($TradeSettings = null)
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$TradeSettings</code></td>
<td align="left"><code>ConfigTrade</code></td>
<td align="left">交易設定，將讀取其中的 Receipt 屬性</td>
</tr>
</tbody>
</table>
<h2>53.3 Request(private)</h2>
<pre><code class="language-php">private function Request()
</code></pre>
<p>取得易發票 API 的令牌</p>
<p><strong>回傳</strong></p>
<p><code>string</code> 若通過則回傳令牌</p>
<h2>53.4 GenEndPoint(private)</h2>
<pre><code class="language-php">private function GenEndPoint($ep)
</code></pre>
<p>從資源名稱產生完整 API 網址的方法</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ep</code></td>
<td align="left"><code>string</code></td>
<td align="left">API 資源名稱</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code> 完整 API 網址</p>
<h2>53.5 PostToEndpoint(private)</h2>
<pre><code class="language-php">private function PostToEndpoint($ep, $param, $token)
</code></pre>
<p>組成 HTTP 標頭，並呼叫易發票 API</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ep</code></td>
<td align="left"><code>string</code></td>
<td align="left">API 網址</td>
</tr>
<tr>
<td align="left"><code>$param</code></td>
<td align="left"><code>string</code></td>
<td align="left">傳送的參數 (JSON 格式)</td>
</tr>
<tr>
<td align="left"><code>$token</code></td>
<td align="left"><code>string</code></td>
<td align="left">存取令牌 (以 <code>EZReceipt::Login()</code> 取得)</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code> 易發票的回應 (JSON 格式)</p>
<h2>53.6 Login</h2>
<pre><code class="language-php">public function Login()
</code></pre>
<p>使用 <code>accName</code>, <code>accPws</code>, 以及 <code>EZReceipt::request()</code> 取得的令牌，呼叫易發票 API 取得存取令牌</p>
<p><strong>回傳</strong></p>
<p><code>string</code> 若通過則回傳存取令牌</p>
<h2>53.7 InvoiceCreate</h2>
<pre><code class="language-php">public function InvoiceCreate($data, $invB2who = INVOICE_BUYER_B2C)
</code></pre>
<p>建立新發票</p>
<pre><code class="language-php">$EZReceipt = new EZReceipt($TradeSettings);  
$data = array(  
    &quot;poNo&quot; =&gt; $SALODR_Data['SERNO'],  
    &quot;user&quot; =&gt; array(  
        &quot;accName&quot; =&gt; $User_Data['SERNO'],  
         &quot;email&quot; =&gt; $User_Data['EML1'],  
        &quot;name&quot; =&gt; $User_Data['FullName'],  
        &quot;phone&quot; =&gt; $User_Data['MobileTEL1'],  
        &quot;addr&quot; =&gt; &quot;&quot;  
    ),  
    &quot;carrierType&quot; =&gt; $R_Data['INVDMTCOMNO'] != &quot;&quot; ? 10 : 1, //1發票存入會員載具，10開立紙本證明(invNID、invTitle才有效)  
    &quot;mobileCode&quot; =&gt; &quot;&quot;,  
    &quot;delegateCode&quot; =&gt; &quot;&quot;,  
    &quot;donate&quot; =&gt; &quot;&quot;,  
    &quot;invNID&quot; =&gt; $R_Data['INVDMTCOMNO'],  
    &quot;invTitle&quot; =&gt; $R_Data['INVTitle'],  
    &quot;invAddr&quot; =&gt; $R_Data['INVStreetADR'],  
    &quot;invReceiver&quot; =&gt; $User_Data['FullName'],  
    &quot;invPhone&quot; =&gt; $User_Data['MobileTEL1'],  
    &quot;isCustom&quot; =&gt; 0,  
    &quot;cdc4&quot; =&gt; $this-&gt;ReadFlag($SALODR_Data['PayFlag'], 2) == &quot;C&quot; ? $SALODR_Data['CreditCardNO'] : &quot;&quot;,  
    &quot;remarks&quot; =&gt; &quot;&quot;,  
    &quot;prodList&quot; =&gt; array()  
);  
$EZReceipt-&gt;CreateInvoice($data);  
</code></pre>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$data</code></td>
<td align="left"><code>array</code></td>
<td align="left">交易資料</td>
</tr>
<tr>
<td align="left"><code>$invB2who</code></td>
<td align="left"><code>int</code></td>
<td align="left">買受人類別；<code>INVOICE_BUYER_B2C</code>: 買受人為自然人，<code>INVOICE_BUYER_B2B</code>: 買受人為公司</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code></p>
<h1>54. FileSet</h1>
<h2>54.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Set</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> FileSet 的結果</td>
</tr>
<tr>
<td align="left"><code>$ElementSchema</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> Set 中每個元素的格式標準 Schema&lt;br&gt;遵照 JSON Schema 規範 <a href="https://json-schema.org/draft/2020-12/json-schema-core.html">https://json-schema.org/draft/2020-12/json-schema-core.html</a></td>
</tr>
<tr>
<td align="left"><code>$MaxSize</code></td>
<td align="left"><code>int</code></td>
<td align="left">檔案大小的上限</td>
</tr>
<tr>
<td align="left"><code>$Error</code></td>
<td align="left"><code>\Exception</code></td>
<td align="left">收集類別方法執行中發生的錯誤</td>
</tr>
</tbody>
</table>
<h2>54.2 __construct</h2>
<pre><code class="language-php">public function __construct($Set = [])
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Set</code></td>
<td align="left">`array</td>
<td align="left">string`</td>
</tr>
</tbody>
</table>
<h2>54.3 ValidateLoop(protected)</h2>
<pre><code class="language-php">protected function ValidateLoop($Element, $Schema)
</code></pre>
<p><code>ValidateElement</code> 驗證資料時呼叫的遞迴方法</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Element</code></td>
<td align="left"><code>array</code></td>
<td align="left">待驗證的子陣列</td>
</tr>
<tr>
<td align="left"><code>$Schema</code></td>
<td align="left"><code>array</code></td>
<td align="left">子陣列的格式標準</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 若通過驗證則回傳 <code>true</code>，反之則回傳 <code>false</code></p>
<h2>54.4 ValidateElement</h2>
<pre><code class="language-php">public function ValidateElement($Element)
</code></pre>
<p>驗證傳入的陣列格式是否符合格式標準 <code>$ElementSchema</code></p>
<pre><code class="language-php">$File = $PDTIFO['FileSet'][0];  
$FileSet = new FileSet();  
echo $FileSet-&gt;ValidateElement($File) ? 'pass validation' : 'fail validation';  
</code></pre>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Element</code></td>
<td align="left"><code>array</code></td>
<td align="left">待驗證的 $Set 的元素</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 若通過驗證則回傳 <code>true</code>，反之則回傳 <code>false</code></p>
<h2>54.5 Get</h2>
<pre><code class="language-php">public function Get()
</code></pre>
<p>取得屬性 $Set</p>
<p><strong>回傳</strong></p>
<p><code>array</code> 回傳類別目前的 FileSet 結果</p>
<h2>54.6 Set</h2>
<pre><code class="language-php">public function Set($Set)
</code></pre>
<p>寫入屬性 $Set</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Set</code></td>
<td align="left">`array</td>
<td align="left">string`</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>54.7 GetElementSchema</h2>
<pre><code class="language-php">public function GetElementSchema()
</code></pre>
<p>取得屬性 $ElementSchema 元素格式標準</p>
<p><strong>回傳</strong></p>
<p><code>array</code> 回傳類別的元素格式標準 (JSON Schema)</p>
<h2>54.8 Append</h2>
<pre><code class="language-php">public function Append($Src, $Ext, $IsRemote = false, $Title = &quot;&quot;, $Alt = &quot;&quot;, $FileID = &quot;&quot;)
</code></pre>
<p>在 FileSet 新增元素，若新增的檔案儲存在本機上，則會重新命名並遷移到 <code>$GLOBALS['MISASiteSetting']['DIRPath']</code></p>
<pre><code class="language-php">//新增本機檔案到 FileSet  
$FileSet = new FileSet($PDTIFO['FileSet']);  
$Appended = $FileSet-&gt;Append($_FILES['R_UploadFile']['tmp_name'], 'pdf', false, $R_Data['FileTitle'], $R_Data['FileAlt'], '');  
print_r($Appended);  
// Array  
// (  
//     [Directory] =&gt; 20211125  
//     [FileID] =&gt;  
//     [Origin] =&gt; Array  
//         (  
//             [FileName] =&gt; 20211125xjduah3e.pdf  
//             [URL] =&gt;  
//             [Title] =&gt; 說明手冊  
//             [Alt] =&gt; 若無法取得說明手冊，請來電詢問  
//         )  
// )  
</code></pre>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Src</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案在本機的路徑或遠端連結位址</td>
</tr>
<tr>
<td align="left"><code>$Ext</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案類型名稱</td>
</tr>
<tr>
<td align="left"><code>$IsRemote</code></td>
<td align="left"><code>bool</code></td>
<td align="left">檔案來源是遠端連結位址(true)或是本機路徑(false)</td>
</tr>
<tr>
<td align="left"><code>$Title</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案標題</td>
</tr>
<tr>
<td align="left"><code>$Alt</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案替代文字，當介面無法顯示檔案時的替代顯示文字</td>
</tr>
<tr>
<td align="left"><code>$FileID</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案在 File 資料表的 FileID，當此值不為空值時，將以遠端連結位址的方式處理</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 回傳新增的元素</p>
<h2>54.9 AppendExist</h2>
<pre><code class="language-php">public function AppendExist($Path, $Title = &quot;&quot;, $Alt = &quot;&quot;, $FileID = &quot;&quot;)
</code></pre>
<p>在 FileSet 新增元素，目標檔案已儲存於本機上，不同於 <code>FileSet::Append</code>，此方法不會變更檔案的位置或檔案名稱</p>
<pre><code class="language-php">//新增本機檔案到 FileSet  
$LocalFilePath = '/var/www/project_name/site/data/cht/20220805/20220805xjduah3e.pdf';  
$FileSet = new FileSet($PDTIFO['FileSet']);  
$Appended = $FileSet-&gt;AppendExist($LocalFilePath, '說明手冊', '若無法取得說明手冊，請來電詢問', '');  
print_r($Appended);  
// Array  
// (  
//     [Directory] =&gt; 20220805  
//     [FileID] =&gt;  
//     [Origin] =&gt; Array  
//         (  
//             [FileName] =&gt; 20220805xjduah3e.pdf  
//             [URL] =&gt;  
//             [Title] =&gt; 說明手冊  
//             [Alt] =&gt; 若無法取得說明手冊，請來電詢問  
//         )  
// )  
</code></pre>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Path</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案在本機的路徑</td>
</tr>
<tr>
<td align="left"><code>$Title</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案標題</td>
</tr>
<tr>
<td align="left"><code>$Alt</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案替代文字，當介面無法顯示檔案時的替代顯示文字</td>
</tr>
<tr>
<td align="left"><code>$FileID</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案在 File 資料表的 FileID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 回傳新增的元素</p>
<h2>54.10 Remove</h2>
<pre><code class="language-php">public function Remove($Index, $DeleteFile = true)
</code></pre>
<p>在 FileSet 移除元素，若移除的檔案儲存在本機上，則一併刪除</p>
<pre><code class="language-php">//從 FileSet 中移除名稱為 '20211125xjduah3e.pdf' 的檔案  
$FileSet = new FileSet($PDTIFO['FileSet']);  
$Set = $FileSet-&gt;Get();  
for ($i = 0; $i &lt; count($Set); $i++) {  
  if ($Set[$i]['Origin']['FileName'] == '20211125xjduah3e.pdf') {  
    $Removed = $FileSet-&gt;Remove($i);  
    break;  
  }  
}  
print_r($Removed);  
// Array  
// (  
//     [Directory] =&gt; 20211125  
//     [FileID] =&gt; 0sh5rrx3hjsfrn4d  
//     [Origin] =&gt; Array  
//         (  
//             [FileName] =&gt; 20211125xjduah3e.pdf  
//             [URL] =&gt;  
//             [Title] =&gt; 說明手冊  
//             [Alt] =&gt; 若無法取得說明手冊，請來電詢問  
//         )  
// )  
</code></pre>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Index</code></td>
<td align="left"><code>int</code></td>
<td align="left">待移除的元素索引</td>
</tr>
<tr>
<td align="left"><code>$DeleteFile</code></td>
<td align="left"><code>bool</code></td>
<td align="left">此值為真時，刪除檔案</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code> 回傳刪除的元素</p>
<h2>54.11 GetURLs</h2>
<pre><code class="language-php">public function GetURLs($Size = 'Origin')
</code></pre>
<p>將屬性 $Set 轉換為檔案位址字串的陣列</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Size</code></td>
<td align="left"><code>string</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code> 檔案位址字串的數值陣列</p>
<h2>54.12 HandleUpload</h2>
<pre><code class="language-php">public function HandleUpload($Src, $Ext, $DestRootDIR)
</code></pre>
<p>搬移並重新命名檔案到指定的根目錄，回傳包含檔案名稱及所在資料夾路徑的陣列；<br />
會在根目錄下建立 <code>yyyymmdd</code> 的目錄</p>
<pre><code class="language-php">$FileSet = new FileSet();  
$Result = $FileSet-&gt;HandleUpload(  
    $_FILES['_UploadFiles']['tmp_name'][$i]['_FileBinary'][0],  
    array_pop(explode('.', $_FILES['_UploadFiles']['name'][$i]['_FileBinary'][0])),  
    $GLOBALS['MISASiteSetting']['DIRPath'],  
);  
print_r($Result);  
// Array  
// (  
//     [FileName] =&gt; 20211125xjduah3e.pdf  
//     [Directory] =&gt; 20211125  
//     [FullPath] =&gt; /var/www/project_name/site/data/cht/20211125/20211125xjduah3e.pdf  
// )  
</code></pre>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Src</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案在本機的絕對路徑</td>
</tr>
<tr>
<td align="left"><code>$Ext</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案類型名稱</td>
</tr>
<tr>
<td align="left"><code>$DestRootDIR</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案的目標根目錄絕對路徑</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 檔案搬移成功後，回傳包含 FileName</p>
<h1>55. Notice</h1>
<h2>55.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Method</code></td>
<td align="left"><code>int</code></td>
<td align="left"><strong>(protected)</strong> 通知發送的途徑</td>
</tr>
<tr>
<td align="left"><code>$Subject</code></td>
<td align="left"><code>string</code></td>
<td align="left">通知的主旨</td>
</tr>
<tr>
<td align="left"><code>$Detail</code></td>
<td align="left"><code>string</code></td>
<td align="left">通知的主要訊息內容</td>
</tr>
<tr>
<td align="left"><code>$AttachmentPath</code></td>
<td align="left"><code>string</code></td>
<td align="left">通知的附加檔案</td>
</tr>
<tr>
<td align="left"><code>$ServiceMail</code></td>
<td align="left"><code>string</code></td>
<td align="left">信件通知: 寄件人</td>
</tr>
<tr>
<td align="left"><code>$Title</code></td>
<td align="left"><code>string</code></td>
<td align="left">信件通知: 信件標題</td>
</tr>
<tr>
<td align="left"><code>$SMTPConfig</code></td>
<td align="left"><code>ConfigSMTP</code></td>
<td align="left">信件通知: 郵件伺服器的設定物件</td>
</tr>
<tr>
<td align="left"><code>$SMSConfig</code></td>
<td align="left"><code>ConfigSMS</code></td>
<td align="left">手機簡訊通知: 簡訊服務商資訊的設定物件</td>
</tr>
<tr>
<td align="left"><code>$Error</code></td>
<td align="left"><code>\Exception</code></td>
<td align="left">Error</td>
</tr>
</tbody>
</table>
<h2>55.2 __construct</h2>
<pre><code class="language-php">public function __construct($Method = NOTICE_EMAIL, $Settings)
</code></pre>
<p>建構子<br />
發送信件的範例</p>
<pre><code class="language-php">//設定 SMTP 初始化  
$SMTPConfig = new ConfigSMTP(  
  'smtp.gmail.com',  
  'mailtest',  
  '40808532',  
  'service@misa.com.tw',  
  'MISA-NO-REPLY'  
);  
//設定信件服務位址  
$SMTPConfig-&gt;SetMailService(  
  'GCE_Send_Email_g1',  
  '45f4f9c8c911bc4705c2bf16e6899ef2',  
  'https://mr.misa.com.tw/misa-mail/api/',  
  true                                       //加入佇列，若為 false 則立即發送  
);  
//通知內容樣板  
$TPLDOC = file_get_contents($FilePath, true);  
//接收通知用戶資訊  
$User = [  
    'EML1' =&gt; 'fido@gmail.com',  
    'NickName' =&gt; 'Frank'  
];  
$Notice = new Notice(NOTICE_EMAIL, $SMTPConfig);        //建構物件  
$Notice-&gt;Subject = &quot;You've logged in on new device&quot;;    //設定信件主旨  
$Notice-&gt;SetDetailFromDOC($TPLDOC, $User);              //設定信件通知內容  
$R_Mail = $Notice-&gt;Send($User['EML1']);                 //發送信件通知  
echo $R_Mail ? 'sent successfully' : 'failed to send';  
</code></pre>
<p>發送簡訊的範例</p>
<pre><code class="language-php">//設定簡訊服務商資訊  
$SMSConfig = new ConfigSMS(  
  'admin@dearsoft.com',  
  'adminpassword',  
  'https://msg.mitake.com/b2c/mtk/SmSend'  
);  
//通知內容樣板  
$TPLDOC = file_get_contents($FilePath, true);  
//接收通知用戶資訊  
$User = [  
    'MobileTEL1' =&gt; '0987123456',  
    'NickName' =&gt; 'Frank'  
];  
$Notice = new Notice(NOTICE_MOBILE, $SMSConfig);        //建構物件  
$Notice-&gt;SetDetailFromDOC($TPLDOC, $User);              //設定簡訊通知內容  
$R_SMS = $Notice-&gt;Send($User['MobileTEL1']);            //發送簡訊通知  
echo $R_SMS ? 'sent successfully' : 'failed to send';  
</code></pre>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Method</code></td>
<td align="left"><code>int</code></td>
<td align="left">發送途徑，可能的值: <code>NOTICE_EMAIL</code>, <code>NOTICE_MOBILE</code>, <code>NOTICE_FCM</code></td>
</tr>
<tr>
<td align="left"><code>$Settings</code></td>
<td align="left"><code>Config</code></td>
<td align="left">發送服務供應者的設定，依照發送途徑而不同</td>
</tr>
</tbody>
</table>
<h2>55.3 ReplaceDOC(protected)</h2>
<pre><code class="language-php">protected function ReplaceDOC($DOC, $ReplaceArray)
</code></pre>
<p>替換文件範本中的待替換文字；<br />
待替換的文字在文件中如 <code>{{ToBeReplaced}}</code></p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DOC</code></td>
<td align="left"><code>string</code></td>
<td align="left">文件範本</td>
</tr>
<tr>
<td align="left"><code>$ReplaceArray</code></td>
<td align="left"><code>array</code></td>
<td align="left">待替換字串的關聯陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code> 回傳替換完畢的文件字串</p>
<h2>55.4 SetDetailFromDOC</h2>
<pre><code class="language-php">public function SetDetailFromDOC($TPLDOC, $ReplaceArray = array())
</code></pre>
<p>替換文件範本，並將其設定為通知內容</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$TPLDOC</code></td>
<td align="left"><code>string</code></td>
<td align="left">文件範本</td>
</tr>
<tr>
<td align="left"><code>$ReplaceArray</code></td>
<td align="left"><code>array</code></td>
<td align="left">待替換字串的關聯陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code> 回傳物件屬性 <code>$Detail</code></p>
<h2>55.5 SetSubjectFromDOC</h2>
<pre><code class="language-php">public function SetSubjectFromDOC($TPLDOC, $ReplaceArray = array())
</code></pre>
<p>替換文件範本，並將其設定為通知主旨</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$TPLDOC</code></td>
<td align="left"><code>string</code></td>
<td align="left">文件範本</td>
</tr>
<tr>
<td align="left"><code>$ReplaceArray</code></td>
<td align="left"><code>array</code></td>
<td align="left">待替換字串的關聯陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code> 回傳物件屬性 <code>$Subject</code></p>
<h2>55.6 Send</h2>
<pre><code class="language-php">public function Send($Recipient)
</code></pre>
<p>發送通知</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Recipient</code></td>
<td align="left"><code>string</code></td>
<td align="left">收件人資訊，如電子信箱或手機號碼</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 若成功發送即回傳 <code>true</code>，反之則回傳 <code>false</code></p>
<h2>55.7 SendEmail(protected)</h2>
<pre><code class="language-php">protected function SendEmail($Email)
</code></pre>
<p>發送通知信件</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Email</code></td>
<td align="left"><code>string</code></td>
<td align="left">收件人的電子信箱</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 若成功發送即回傳 <code>true</code>，反之則回傳 <code>false</code></p>
<h2>55.8 SendSMS(protected)</h2>
<pre><code class="language-php">protected function SendSMS($MobileTEL)
</code></pre>
<p>發送 SMS</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$MobileTEL</code></td>
<td align="left"><code>string</code></td>
<td align="left">收件人的手機號碼</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 若成功發送即回傳 <code>true</code>，反之則回傳 <code>false</code></p>
<h2>55.9 SendMailByProxy</h2>
<pre><code class="language-php">public function SendMailByProxy($Mail)
</code></pre>
<p>發送信件：加入郵件伺服器的待送郵件佇列</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Mail</code></td>
<td align="left"><code>MailEntity</code></td>
<td align="left">信件物件</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code> 回傳信件發送結果</p>
<h2>55.10 SendMailByService</h2>
<pre><code class="language-php">public function SendMailByService($Mail)
</code></pre>
<p>[Deprecated] 發送信件：加入郵件伺服器的待送郵件佇列</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Mail</code></td>
<td align="left"><code>MailEntity</code></td>
<td align="left">信件物件</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code> 回傳信件發送結果</p>
<h1>56. PICSet extends FileSet</h1>
<h2>56.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ElementSchema</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> Set 中每個元素的格式標準 Schema&lt;br&gt;遵照 JSON Schema 規範 <a href="https://json-schema.org/draft/2020-12/json-schema-core.html">https://json-schema.org/draft/2020-12/json-schema-core.html</a></td>
</tr>
<tr>
<td align="left"><code>$MaxWidth</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>(protected)</strong> 各尺寸圖片的最大長寬</td>
</tr>
</tbody>
</table>
<h2>56.2 Append</h2>
<pre><code class="language-php">public function Append($Src, $Ext, $IsRemote = false, $Title = &quot;&quot;, $Alt = &quot;&quot;, $FileID = &quot;&quot;)
</code></pre>
<p>加入元素並新增對應的本機檔案</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Src</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案在本機的路徑或遠端連結位址</td>
</tr>
<tr>
<td align="left"><code>$Ext</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案類型名稱</td>
</tr>
<tr>
<td align="left"><code>$IsRemote</code></td>
<td align="left"><code>bool</code></td>
<td align="left">檔案來源是遠端連結位址(true)或是本機路徑(false)</td>
</tr>
<tr>
<td align="left"><code>$Title</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案標題</td>
</tr>
<tr>
<td align="left"><code>$Alt</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案替代文字，當介面無法顯示檔案時的替代顯示文字</td>
</tr>
<tr>
<td align="left"><code>$FileID</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案在 File 資料表的 FileID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 回傳符合 ElementSchema 格式的陣列</p>
<h2>56.3 AppendExist</h2>
<pre><code class="language-php">public function AppendExist($Path, $Title = &quot;&quot;, $Alt = &quot;&quot;, $FileID = &quot;&quot;)
</code></pre>
<p>加入元素，目標圖片已儲存於本機上；並檢查不同尺寸的圖片檔案是否已儲存於本機，若本機無對應尺寸的檔案則新建；不同於 <code>PICSet::Append</code>，此方法不會變更檔案的位置或檔案名稱</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Path</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案在本機的路徑</td>
</tr>
<tr>
<td align="left"><code>$Title</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案標題</td>
</tr>
<tr>
<td align="left"><code>$Alt</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案替代文字，當介面無法顯示檔案時的替代顯示文字</td>
</tr>
<tr>
<td align="left"><code>$FileID</code></td>
<td align="left"><code>string</code></td>
<td align="left">檔案在 File 資料表的 FileID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 回傳新增的元素</p>
<h2>56.4 CopyResizeImage(protected)</h2>
<pre><code class="language-php">protected function CopyResizeImage($Src, $Dest, $MaxWidth, $MaxHeight, $Quality)
</code></pre>
<p>複製並壓縮圖片</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Src</code></td>
<td align="left"><code>string</code></td>
<td align="left">原始圖片檔案路徑</td>
</tr>
<tr>
<td align="left"><code>$Dest</code></td>
<td align="left"><code>string</code></td>
<td align="left">目標檔案路徑</td>
</tr>
<tr>
<td align="left"><code>$MaxWidth</code></td>
<td align="left"><code>int</code></td>
<td align="left">圖片最大寬度</td>
</tr>
<tr>
<td align="left"><code>$MaxHeight</code></td>
<td align="left"><code>int</code></td>
<td align="left">圖片最大高度</td>
</tr>
<tr>
<td align="left"><code>$Quality</code></td>
<td align="left"><code>int</code></td>
<td align="left">圖片壓縮品質</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>56.5 GetMaxWidth</h2>
<pre><code class="language-php">public function GetMaxWidth()
</code></pre>
<p>取得屬性 MaxWidth</p>
<h2>56.6 SetMaxWidth</h2>
<pre><code class="language-php">public function SetMaxWidth($MaxWidth)
</code></pre>
<p>設定屬性 MaxWidth</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$MaxWidth</code></td>
<td align="left"><code>mixed</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<h1>57. RedisAction</h1>
<h2>57.1 Properties</h2>
<table>
<thead>
<tr>
<th align="left">Prop</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Link</code></td>
<td align="left"><code>\Predis\Client</code></td>
<td align="left">Redis 資料庫驅動</td>
</tr>
<tr>
<td align="left"><code>$Error</code></td>
<td align="left"><code>\Exception</code></td>
<td align="left">錯誤訊息</td>
</tr>
<tr>
<td align="left"><code>$ErrorInfo</code></td>
<td align="left"><code>string</code></td>
<td align="left">錯誤訊息 (字串型別)</td>
</tr>
<tr>
<td align="left"><code>$DBSTable</code></td>
<td align="left"><code>string</code></td>
<td align="left">當前操作的資料表名稱</td>
</tr>
</tbody>
</table>
<h2>57.2 __construct</h2>
<pre><code class="language-php">public function __construct($Link, $DBSTable)
</code></pre>
<p>建構子</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Link</code></td>
<td align="left"><code>\Predis\Client</code></td>
<td align="left">Redis 資料庫驅動</td>
</tr>
<tr>
<td align="left"><code>$DBSTable</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料表名稱</td>
</tr>
</tbody>
</table>
<h2>57.3 FromConnection(static)</h2>
<pre><code class="language-php">static public function FromConnection($DBSTable, $Host, $Password = '', $Port = 6379)
</code></pre>
<p>從 Redis 連線資訊建立 RedisAction 物件</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DBSTable</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料表名稱</td>
</tr>
<tr>
<td align="left"><code>$Host</code></td>
<td align="left"><code>string</code></td>
<td align="left">Redis 伺服器位址</td>
</tr>
<tr>
<td align="left"><code>$Password</code></td>
<td align="left"><code>string</code></td>
<td align="left">Redis 伺服器密碼，無密碼時請傳入空字串</td>
</tr>
<tr>
<td align="left"><code>$Port</code></td>
<td align="left"><code>int</code></td>
<td align="left">Redis 伺服器埠號，預設為 <code>6379</code></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>RedisAction</p>
<h2>57.4 GetKey(protected)</h2>
<pre><code class="language-php">protected function GetKey($ID)
</code></pre>
<p>取得資料庫中的鍵</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料的 ID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code>|<code>false</code> 資料庫的鍵</p>
<h2>57.5 SetError(protected)</h2>
<pre><code class="language-php">protected function SetError($Message)
</code></pre>
<p>設定錯誤訊息</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Message</code></td>
<td align="left"><code>string</code></td>
<td align="left">錯誤訊息</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>RedisAction</p>
<h2>57.6 Set</h2>
<pre><code class="language-php">public function Set($ID, $Value)
</code></pre>
<p>寫入資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料的 ID</td>
</tr>
<tr>
<td align="left"><code>$Value</code></td>
<td align="left"><code>mixed</code></td>
<td align="left">資料的值</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 是否寫入成功</p>
<h2>57.7 Get</h2>
<pre><code class="language-php">public function Get($ID)
</code></pre>
<p>讀取資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料的 ID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>mixed 資料的值</p>
<h2>57.8 Delete</h2>
<pre><code class="language-php">public function Delete($ID)
</code></pre>
<p>刪除資料</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料的 ID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>int</code></p>
<h2>57.9 Exists</h2>
<pre><code class="language-php">public function Exists($ID)
</code></pre>
<p>查詢資料是否存在</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料的 ID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 存在時回傳 <code>true</code>，不存在時回傳 <code>false</code></p>
<h2>57.10 Expire</h2>
<pre><code class="language-php">public function Expire($ID, $Seconds = 86400)
</code></pre>
<p>設定資料的過期時間，舉例來說，如果你希望資料在 1 小時後過期，則可以使用以下的程式碼：</p>
<pre><code class="language-php">$Redis-&gt;Expire('data-id', 3600);  
</code></pre>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料的 ID</td>
</tr>
<tr>
<td align="left"><code>$Seconds</code></td>
<td align="left"><code>int</code></td>
<td align="left">過期時間，單位為秒，預設為 1 天</td>
</tr>
</tbody>
</table>
<h2>57.11 Ping</h2>
<pre><code class="language-php">public function Ping()
</code></pre>
<p>測試是否連線成功</p>
<h2>57.12 GetType</h2>
<pre><code class="language-php">public function GetType($ID)
</code></pre>
<p>取得資料的類型</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料的 ID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code>|<code>false</code></p>
<h2>57.13 ListPush</h2>
<pre><code class="language-php">public function ListPush($ID, $Value)
</code></pre>
<p>新增元素到指定的陣列中，若陣列不存在則會自動建立</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料的 ID</td>
</tr>
<tr>
<td align="left"><code>$Value</code></td>
<td align="left">`array</td>
<td align="left">string`</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>int</code>|<code>false</code> 新增的元素數量</p>
<h2>57.14 ListGet</h2>
<pre><code class="language-php">public function ListGet($ID, $Start, $End = 100)
</code></pre>
<p>取得陣列中的元素</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料的 ID</td>
</tr>
<tr>
<td align="left"><code>$Start</code></td>
<td align="left"><code>int</code></td>
<td align="left">起始位置</td>
</tr>
<tr>
<td align="left"><code>$End</code></td>
<td align="left"><code>int</code></td>
<td align="left">結束位置，預設為 100</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 陣列中的元素</p>
<h2>57.15 ListRemove</h2>
<pre><code class="language-php">public function ListRemove($ID, $Value)
</code></pre>
<p>從陣列中刪除指定的元素</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料的 ID</td>
</tr>
<tr>
<td align="left"><code>$Value</code></td>
<td align="left"><code>string</code></td>
<td align="left">要刪除的元素</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>int</code>|<code>false</code> 刪除的元素數量</p>
<h2>57.16 SetGet</h2>
<pre><code class="language-php">public function SetGet($ID)
</code></pre>
<p>取得集合中的所有元素</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料的 ID</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 集合中的所有元素</p>
<h2>57.17 SetAdd</h2>
<pre><code class="language-php">public function SetAdd($ID, $Value)
</code></pre>
<p>新增元素到集合中</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料的 ID</td>
</tr>
<tr>
<td align="left"><code>$Value</code></td>
<td align="left">`array</td>
<td align="left">string`</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>int</code>|<code>false</code> 新增的元素數量</p>
<h2>57.18 SetRemove</h2>
<pre><code class="language-php">public function SetRemove($ID, $Value)
</code></pre>
<p>從集合中刪除指定的元素</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料的 ID</td>
</tr>
<tr>
<td align="left"><code>$Value</code></td>
<td align="left">`array</td>
<td align="left">string`</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>int</code>|<code>false</code> 刪除的元素數量</p>
<h2>57.19 SetExists</h2>
<pre><code class="language-php">public function SetExists($ID, $Value)
</code></pre>
<p>測試指定的元素是否存在於集合中</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$ID</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料的 ID</td>
</tr>
<tr>
<td align="left"><code>$Value</code></td>
<td align="left"><code>string</code></td>
<td align="left">要測試的元素</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 存在時回傳 <code>true</code>，不存在時回傳 <code>false</code></p>
<h1>58. Utility</h1>
<h2>58.1 DebugPrint(static)</h2>
<pre><code class="language-php">static public function DebugPrint($Message = '')
</code></pre>
<p>偵測當前網域，若為測試環境則輸出訊息</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Message</code></td>
<td align="left"><code>mixed</code></td>
<td align="left">待輸出訊息</td>
</tr>
</tbody>
</table>
<h2>58.2 DebugShow(static)</h2>
<pre><code class="language-php">static public function DebugShow()
</code></pre>
<p>偵測當前網域是否為測試環境</p>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>58.3 GetDBSID(static)</h2>
<pre><code class="language-php">static public function GetDBSID()
</code></pre>
<p>產生隨機字串作為資料庫的 UID</p>
<p><strong>回傳</strong></p>
<p><code>string</code> 產生的隨機字串</p>
<h2>58.4 GetDBSSERNO(static)</h2>
<pre><code class="language-php">static public function GetDBSSERNO($Type, $Link, $DBS, $DBSTable, $DBSField, $Prefix = '', $Format = &quot;%05d&quot;)
</code></pre>
<p>產生隨機序號，不與指定的資料表既有資料重複</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Type</code></td>
<td align="left"><code>string</code></td>
<td align="left">序號產生的機制，可能的值為: _STEP</td>
</tr>
<tr>
<td align="left"><code>$Link</code></td>
<td align="left"><code>\PDO</code></td>
<td align="left">資料庫連線</td>
</tr>
<tr>
<td align="left"><code>$DBS</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料庫名稱</td>
</tr>
<tr>
<td align="left"><code>$DBSTable</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料表名稱</td>
</tr>
<tr>
<td align="left"><code>$DBSField</code></td>
<td align="left"><code>string</code></td>
<td align="left">資料表欄位名稱</td>
</tr>
<tr>
<td align="left"><code>$Prefix</code></td>
<td align="left"><code>string</code></td>
<td align="left">序號前綴，預設為空字串</td>
</tr>
<tr>
<td align="left"><code>$Format</code></td>
<td align="left"><code>string</code></td>
<td align="left">序號格式，預設為 %05d</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code> 產生的序號</p>
<h2>58.5 GetRandom36(static)</h2>
<pre><code class="language-php">static public function GetRandom36($Length)
</code></pre>
<p>產生指定長度的隨機字串 (36進位)</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Length</code></td>
<td align="left"><code>int</code></td>
<td align="left">隨機字串長度</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code> 產生的隨機字串</p>
<h2>58.6 ValidateEmail(static)</h2>
<pre><code class="language-php">static public function ValidateEmail($Email)
</code></pre>
<p>驗證字串是否為有效的 Email 格式</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Email</code></td>
<td align="left"><code>string</code></td>
<td align="left">待驗證的 Email</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 是否為有效的 Email 格式</p>
<h2>58.7 ValidateNationalID(static)</h2>
<pre><code class="language-php">static public function ValidateNationalID($NationalID)
</code></pre>
<p>驗證字串是否為有效的中華民國身分證字號格式</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$NationalID</code></td>
<td align="left"><code>string</code></td>
<td align="left">待驗證的身分證字號</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code> 是否為有效的身分證字號</p>
<h2>58.8 LinkURL(static)</h2>
<pre><code class="language-php">static public function LinkURL($URL = '', $Message = '', $ReplaceParent = false)
</code></pre>
<p>輸出轉頁至其他頁面的 HTML 碼，轉頁前彈出提示訊息</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$URL</code></td>
<td align="left"><code>string</code></td>
<td align="left">轉頁目標的 URL，若為空則轉頁至上一頁</td>
</tr>
<tr>
<td align="left"><code>$Message</code></td>
<td align="left"><code>string</code></td>
<td align="left">轉頁前彈出的訊息，若為空則不彈出訊息</td>
</tr>
<tr>
<td align="left"><code>$ReplaceParent</code></td>
<td align="left"><code>string</code></td>
<td align="left">轉頁的範圍是否為父視窗 (window.parent)，預設為否 (window)</td>
</tr>
</tbody>
</table>
<h2>58.9 LinkURLSwal(static)</h2>
<pre><code class="language-php">static public function LinkURLSwal($URL = '', $Message = '', $ReplaceParent = false)
</code></pre>
<p>輸出轉頁至其他頁面的 HTML 碼，轉頁前彈出 SweetAlert2 的提示訊息</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$URL</code></td>
<td align="left"><code>string</code></td>
<td align="left">轉頁目標的 URL，若為空則轉頁至上一頁</td>
</tr>
<tr>
<td align="left"><code>$Message</code></td>
<td align="left"><code>string</code></td>
<td align="left">轉頁前彈出的訊息，若為空則不彈出訊息</td>
</tr>
<tr>
<td align="left"><code>$ReplaceParent</code></td>
<td align="left"><code>string</code></td>
<td align="left">轉頁的範圍是否為父視窗 (window.parent)，預設為否</td>
</tr>
</tbody>
</table>
<h2>58.10 SafeSQL(static)</h2>
<pre><code class="language-php">static public function SafeSQL($Value, $DBSLink)
</code></pre>
<p>抵禦 SQL 注入攻擊</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Value</code></td>
<td align="left"><code>mixed</code></td>
<td align="left">待處理的值</td>
</tr>
<tr>
<td align="left"><code>$DBSLink</code></td>
<td align="left"><code>\PDO</code></td>
<td align="left">資料庫連線物件</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>mixed 處理後的值</p>
<h2>58.11 SafeScript(static)</h2>
<pre><code class="language-php">static public function SafeScript($Value)
</code></pre>
<p>抵禦 Script 注入攻擊</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Value</code></td>
<td align="left"><code>mixed</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>mixed 處理後的值</p>
<h2>58.12 SafeXSS(static)</h2>
<pre><code class="language-php">static public function SafeXSS($Var)
</code></pre>
<p>抵禦 Cross-Site Scripting (XSS) 攻擊</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Var</code></td>
<td align="left">`array</td>
<td align="left">string`</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>string</code> 過濾後的變數</p>
<h2>58.13 CheckMethod(static)</h2>
<pre><code class="language-php">static public function CheckMethod($AllowedMethods = [])
</code></pre>
<p>檢查請求的方法是否在允許的方法清單中</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$AllowedMethods</code></td>
<td align="left"><code>array</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>bool</code></p>
<h2>58.14 ReplaceTPL(static)</h2>
<pre><code class="language-php">static public function ReplaceTPL($Template, $ReplacingArray)
</code></pre>
<p>取代樣板文件中的變數</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Template</code></td>
<td align="left"><code>string</code></td>
<td align="left">樣板文件的內容</td>
</tr>
<tr>
<td align="left"><code>$ReplacingArray</code></td>
<td align="left"><code>array</code></td>
<td align="left">要取代的變數及值的映射陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code> 取代後的文件內容</p>
<h2>58.15 ConvertDBSPICToURI(static)</h2>
<pre><code class="language-php">static public function ConvertDBSPICToURI($PICString)
</code></pre>
<p>彙整資料庫中的 PICSet/PICQUE 欄位資料為陣列</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$PICString</code></td>
<td align="left">`string</td>
<td align="left">array`</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 彙整後的數值陣列，每個元素為一關聯陣列，包含 FileName, Title, Alt, Origin, Medium, Small 等鍵</p>
<h2>58.16 ConvertDBSFileToURI(static)</h2>
<pre><code class="language-php">static public function ConvertDBSFileToURI($FileString)
</code></pre>
<p>彙整資料庫中的 FileSet/FileQUE 欄位資料為陣列</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$FileString</code></td>
<td align="left">`string</td>
<td align="left">array`</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 彙整後的數值陣列，每個元素為一關聯陣列，包含 FileName, Title, Alt, Origin 等鍵</p>
<h2>58.17 ConvertDBSPathToURI(static)</h2>
<pre><code class="language-php">static public function ConvertDBSPathToURI($PathString)
</code></pre>
<p>彙整資料庫中的 PathSet 欄位資料為陣列</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$PathString</code></td>
<td align="left">`string</td>
<td align="left">array`</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code>|<code>false</code> 彙整後的數值陣列，每個元素為一關聯陣列，包含 FileName, Title, Alt, Origin 等鍵</p>
<h2>58.18 GetTimeDiff(static)</h2>
<pre><code class="language-php">static public function GetTimeDiff($Unit, $BaseDateTime, $TargetDateTime)
</code></pre>
<p>計算兩個時間之間的差距</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Unit</code></td>
<td align="left"><code>string</code></td>
<td align="left">計算單位，可選擇的值為：`w</td>
</tr>
<tr>
<td align="left"><code>$BaseDateTime</code></td>
<td align="left"><code>string</code></td>
<td align="left">計算基準時間字串，如 2017-01-01 00:00:00</td>
</tr>
<tr>
<td align="left"><code>$TargetDateTime</code></td>
<td align="left"><code>string</code></td>
<td align="left">計算目標時間字串，如 2017-01-01 00:00:00</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>int</code>|<code>false</code> 兩個時間之間的差距，單位為 $Unit 所指定的值</p>
<h2>58.19 ReadFlag(static)</h2>
<pre><code class="language-php">static public function ReadFlag($Flag, $Index)
</code></pre>
<p>旗標字串讀取函式，以最右側的字元為 <code>0</code> 位</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Flag</code></td>
<td align="left"><code>string</code></td>
<td align="left">待讀取的旗標</td>
</tr>
<tr>
<td align="left"><code>$Index</code></td>
<td align="left"><code>int</code></td>
<td align="left">指定的索引，以字串中最右邊的字元為 <code>0</code> 位</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code>|<code>false</code> 回傳指定索引的旗標字元</p>
<h2>58.20 WriteFlag(static)</h2>
<pre><code class="language-php">static public function WriteFlag($Flag, $Index, $NewChar = &quot;&quot;)
</code></pre>
<p>旗標字串寫入函式，以最右側的字元為 <code>0</code> 位</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Flag</code></td>
<td align="left"><code>string</code></td>
<td align="left">待寫入的旗標</td>
</tr>
<tr>
<td align="left"><code>$Index</code></td>
<td align="left"><code>int</code></td>
<td align="left">指定的索引，以字串中最右邊的字元為 <code>0</code> 位</td>
</tr>
<tr>
<td align="left"><code>$NewChar</code></td>
<td align="left"><code>string</code></td>
<td align="left">寫入旗標指定索引的字元</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code>|<code>false</code> 回傳修改後的旗標字串</p>
<h2>58.21 FilterSensitiveIFO(static)</h2>
<pre><code class="language-php">static public function FilterSensitiveIFO($Data, $ExcludeFields = array())
</code></pre>
<p>處理敏感資料的屏蔽</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Data</code></td>
<td align="left"><code>array</code></td>
<td align="left">待處理的資料關聯陣列，鍵為欄位名稱，值為待處理的值</td>
</tr>
<tr>
<td align="left"><code>$ExcludeFields</code></td>
<td align="left"><code>array</code></td>
<td align="left">不屏蔽的欄位名稱陣列</td>
</tr>
</tbody>
</table>
<h2>58.22 ConvertDataTimeToTimestamp(static)</h2>
<pre><code class="language-php">static public function ConvertDataTimeToTimestamp($DateTime)
</code></pre>
<p>轉換日期字串或數字為時間戳記</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DateTime</code></td>
<td align="left">`string</td>
<td align="left">int`</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>int</code>|<code>false</code> 回傳時間戳記</p>
<h2>58.23 ConvertTimestampToDataTime(static)</h2>
<pre><code class="language-php">static public function ConvertTimestampToDataTime($Timestamp)
</code></pre>
<p>轉換時間戳記或日期字串為日期字串</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Timestamp</code></td>
<td align="left">`int</td>
<td align="left">string`</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code>|<code>false</code> 回傳日期字串</p>
<h2>58.24 TryDecodeJson(static)</h2>
<pre><code class="language-php">static public function TryDecodeJson($JsonString)
</code></pre>
<p>TryDecodeJson</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$JsonString</code></td>
<td align="left"><code>mixed</code></td>
<td align="left">JSON 字串</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>mixed 回傳解碼後的資料，若解碼失敗則回傳引數</p>
<h2>58.25 TryEncodeJson(static)</h2>
<pre><code class="language-php">static public function TryEncodeJson($Data)
</code></pre>
<p>TryEncodeJson</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Data</code></td>
<td align="left"><code>mixed</code></td>
<td align="left">資料</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p>mixed 回傳編碼後的 JSON 字串，若編碼失敗則回傳引數</p>
<h2>58.26 GetChineseWeekday(static)</h2>
<pre><code class="language-php">static public function GetChineseWeekday($DateTime)
</code></pre>
<p>取得中文星期幾</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$DateTime</code></td>
<td align="left"><code>string</code></td>
<td align="left">日期字串</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code> 回傳中文星期幾</p>
<h2>58.27 GetEmbedYoutubeURL(static)</h2>
<pre><code class="language-php">static public function GetEmbedYoutubeURL($YoutubeURL)
</code></pre>
<p>從 Youtube 網址取得影片的嵌入網址</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$YoutubeURL</code></td>
<td align="left"><code>string</code></td>
<td align="left">Youtube 網址</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code> 回傳嵌入網址</p>
<h2>58.28 ReplaceBlank(static)</h2>
<pre><code class="language-php">static public function ReplaceBlank($String)
</code></pre>
<p>移除字串中的空白字元，包括全半形空白、換行、Tab</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$String</code></td>
<td align="left"><code>string</code></td>
<td align="left">待處理的字串</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code> 回傳不包含空白字元的字串</p>
<h2>58.29 ConvertNumToLetter(static)</h2>
<pre><code class="language-php">static public function ConvertNumToLetter($Num)
</code></pre>
<p>將數字轉換為英文字母，如 0=&gt;A、1=&gt;B、26=&gt;AA...以此類推</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Num</code></td>
<td align="left"><code>int</code></td>
<td align="left">數字</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code> 回傳英文字母</p>
<h2>58.30 ConvertLetterToNum(static)</h2>
<pre><code class="language-php">static public function ConvertLetterToNum($Letter)
</code></pre>
<p>將英文字母轉換為數字，如 A=&gt;0、B=&gt;1、AA=&gt;26...以此類推</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Letter</code></td>
<td align="left"><code>string</code></td>
<td align="left">英文字母</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>int</code> 回傳數字</p>
<h2>58.31 ConvertNumToChinese(static)</h2>
<pre><code class="language-php">static public function ConvertNumToChinese($Number, $IsCurrency = false)
</code></pre>
<p>將數字轉換為中文數字<br />
<a href="https://github.com/dearsoft-com/php-number2chinese">dearsoft-com/php-number2chinese</a></p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Number</code></td>
<td align="left">`int</td>
<td align="left">string`</td>
</tr>
<tr>
<td align="left"><code>$IsCurrency</code></td>
<td align="left"><code>bool</code></td>
<td align="left">是否為金額，預設為否</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code> 回傳中文數字</p>
<h2>58.32 ConvertNewLine(static)</h2>
<pre><code class="language-php">static public function ConvertNewLine($String)
</code></pre>
<p>將參數中的換行符號 <code>\r\n</code> <code>\r</code> <code>\n</code> 轉換成PHP_EOL換行</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$String</code></td>
<td align="left"><code>mixed</code></td>
<td align="left">要轉換的字串或字串數值陣列</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code>|<code>array</code></p>
<h2>58.33 ReplaceLinkInText(static)</h2>
<pre><code class="language-php">static public function ReplaceLinkInText($Text)
</code></pre>
<p>取代字串中的連結為超連結 <code>&lt;a href=&quot;...&quot;&gt;...&lt;/a&gt;</code></p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Text</code></td>
<td align="left"><code>string</code></td>
<td align="left">待處理的字串</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code> 處理後的字串</p>
<h2>58.34 GetLanguagePack(static)</h2>
<pre><code class="language-php">static public function GetLanguagePack($LangDIR)
</code></pre>
<p>根據請求標頭的 Accept-Language 取得語言包映射陣列</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$LangDIR</code></td>
<td align="left"><code>string</code></td>
<td align="left">語言包存放的目錄</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>array</code> 語言包映射陣列</p>
<h2>58.35 ParseRawHttpRequest(static)</h2>
<pre><code class="language-php">static public function ParseRawHttpRequest()
</code></pre>
<p>解析 Request Body</p>
<h2>58.36 HandleRequestData(static)</h2>
<pre><code class="language-php">static public function HandleRequestData()
</code></pre>
<p>處理請求的資料，過濾可能形成 SQL/Script Injection 的資料，並將 Request Body 資料寫入到 <code>$R_Data</code>|<code>$R_data</code></p>
<h2>58.37 GetLanguage(static)</h2>
<pre><code class="language-php">static public function GetLanguage($Supported, $Default = 'zh-TW') {
</code></pre>
<p>處理 HTTP Headers 中的 Accept-Language，並回傳最適合的語言代碼</p>
<table>
<thead>
<tr>
<th align="left">Param</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>$Supported</code></td>
<td align="left"><code>array</code></td>
<td align="left">可用的語言代碼</td>
</tr>
<tr>
<td align="left"><code>$Default</code></td>
<td align="left"><code>string</code></td>
<td align="left">預設的語言代碼</td>
</tr>
</tbody>
</table>
<p><strong>回傳</strong></p>
<p><code>string</code> 最適合的語言代碼</p>

    </main>
    <script>
        const navbar = document.querySelector('nav');
const main = document.querySelector('main');
const children = main.children;
const toc = {};

let cursorH1, cursorH2;
for (let i = 0; i < children.length; i++) {
    const child = children[i];
    const tag = child.tagName.toLowerCase();
    if (['h1', 'h2', 'h3'].indexOf(tag) === -1) continue;
    const text = child.innerText;
    const id = encodeURI(text.replace(/\s/g, '-'));
    child.setAttribute('id', id);
    if (tag === 'h1') {
        toc[id] = {
            id, text,
            item: {},
        };
        cursorH1 = toc[id].item;
    }
    if (tag === 'h2') {
        cursorH1[id] = {
            id, text,
            item: {},
        };
        cursorH2 = cursorH1[id].item;
    }
    if (tag === 'h3') {
        cursorH2[id] = { id, text};
    }
}

console.log(JSON.stringify(toc, null, 2));

for (let h1 in toc) {
    const header = toc[h1];
    const dl = document.createElement('dl');
    const dt = document.createElement('dt');
    const a = document.createElement('a');
    a.setAttribute('href', `#${header.id}`);
    a.innerText = header.text;
    dt.appendChild(a);
    dl.appendChild(dt);
    console.log(header.item);
    if (Object.keys(header.item).length > 0) {
        const dd = document.createElement('dd');
        const dl2 = document.createElement('dl');
        for (let h2 in header.item) {
            const header2 = header.item[h2];
            const dt2 = document.createElement('dt');
            const a2 = document.createElement('a');
            a2.setAttribute('href', `#${header2.id}`);
            a2.innerText = header2.text;
            dt2.appendChild(a2);
            dl2.appendChild(dt2);
            dd.appendChild(dl2);
            dl.appendChild(dd);
            if (Object.keys(header2.item).length > 0) {
                const dd2 = document.createElement('dd');
                const dl3 = document.createElement('dl');
                for (let h3 in header2.item) {
                    const header3 = header2.item[h3];
                    const dt3 = document.createElement('dt');
                    const a3 = document.createElement('a');
                    a3.setAttribute('href', `#${header3.id}`);
                    a3.innerText = header3.text;
                    dt3.appendChild(a3);
                    dl3.appendChild(dt3);
                }
                dd2.appendChild(dl3);
                dl2.appendChild(dd2);
            }
        }
    }
    navbar.appendChild(dl);
}

    </script>
</body>

</html>